(function(t){function e(e){for(var a,r,o=e[0],l=e[1],u=e[2],d=0,h=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&h.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);c&&c(e);while(h.length)h.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={app:0},s=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var c=l;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-navigation-drawer",{attrs:{app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list-item",{on:{click:function(e){t.drawer=!t.drawer}}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-h6"},[t._v(" LiQuer ")])],1)],1),n("v-divider"),n("v-list",{attrs:{dense:"",nav:""}},[n("v-list-item",{attrs:{link:""},on:{click:function(e){return t.set_mode("content")}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-eye")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Content")])],1)],1),n("v-list-item",{attrs:{link:""},on:{click:function(e){return t.set_mode("store")}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-folder")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Store")])],1)],1),n("v-list-item",{attrs:{link:""},on:{click:function(e){return t.set_mode("commands")}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-view-list")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Commands")])],1)],1),n("v-divider"),n("v-list-item",{attrs:{link:"",href:"https://github.com/orest-d/liquer"}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-home")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v(" LiQuer Home ")])],1)],1)],1)],1),n("v-app-bar",{attrs:{app:"",dense:""}},[n("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),n("v-toolbar-title",[t._v("LiQuer")])],1),n("v-main",["store"==t.mode?n("v-btn",{on:{click:function(e){return t.updir()}}},[t._v("Up")]):t._e(),"store"==t.mode?n("DirView",{attrs:{dirkey:t.dirkey},on:{"message-event":function(e){return t.message_event(e)},"open-event":function(e){return t.open_event(e)}}}):t._e(),"content"==t.mode?n("Content",{attrs:{metadata:t.metadata},on:{"message-event":function(e){return t.message_event(e)}}}):t._e(),"commands"==t.mode?n("Commands",{attrs:{liquer_url:t.liquer_url},on:{"message-event":function(e){return t.message_event(e)}}}):t._e()],1),n("StatusBar",{attrs:{status:t.status,message:t.message}})],1)},s=[],r=(n("a15b"),n("fb6a"),n("ac1f"),n("1276"),n("4de4"),n("d3b7"),n("5319"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-footer",{attrs:{padless:""}},[n("v-col",{staticStyle:{padding:"1px"},attrs:{cols:"1"}},["OK"==t.status?n("v-chip",{attrs:{label:"",color:"gray",dark:""}},[t._v(" "+t._s(t.status)+" ")]):t._e(),"ERROR"==t.status?n("v-chip",{attrs:{label:"",color:"red",dark:""}},[t._v(" "+t._s(t.status)+" ")]):t._e()],1),n("v-col",{staticStyle:{padding:"1px"},attrs:{cols:"11"}},[n("span",[t._v(t._s(t.message))])])],1)}),o=[],l={props:["status","message"],data:function(){return{drawer:null}}},u=l,c=n("2877"),d=n("6544"),h=n.n(d),m=n("cc20"),f=n("62ad"),v=n("553a"),_=Object(c["a"])(u,r,o,!1,null,null,null),p=_.exports;h()(_,{VChip:m["a"],VCol:f["a"],VFooter:v["a"]});var g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return null!=t.commands?n("v-card",[n("v-card-title",[t._v(" List of commands "),n("v-spacer"),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.commands_headers,items:t.commands_rows,search:t.search},scopedSlots:t._u([{key:"item.name",fn:function(e){var a=e.item;return[n("a",{attrs:{href:"#ns-meta/help-"+a.name+"-"+a.ns}},[t._v(t._s(a.name))])]}},{key:"item.example_link",fn:function(e){var a=e.item;return[a.example_link?n("a",{attrs:{href:"#"+a.example_link}},[t._v(t._s(a.example_link))]):t._e()]}},{key:"item.doc",fn:function(e){var n=e.item;return[t._v(" "+t._s(n.doc.split("\n")[0])+" ")]}}],null,!1,4154759232)})],1):t._e()},y=[],b={props:{liquer_url:{type:String,default:"/liquer"}},data:function(){return{commands:[],search:""}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:n})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:n})},message_event:function(t){this.$emit("message-event",t)}},computed:{commands_headers:function(){return[{text:"Namespace",value:"ns"},{text:"Command",value:"name"},{text:"Description",value:"doc"},{text:"Example",value:"example_link"}]},commands_rows:function(){return null==this.commands?[]:this.commands}},created:function(){this.info("Hello from commands"),this.$http.get(this.liquer_url+"/q/ns-meta/flat_commands/commands.json").then(function(t){t.json().then(function(t){this.commands=t,this.info("Commands loaded.")}.bind(this),function(t){this.error("Json error (commands)",t)}.bind(this))}.bind(this),function(t){this.error("Data loading error",t)}.bind(this))}},q=b,x=n("b0af"),w=n("99d9"),k=n("8fea"),O=n("2fa4"),j=n("8654"),V=Object(c["a"])(q,g,y,!1,null,null,null),S=V.exports;h()(V,{VCard:x["a"],VCardTitle:w["a"],VDataTable:k["a"],VSpacer:O["a"],VTextField:j["a"]});var C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},["none"==t.mode?n("v-row",[n("v-col",{attrs:{cols:"5"}}),n("v-col",{attrs:{cols:"2"}},[n("v-progress-circular",{attrs:{size:150,width:20,color:"primary",indeterminate:""}})],1),n("v-col",{attrs:{cols:"5"}})],1):t._e(),"error"==t.mode?n("v-row",[n("v-col",[t._v(" Query "+t._s(t.metadata.query)+" failed. "),n("p",[t._v(t._s(t.metadata.message))])])],1):t._e(),"invalid"==t.mode?n("v-row",[n("v-col",[t._v(" Invalid metadata ")])],1):t._e(),"waiting"==t.mode?n("v-row",[n("v-col",[t._v(" Waiting for "+t._s(t.metadata.query)+". "),n("p",[t._v(t._s(t.metadata.message))])])],1):t._e(),"text"==t.mode?n("div",[t._v(" "+t._s(t.data)+" ")]):t._e(),"dataframe"==t.mode?n("v-layout",{attrs:{row:"",wrap:""}},[n("v-flex",[t._v("Pandas version: "+t._s(t.data.schema.pandas_version)+" "),n("v-btn",{attrs:{href:t.pcv_query}},[t._v("PointCloud Viewer")])],1),null!=t.data?n("v-flex",{attrs:{xs12:""}},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.dataframe_headers,items:t.dataframe_rows}})],1):t._e()],1):t._e()],1)},R=[],$=(n("159b"),n("b0c0"),{props:{liquer_url:{type:String,default:"/liquer"},data:{default:null},metadata:{default:null}},data:function(){return{mode:"none",data_ready:!1,url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_cache_meta_prefix:"/liquer/cache/meta/"}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:n})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:n})},message_event:function(t){this.$emit("message-event",t)},update:function(){if(null==this.metadata&&(this.mode="none"),null==this.metadata.status&&(this.mode="invalid"),"error"==this.metadata.status&&(this.mode="error"),"ready"==this.metadata.status){console.log("READY"),console.log("Query",this.metadata.query),console.log("Type",this.metadata.type_identifier);var t={generic:function(){this.just_load("text")},text:function(){this.just_load("text")},dataframe:function(){this.just_load_json("dataframe",this.metadata.query+"/head_df-1000/data.json")}};t[this.metadata.type_identifier].bind(this)()}return"waiting"},just_load:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null==e&&(e=this.metadata.query),console.log("Just load",e),this.$http.get(this.url_query_prefix+e).then(function(e){this.data=e.body,this.mode=t}.bind(this),function(t){this.error("Failed loading data",t,e)}.bind(this))},just_load_json:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null==e&&(e=this.metadata.query),console.log("Just load JSON",e),this.$http.get(this.url_query_prefix+e).then(function(e){e.json().then(function(e){this.data=e,this.info("Data loaded."),this.mode=t}.bind(this),function(t){this.error("Json error (data)",t)}.bind(this))}.bind(this),function(t){this.error("Failed loading data",t,e)}.bind(this))}},watch:{metadata:function(){this.update()}},computed:{pcv_query:function(){return this.url_query_prefix+this.metadata.query+"/pointcloud-viewer.html"},dataframe_headers:function(){if(null==this.data)return[];var t=[];return this.data.schema.fields.forEach((function(e){t.push({text:e.name,value:e.name})})),console.log(t),t},dataframe_rows:function(){return null==this.data?[]:(console.log("rows",this.data.data),this.data.data)}}}),E=$,F=n("8336"),T=n("a523"),I=n("0e8f"),N=n("a722"),D=n("490a"),J=n("0fd9"),L=Object(c["a"])(E,C,R,!1,null,null,null),P=L.exports;h()(L,{VBtn:F["a"],VCol:f["a"],VContainer:T["a"],VDataTable:k["a"],VFlex:I["a"],VLayout:N["a"],VProgressCircular:D["a"],VRow:J["a"]});var M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.dir_status},scopedSlots:t._u([{key:"item.icon",fn:function(e){var a=e.item;return[n("v-icon",{domProps:{textContent:t._s(a.icon)}})]}},{key:"item.status",fn:function(t){var e=t.item;return[n("ResultStatus",{attrs:{status:e.status}})]}},{key:"item.name",fn:function(e){var a=e.item;return[n("span",{on:{click:function(e){return t.open_item(a)}}},[t._v(t._s(a.name))])]}}])})},Q=[],B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-chip",{staticClass:"ma-2",attrs:{color:t.color,dark:"",small:"",outlined:""}},[n("v-icon",[t._v(t._s(t.icon))]),t._v(t._s(t.status)+" ")],1)},K=[],A={props:["status"],data:function(){return{table:{none:{color:"gray",icon:"mdi-help-circle"},null:{color:"gray",icon:"mdi-help-circle"},submitted:{color:"blue",icon:"mdi-clock-outline"},parent:{color:"yellow",icon:"mdi-pinwheel-outline"},evaluation:{color:"yellow",icon:"mdi-pinwheel"},dependencies:{color:"yellow",icon:"mdi-pinwheel-outline"},ready:{color:"green",icon:"mdi-check-circle"},error:{color:"red",icon:"mdi-alert-circle"},obsolete:{color:"gray",icon:"mdi-check"},recipe:{color:"blue",icon:"mdi-link"},"side-effect":{color:"green",icon:"mdi-check-circle"}}}},computed:{color:function(){try{return this.table[this.status].color}catch(t){return this.table["none"].color}},icon:function(){try{return this.table[this.status].icon}catch(t){return this.table["none"].icon}}}},U=A,z=n("132d"),G=Object(c["a"])(U,B,K,!1,null,null,null),H=G.exports;h()(G,{VChip:m["a"],VIcon:z["a"]});var W={components:{ResultStatus:H},props:{liquer_url:{type:String,default:"/liquer"},dirkey:{type:String,default:""}},data:function(){return{url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",dir_status:[],headers:[{text:"",align:"start",sortable:!0,value:"icon",width:"32px"},{text:"Status",value:"status",width:"50px"},{text:"Name",value:"name"},{text:"Characteristics",value:"data_characteristics"},{text:"Message",value:"message"},{text:"Title",value:"title"},{text:"Updated",value:"updated"},{text:"Size",value:"size"}]}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:n})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:n})},message_event:function(t){this.$emit("message-event",t)},icon:function(t){return t.is_dir?"mdi-folder":"mdi-file"},open_item:function(t){this.$emit("open-event",t)},fetch_dir_status:function(t){this.info("Fetching dir info "+t);var e="";e=""==t?this.url_query_prefix+"ns-meta/dir_status/status.json":this.url_query_prefix+"-R-meta/"+t+"/-/ns-meta/dir_status/status.json",console.log("Fetching dir info from query",e),this.dir_status=[],this.$http.get(e).then(function(t){t.json().then(function(t){if("OK"==t.status){this.dir_status=t.data;for(var e=0;e<this.dir_status.length;e++)this.dir_status[e].icon=this.icon(this.dir_status[e])}else this.error(t.message)}.bind(this),function(t){this.error("JSON error while fetching dir info",t,e)}.bind(this))}.bind(this),function(t){this.error("Failed loading dir info",t,e)}.bind(this))}},watch:{dirkey:function(t,e){t!=e&&this.fetch_dir_status(t)}},created:function(){this.fetch_dir_status(this.dirkey)}},Y=W,X=Object(c["a"])(Y,M,Q,!1,null,null,null),Z=X.exports;h()(X,{VDataTable:k["a"],VIcon:z["a"]});var tt={name:"App",components:{StatusBar:p,Commands:S,Content:P,DirView:Z},data:function(){return{drawer:!1,mode:"",query:"",data:null,dirkey:"",metadata:null,status:"OK",message:"",message_event_object:{status:"OK"},url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_cache_meta_prefix:"/liquer/cache/meta/",liquer_url:"/liquer",html:""}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:n})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:n})},message_event:function(t){console.log("*** ".concat(t.status,":"),t.message),null!=t.reason&&console.log("   Reason: ",t.reason),null!=t.query&&console.log("   Query:  ",t.query),this.message=t.message,this.status=t.status,this.message_event_object=t},open_event:function(t){console.log("Open",t),t.is_dir?this.dirkey=t.key:(this.mode="content",this.submit_query(t.key+"/-/dr"))},set_mode:function(t){this.mode=t,this.drawer=!1},updir:function(){console.log("Updir from",this.dirkey),this.dirkey=this.dirkey.split("/").slice(0,-1).join("/"),console.log("Updir to",this.dirkey),this.fetch_dir_status(this.dirkey)},load_cache_metadata:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Load cache metadata",t),this.$http.get(this.url_cache_meta_prefix+t).then(function(n){n.json().then(function(t){this.metadata=t,e()}.bind(this),function(e){this.error("JSON error while loading metadata from cache",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed loading metadata from cache",e,t)}.bind(this))},get_metadata:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Get metadata",t);var n=this.url_query_prefix+this.query_basis(t)+"/state/metadata.json";console.log("GET",n),this.$http.get(n).then(function(n){n.json().then(function(t){this.metadata=t,e()}.bind(this),function(e){this.error("JSON error while loading metadata",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed loading metadata",e,t)}.bind(this))},monitor_query:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Monitor query",t),this.load_cache_metadata(t,function(){null==this.metadata?(console.log("No metadata for ".concat(t,", assuming volatile")),this.info("Volatile query",this.metadata,t),this.get_metadata(t,e)):"error"==this.metadata.status?(console.log("Status",this.metadata.status),this.error("Query failed",this.metadata,t)):"ready"==this.metadata.status?(this.info("Data is ready",this.metadata,t),e()):(console.log("Status",this.metadata.status),console.log("Refresh metadata ".concat(t)),this.info("Status: ".concat(this.metadata.status),this.metadata,t),window.setTimeout(this.monitor_query,500,t,e))}.bind(this))},submit_query:function(t){console.log("Submit query",t),this.query=t,this.info("Submitting query",{},t),this.$http.get(this.url_submit_prefix+t).then(function(e){e.json().then(function(e){try{"OK"==e.status?(this.info(e.message,e,t),this.monitor_query(t,function(){console.log("Metadata obtained for query",t),console.log("metadata:",this.metadata)}.bind(this))):this.error(e.message,e,t)}catch(n){this.error("Unexpected result from query submission",e,t)}}.bind(this),function(e){this.error("JSON error while submitting query",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed sumbitting query",e,t)}.bind(this))},split_query:function(t){var e=t,n=this.query.split("/").filter((function(t){return t.length})),a="data",i="pickle";if(n.length>0){var s=n[n.length-1];a=s.replace("-","_");var r=a.split(".");a=r[0],i=r[r.length-1],-1==s.indexOf("-")&&-1!=s.indexOf(".")&&(e=n.slice(0,n.length-1).join("/"))}return[e,a,i]},query_basis:function(t){var e=t,n=this.query.split("/").filter((function(t){return t.length}));if(n.length>0){var a=n[n.length-1];-1==a.indexOf("-")&&-1!=a.indexOf(".")&&(e=n.slice(0,n.length-1).join("/"))}return e}},computed:{},created:function(){this.mode=""}},et=tt,nt=n("7496"),at=n("40dc"),it=n("5bc1"),st=n("ce7e"),rt=n("8860"),ot=n("da13"),lt=n("5d23"),ut=n("34c3"),ct=n("f6c4"),dt=n("f774"),ht=n("2a7f"),mt=Object(c["a"])(et,i,s,!1,null,null,null),ft=mt.exports;h()(mt,{VApp:nt["a"],VAppBar:at["a"],VAppBarNavIcon:it["a"],VBtn:F["a"],VDivider:st["a"],VIcon:z["a"],VList:rt["a"],VListItem:ot["a"],VListItemContent:lt["a"],VListItemIcon:ut["a"],VListItemTitle:lt["b"],VMain:ct["a"],VNavigationDrawer:dt["a"],VToolbarTitle:ht["a"]});var vt=n("f309");a["a"].use(vt["a"]);var _t=new vt["a"]({theme:{dark:!0}}),pt=n("28dd");a["a"].use(pt["a"]),a["a"].config.productionTip=!1,new a["a"]({vuetify:_t,render:function(t){return t(ft)},data:{status:"OK",message:"",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_prefix:"/liquer/q/"}}).$mount("#app")}});
//# sourceMappingURL=app.7593d7a6.js.map