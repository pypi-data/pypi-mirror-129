(function(t){function e(e){for(var n,s,o=e[0],l=e[1],u=e[2],c=0,h=[];c<o.length;c++)s=o[c],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var d=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-navigation-drawer",{attrs:{app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}}),a("v-app-bar",{attrs:{app:"",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){t.drawer=!t.drawer}}}),a("v-toolbar-title",[t._v("Application")])],1),a("v-main",[a("v-btn",{on:{click:function(e){return t.updir()}}},[t._v("Up")]),a("DirView",{attrs:{dirkey:t.dirkey},on:{"message-event":function(e){return t.message_event(e)},"open-event":function(e){return t.open_event(e)}}}),t._e(),t._e()],1),a("StatusBar",{attrs:{status:t.status,message:t.message}})],1)},r=[],s=(a("a15b"),a("fb6a"),a("ac1f"),a("1276"),a("4de4"),a("d3b7"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-footer",{attrs:{padless:""}},[a("v-col",{staticStyle:{padding:"1px"},attrs:{cols:"1"}},["OK"==t.status?a("v-chip",{attrs:{label:"",color:"gray",dark:""}},[t._v(" "+t._s(t.status)+" ")]):t._e(),"ERROR"==t.status?a("v-chip",{attrs:{label:"",color:"red",dark:""}},[t._v(" "+t._s(t.status)+" ")]):t._e()],1),a("v-col",{staticStyle:{padding:"1px"},attrs:{cols:"11"}},[a("span",[t._v(t._s(t.message))])])],1)}),o=[],l={props:["status","message"],data:function(){return{drawer:null}}},u=l,d=a("2877"),c=a("6544"),h=a.n(c),m=a("cc20"),f=a("62ad"),_=a("553a"),p=Object(d["a"])(u,s,o,!1,null,null,null),v=p.exports;h()(p,{VChip:m["a"],VCol:f["a"],VFooter:_["a"]});var g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!=t.commands?a("v-card",[a("v-card-title",[t._v(" List of commands "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.commands_headers,items:t.commands_rows,search:t.search},scopedSlots:t._u([{key:"item.name",fn:function(e){var n=e.item;return[a("a",{attrs:{href:"#ns-meta/help-"+n.name+"-"+n.ns}},[t._v(t._s(n.name))])]}},{key:"item.example_link",fn:function(e){var n=e.item;return[n.example_link?a("a",{attrs:{href:"#"+n.example_link}},[t._v(t._s(n.example_link))]):t._e()]}},{key:"item.doc",fn:function(e){var a=e.item;return[t._v(" "+t._s(a.doc.split("\n")[0])+" ")]}}],null,!1,4154759232)})],1):t._e()},y=[],b={props:{liquer_url:{type:String,default:"/liquer"}},data:function(){return{commands:[],search:""}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:a})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:a})},message_event:function(t){this.$emit("message-event",t)}},computed:{commands_headers:function(){return[{text:"Namespace",value:"ns"},{text:"Command",value:"name"},{text:"Description",value:"doc"},{text:"Example",value:"example_link"}]},commands_rows:function(){return null==this.commands?[]:this.commands}},created:function(){this.info("Hello from commands"),this.$http.get(this.liquer_url+"/q/ns-meta/flat_commands/commands.json").then(function(t){t.json().then(function(t){this.commands=t,this.info("Commands loaded.")}.bind(this),function(t){this.error("Json error (commands)",t)}.bind(this))}.bind(this),function(t){this.error("Data loading error",t)}.bind(this))}},q=b,x=a("b0af"),w=a("99d9"),O=a("8fea"),k=a("2fa4"),j=a("8654"),S=Object(d["a"])(q,g,y,!1,null,null,null),V=S.exports;h()(S,{VCard:x["a"],VCardTitle:w["a"],VDataTable:O["a"],VSpacer:k["a"],VTextField:j["a"]});var R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},["none"==t.mode?a("v-row",[a("v-col",{attrs:{cols:"5"}}),a("v-col",{attrs:{cols:"2"}},[a("v-progress-circular",{attrs:{size:150,width:20,color:"primary",indeterminate:""}})],1),a("v-col",{attrs:{cols:"5"}})],1):t._e(),"error"==t.mode?a("v-row",[a("v-col",[t._v(" Query "+t._s(t.metadata.query)+" failed. "),a("p",[t._v(t._s(t.metadata.message))])])],1):t._e(),"invalid"==t.mode?a("v-row",[a("v-col",[t._v(" Invalid metadata ")])],1):t._e(),"waiting"==t.mode?a("v-row",[a("v-col",[t._v(" Waiting for "+t._s(t.metadata.query)+". "),a("p",[t._v(t._s(t.metadata.message))])])],1):t._e(),"text"==t.mode?a("div",[t._v(" "+t._s(t.data)+" ")]):t._e()],1)},C=[],$=(a("159b"),a("b0c0"),{props:{liquer_url:{type:String,default:"/liquer"},data:{default:null},metadata:{default:null}},data:function(){return{mode:"none",data_ready:!1,url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_cache_meta_prefix:"/liquer/cache/meta/"}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:a})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:a})},message_event:function(t){this.$emit("message-event",t)},update:function(){if(null==this.metadata&&(this.mode="none"),null==this.metadata.status&&(this.mode="invalid"),"error"==this.metadata.status&&(this.mode="error"),"ready"==this.metadata.status){console.log("READY"),console.log("Query",this.metadata.query),console.log("Type",this.metadata.type_identifier);var t={generic:function(){this.just_load("text")},text:function(){this.just_load("text")}};t[this.metadata.type_identifier].bind(this)()}return"waiting"},just_load:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null==e&&(e=this.metadata.query),console.log("Just load",e),this.$http.get(this.url_query_prefix+e).then(function(e){this.data=e.body,this.mode=t}.bind(this),function(t){this.error("Failed loading data",t,e)}.bind(this))}},watch:{metadata:function(){this.update()}},computed:{dataframe_headers:function(){if(null==this.data)return[];var t=[];return this.data.schema.fields.forEach((function(e){t.push({text:e.name,value:e.name})})),console.log(t),t},dataframe_rows:function(){return null==this.data?[]:(console.log("rows",this.data.data),this.data.data)}}}),E=$,F=a("a523"),N=a("490a"),T=a("0fd9"),P=Object(d["a"])(E,R,C,!1,null,null,null),D=P.exports;h()(P,{VCol:f["a"],VContainer:F["a"],VProgressCircular:N["a"],VRow:T["a"]});var J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left",staticStyle:{"max-width":"32px"}}),a("th",{staticClass:"text-left"},[t._v(" Name ")])])]),a("tbody",t._l(t.dir_status,(function(e){return a("tr",{key:e.key},[a("td",{staticStyle:{"max-width":"32px"}},[a("v-icon",{domProps:{textContent:t._s(t.icon(e))}})],1),a("td",[a("v-btn",{domProps:{textContent:t._s(e.name)},on:{click:function(a){return t.open_item(e)}}})],1)])})),0)]},proxy:!0}])})},I=[],M={props:{liquer_url:{type:String,default:"/liquer"},dirkey:{type:String,default:""}},data:function(){return{url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",dir_status:[]}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:a})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:a})},message_event:function(t){this.$emit("message-event",t)},icon:function(t){return t.is_dir?"mdi-folder":"mdi-file"},open_item:function(t){this.$emit("open-event",t)},fetch_dir_status:function(t){this.info("Fetching dir info "+t);var e="";e=""==t?this.url_query_prefix+"ns-meta/dir_status/status.json":this.url_query_prefix+"-R-meta/"+t+"/-/ns-meta/dir_status/status.json",console.log("Fetching dir info from query",e),this.dir_status=[],this.$http.get(e).then(function(t){t.json().then(function(t){"OK"==t.status?this.dir_status=t.data:this.error(t.message)}.bind(this),function(t){this.error("JSON error while fetching dir info",t,e)}.bind(this))}.bind(this),function(t){this.error("Failed loading dir info",t,e)}.bind(this))}},watch:{dirkey:function(t,e){t!=e&&this.fetch_dir_status(t)}},created:function(){this.fetch_dir_status(this.dirkey)}},A=M,B=a("8336"),K=a("132d"),Q=a("1f4f"),U=Object(d["a"])(A,J,I,!1,null,null,null),G=U.exports;h()(U,{VBtn:B["a"],VIcon:K["a"],VSimpleTable:Q["a"]});var L={name:"App",components:{StatusBar:v,Commands:V,Content:D,DirView:G},data:function(){return{drawer:!1,query:"",data:null,dirkey:"",metadata:null,status:"OK",message:"",message_event_object:{status:"OK"},url_query_prefix:"/liquer/q/",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_cache_meta_prefix:"/liquer/cache/meta/",liquer_url:"/liquer",html:""}},methods:{info:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"INFO",message:t,reason:e,query:a})},error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.message_event({status:"ERROR",message:t,reason:e,query:a})},message_event:function(t){console.log("*** ".concat(t.status,":"),t.message),null!=t.reason&&console.log("   Reason: ",t.reason),null!=t.query&&console.log("   Query:  ",t.query),this.message=t.message,this.status=t.status,this.message_event_object=t},open_event:function(t){console.log("Open",t),t.is_dir&&(this.dirkey=t.key)},updir:function(){console.log("Updir from",this.dirkey),this.dirkey=this.dirkey.split("/").slice(0,-1).join("/"),console.log("Updir to",this.dirkey),this.fetch_dir_status(this.dirkey)},load_cache_metadata:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Load cache metadata",t),this.$http.get(this.url_cache_meta_prefix+t).then(function(a){a.json().then(function(t){this.metadata=t,e()}.bind(this),function(e){this.error("JSON error while loading metadata from cache",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed loading metadata from cache",e,t)}.bind(this))},get_metadata:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Get metadata",t);var a=this.url_query_prefix+this.query_basis(t)+"/state/metadata.json";console.log("GET",a),this.$http.get(a).then(function(a){a.json().then(function(t){this.metadata=t,e()}.bind(this),function(e){this.error("JSON error while loading metadata",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed loading metadata",e,t)}.bind(this))},monitor_query:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};null==t&&(t=this.query),console.log("Monitor query",t),this.load_cache_metadata(t,function(){null==this.metadata?(console.log("No metadata for ".concat(t,", assuming volatile")),this.info("Volatile query",this.metadata,t),this.get_metadata(t,e)):"error"==this.metadata.status?(console.log("Status",this.metadata.status),this.error("Query failed",this.metadata,t)):"ready"==this.metadata.status?(this.info("Data is ready",this.metadata,t),e()):(console.log("Status",this.metadata.status),console.log("Refresh metadata ".concat(t)),this.info("Status: ".concat(this.metadata.status),this.metadata,t),window.setTimeout(this.monitor_query,500,t,e))}.bind(this))},submit_query:function(t){console.log("Submit query",t),this.query=t,this.info("Submitting query",{},t),this.$http.get(this.url_submit_prefix+t).then(function(e){e.json().then(function(e){try{"OK"==e.status?(this.info(e.message,e,t),this.monitor_query(t,function(){console.log("Metadata obtained for query",t),console.log("metadata:",this.metadata)}.bind(this))):this.error(e.message,e,t)}catch(a){this.error("Unexpected result from query submission",e,t)}}.bind(this),function(e){this.error("JSON error while submitting query",e,t)}.bind(this))}.bind(this),function(e){this.error("Failed sumbitting query",e,t)}.bind(this))},split_query:function(t){var e=t,a=this.query.split("/").filter((function(t){return t.length})),n="data",i="pickle";if(a.length>0){var r=a[a.length-1];n=r.replace("-","_");var s=n.split(".");n=s[0],i=s[s.length-1],-1==r.indexOf("-")&&-1!=r.indexOf(".")&&(e=a.slice(0,a.length-1).join("/"))}return[e,n,i]},query_basis:function(t){var e=t,a=this.query.split("/").filter((function(t){return t.length}));if(a.length>0){var n=a[a.length-1];-1==n.indexOf("-")&&-1!=n.indexOf(".")&&(e=a.slice(0,a.length-1).join("/"))}return e}},computed:{},created:function(){this.submit_query("hello")}},z=L,H=a("7496"),W=a("40dc"),Y=a("5bc1"),X=a("f6c4"),Z=a("f774"),tt=a("2a7f"),et=Object(d["a"])(z,i,r,!1,null,null,null),at=et.exports;h()(et,{VApp:H["a"],VAppBar:W["a"],VAppBarNavIcon:Y["a"],VBtn:B["a"],VMain:X["a"],VNavigationDrawer:Z["a"],VToolbarTitle:tt["a"]});var nt=a("f309");n["a"].use(nt["a"]);var it=new nt["a"]({theme:{dark:!0}}),rt=a("28dd");n["a"].use(rt["a"]),n["a"].config.productionTip=!1,new n["a"]({vuetify:it,render:function(t){return t(at)},data:{status:"OK",message:"",url_submit_prefix:"/liquer/submit/",url_remove_prefix:"/liquer/cache/remove/",url_prefix:"/liquer/q/"}}).$mount("#app")}});
//# sourceMappingURL=app.ce6427c4.js.map