

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>geophpy.dataset &mdash; GeophPy 0.32.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> GeophPy
          

          
            
            <img src="../../_static/geophpy-square.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.32.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General informations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About GeophPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick-start.html">Getting started</a></li>
</ul>
<p class="caption"><span class="caption-text">Feature overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plot-fun.html">Plotting functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gen-proc.html">General Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mag-proc.html">Magnetic Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geopos.html">Geographic Positionning</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gui.html">Using a GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../feedback.html">Feedback &amp; Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeophPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>geophpy.dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for geophpy.dataset</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   GeophPy.dataset</span>
<span class="sd">   ---------------</span>

<span class="sd">   DataSet Object constructor and methods.</span>

<span class="sd">   :copyright: Copyright 2014-2020 L. Darras, P. Marty, Q. Vitale and contributors, see AUTHORS.</span>
<span class="sd">   :license: GNU GPL v3.</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="kn">from</span> <span class="nn">geophpy.datasetbase</span> <span class="kn">import</span> <span class="n">DataSetBase</span><span class="p">,</span> <span class="n">Info</span><span class="p">,</span> <span class="n">Data</span>

<span class="c1">#import geophpy.plotting.plot as plot</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.correlation</span> <span class="k">as</span> <span class="nn">correlation</span>
<span class="c1">#import geophpy.plotting.colormap as colormap</span>
<span class="c1">#import geophpy.plotting.histo as histo</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.destriping</span> <span class="k">as</span> <span class="nn">destriping</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.spectral</span> <span class="k">as</span> <span class="nn">spectral</span>
<span class="kn">import</span> <span class="nn">geophpy.operation.general</span> <span class="k">as</span> <span class="nn">genop</span>
<span class="kn">import</span> <span class="nn">geophpy.processing.general</span> <span class="k">as</span> <span class="nn">genproc</span>
<span class="kn">import</span> <span class="nn">geophpy.processing.magnetism</span> <span class="k">as</span> <span class="nn">magproc</span>
<span class="kn">import</span> <span class="nn">geophpy.filesmanaging.files</span> <span class="k">as</span> <span class="nn">iofiles</span>
<span class="c1">#import geophpy.filesmanaging as io</span>
<span class="kn">import</span> <span class="nn">geophpy.geoposset</span> <span class="k">as</span> <span class="nn">geopos</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.kml</span> <span class="k">as</span> <span class="nn">kml</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.raster</span> <span class="k">as</span> <span class="nn">raster</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.general</span> <span class="k">as</span> <span class="nn">gengeopositioning</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># #---------------------------------------------------------------------------#</span>
<span class="c1"># # Informations about DataSet Object                                         #</span>
<span class="c1"># #---------------------------------------------------------------------------#</span>
<span class="c1"># class Info:</span>
    <span class="c1"># &#39;&#39;&#39; Class to store grid informations.</span>

    <span class="c1"># Attributes</span>
    <span class="c1"># ----------</span>
    <span class="c1"># x_min : float</span>
        <span class="c1"># Grid minimum x values.</span>

    <span class="c1"># x_max : float</span>
        <span class="c1"># Grid maximum x values.</span>

    <span class="c1"># y_min : float</span>
        <span class="c1"># Grid minimum y values.</span>

    <span class="c1"># y_max : float</span>
        <span class="c1"># Grid maximum y values.</span>

    <span class="c1"># z_min : float</span>
        <span class="c1"># Grid minimum z values.</span>

    <span class="c1"># z_max : float</span>
        <span class="c1"># Grid maximum z values.</span>

    <span class="c1"># x_gridding_delta : float</span>
        <span class="c1"># Grid stepsize in the x_direction.</span>

    <span class="c1"># y_gridding_delta : float</span>
        <span class="c1"># Grid stepsize in the y_direction.</span>

    <span class="c1"># gridding_interpolation : str</span>
        <span class="c1"># Interpolation method used for gridding.</span>

    <span class="c1"># plottype : str</span>
        <span class="c1"># Grid plot type.</span>

    <span class="c1"># cmapname : str</span>
        <span class="c1"># Grid plot colormap name.</span>

    <span class="c1"># &#39;&#39;&#39;</span>

<span class="c1"># ##    def __init__(self, xmin=None, xmax=None, ymin=None, ymax=None, zmin=None ,zmax=None, dx=None, dy=None,</span>
<span class="c1"># ##                 interp=None, plottype =&#39;2D-SURFACE&#39;, cmap=&#39;Greys&#39;):</span>
<span class="c1"># ##        self.x_min = xmin</span>
<span class="c1"># ##        self.x_max = xmax</span>
<span class="c1"># ##        self.y_min = ymin</span>
<span class="c1"># ##        self.y_max = ymax</span>
<span class="c1"># ##        self.z_min = zmin</span>
<span class="c1"># ##        self.z_max = zmax</span>
<span class="c1"># ##        self.x_gridding_delta = dx</span>
<span class="c1"># ##        self.y_gridding_delta = dy</span>
<span class="c1"># ##        self.gridding_interpolation = interp</span>
<span class="c1"># ##        self.plottype = plottype</span>
<span class="c1"># ##        self.cmapname = cmap</span>

    <span class="c1"># x_min = None</span>
    <span class="c1"># x_max = None</span>
    <span class="c1"># y_min = None</span>
    <span class="c1"># y_max = None</span>
    <span class="c1"># z_min = None</span>
    <span class="c1"># z_max = None</span>
    <span class="c1"># x_gridding_delta = None</span>
    <span class="c1"># y_gridding_delta = None</span>
    <span class="c1"># gridding_interpolation = None</span>
    <span class="c1"># plottype = (plot.gettypelist())[0]</span>
    <span class="c1"># cmapname = &#39;Greys&#39;</span>


<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># Fields names and values about DataSet Object                              #</span>
<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># class Data:</span>
    <span class="c1"># &#39;&#39;&#39; Class to sotre data.</span>

    <span class="c1"># Attributes</span>
    <span class="c1"># ----------</span>
    <span class="c1"># fields : list of str</span>
        <span class="c1"># Field names corresponding to the data values (&#39;x&#39;, &#39;y&#39;, &#39;vgrad&#39;).</span>

    <span class="c1"># values : array-like</span>
        <span class="c1"># Ungridded data values.</span>

    <span class="c1"># z_image : 2-D array-like.</span>
        <span class="c1"># Gridded data values.</span>

    <span class="c1"># easting_image :</span>
        <span class="c1"># ???</span>
    <span class="c1"># northing_image :</span>
        <span class="c1"># ???</span>

    <span class="c1"># &#39;&#39;&#39;</span>

    <span class="c1"># fields = None  # name for the x, y and z fields</span>
    <span class="c1"># values = None  # ungridded data values</span>
    <span class="c1"># z_image = None  # gridded data values</span>
    <span class="c1"># easting_image = None    # easting grid (used if the dataset is georeferenced)</span>
    <span class="c1"># northing_image = None   # northing grid (used if the dataset is georeferenced)</span>
    <span class="c1"># easting  = None  # ungridded dataset easting</span>
    <span class="c1"># northing = None  # ungridded data orthing</span>


<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># Coordinates Object in local and utm referencing                           #</span>
<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="k">class</span> <span class="nc">GeoRefPoint</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">easting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">northing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">utm_easting</span> <span class="o">=</span> <span class="n">easting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="n">northing</span>


<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># Georeferencement System Object between local and geographics positions    #</span>
<span class="c1">#---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="GeoRefSystem"><a class="viewcode-back" href="../../api.html#geophpy.dataset.GeoRefSystem">[docs]</a><span class="k">class</span> <span class="nc">GeoRefSystem</span><span class="p">:</span>
    <span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>          <span class="c1"># data set georeferencement status</span>
    <span class="n">refsystem</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1"># &#39;UTM&#39;, &#39;WGS84&#39;, ...</span>
    <span class="n">utm_zoneletter</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># E -&gt; X</span>
    <span class="n">utm_zonenumber</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># 1 -&gt; 60</span>
    <span class="n">points_list</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c1"># list of points, [[num1, lon1 or eastern1, lat1 or northern1, x, y], ...]</span></div>


<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># DataSet Object                                                            #</span>
<span class="c1">#---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="DataSet"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet">[docs]</a><span class="k">class</span> <span class="nc">DataSet</span><span class="p">(</span><span class="n">DataSetBase</span><span class="p">):</span>
<span class="c1">#class DataSet:</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Creates a DataSet Object to process and display data.</span>

<span class="sd">   info = Info()</span>
<span class="sd">   data = Data()</span>
<span class="sd">   georef = GeoRefSystem()</span>
<span class="sd">   &#39;&#39;&#39;</span>

   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(),</span>
                <span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(),</span> 
                <span class="n">georef</span><span class="o">=</span><span class="n">GeoRefSystem</span><span class="p">(),</span>
                <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
                       <span class="n">data</span><span class="p">,</span>
                       <span class="n">georef</span><span class="p">,</span>
                       <span class="n">name</span><span class="p">)</span>

   <span class="c1"># # def __init__(self, info=Info(), data=Data(), georef=GeoRefSystem()):</span>

       <span class="c1"># # self.info = info</span>
       <span class="c1"># # self.data = data</span>
       <span class="c1"># # self.georef = georef</span>

   <span class="c1"># # @classmethod</span>
   <span class="c1"># # def from_uxofile(cls, filename):</span>
       <span class="c1"># # &#39;&#39;&#39; Build a dataset from an UXO 100 file.</span>

       <span class="c1"># # Parameters</span>
       <span class="c1"># # ----------</span>
       <span class="c1"># # filename: str or list of str</span>
           <span class="c1"># # Filename to open. Example: &#39;file1.uxo&#39;</span>

       <span class="c1"># # &#39;&#39;&#39;</span>

       <span class="c1"># # data = io.uxo.UxoFileReader(filename).data</span>

       <span class="c1"># # return cls(data=data)</span>


   <span class="c1"># @classmethod</span>
   <span class="c1"># def _new(cls):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Creates a new empty data set</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># dataset = cls()</span>
      <span class="c1"># dataset.info = Info()</span>
      <span class="c1"># dataset.data = Data()</span>
      <span class="c1"># dataset.georef = GeoRefSystem()</span>
      <span class="c1"># return dataset</span>

   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># # DataSet file management                                                   #</span>
   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># ###</span>
   <span class="c1"># ##</span>
   <span class="c1"># # As a class constructor, should probably a class method, right ?</span>
   <span class="c1"># ##</span>
   <span class="c1"># ###</span>
   <span class="c1"># @staticmethod</span>
   <span class="c1"># def from_file(filenameslist, fileformat=None, delimiter=None, x_colnum=1, y_colnum=2, z_colnum=3, skipinitialspace=True, skip_rows=0, fields_row=1):</span>
      <span class="c1"># &#39;&#39;&#39; Build a DataSet Object from a file.</span>

      <span class="c1"># Parameters:</span>

      <span class="c1"># :filenameslist: list of files to open</span>
                      <span class="c1"># [&#39;file1.xyz&#39;, &#39;file2.xyz&#39; ...]</span>
                      <span class="c1"># or</span>
                      <span class="c1"># [&#39;file*.xyz&#39;] to open all files with filename beginning by &quot;file&quot; and ending by &quot;.xyz&quot;</span>

      <span class="c1"># :fileformat: format of files to open (None by default implies automatic determination from filename extension)</span>

      <span class="c1"># Note: all files must have the same format</span>

      <span class="c1"># :delimiter: pattern delimitting fields within one line (e.g. &#39;\t&#39;, &#39;,&#39;, &#39;;&#39; ...)</span>

      <span class="c1"># :x_colnum: column number of the X coordinate of the profile (1 by default)</span>

      <span class="c1"># :y_colnum: column number of the Y coordinate inside the profile (2 by default)</span>

      <span class="c1"># :z_colnum: column number of the measurement profile (3 by default)</span>

      <span class="c1"># :skipinitialspace: if True, several contiguous delimiters are equivalent to one</span>

      <span class="c1"># :skip_rows: number of rows to skip at the beginning of the file, i.e. total number of header rows (1 by default)</span>

      <span class="c1"># :fields_row: row number where to read the field names ; if -1 then default field names will be &quot;X&quot;, &quot;Y&quot; and &quot;Z&quot;</span>

      <span class="c1"># Returns:</span>

      <span class="c1"># :success: true if DataSet Object built, false if not</span>

      <span class="c1"># :dataset: DataSet Object build from file(s) (empty if any error)</span>

      <span class="c1"># Example:</span>

      <span class="c1"># success, dataset = DataSet.from_file(&quot;file.csv&quot;)</span>
      <span class="c1"># &#39;&#39;&#39;</span>

      <span class="c1"># # Conversion to list for eventual single file name</span>
      <span class="c1"># if isinstance(filenameslist, str):</span>
          <span class="c1"># filenameslist = [filenameslist]</span>

      <span class="c1"># # Dispatch method ########################################################</span>
      <span class="c1"># class From():</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def ascii():</span>
            <span class="c1"># return iofiles.from_ascii(dataset, filenameslist, delimiter=delimiter, x_colnum=x_colnum, y_colnum=y_colnum, z_colnum=z_colnum, skipinitialspace=skipinitialspace, skip_rows=skip_rows, fields_row=fields_row)</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def netcdf():</span>
            <span class="c1"># return iofiles.from_netcdf(dataset, filenameslist, x_colnum=x_colnum, y_colnum=y_colnum, z_colnum=z_colnum)</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def surfer():</span>
            <span class="c1"># return iofiles.from_grd(dataset, filenameslist, gridtype=None)</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def uxo():</span>
            <span class="c1"># return iofiles.from_uxo(dataset, filenameslist)</span>

      <span class="c1"># # Create a new dataset ###################################################</span>
      <span class="c1"># dataset = DataSet._new()</span>
      <span class="c1"># # if class method:  dataset = cls() ?</span>

      <span class="c1"># # Choose the input file format ###########################################</span>
      <span class="c1"># if fileformat is None:</span>
         <span class="c1"># # Format from filen extension</span>
         <span class="c1"># file_extension = os.path.splitext(filenameslist[0])[1]</span>
         <span class="c1"># fileformat = format_chooser.get(file_extension, &#39;ascii&#39;)</span>

      <span class="c1"># # Read the dataset from input file #######################################</span>
      <span class="c1"># if fileformat in fileformat_getlist():</span>
         <span class="c1"># readfile = getattr(From, fileformat)</span>
         <span class="c1"># error    = readfile()</span>

      <span class="c1"># else:</span>
         <span class="c1"># # Undefined file format ###############################################</span>
         <span class="c1"># # ...TBD... raise an error here !</span>
         <span class="c1"># error = 1</span>

      <span class="c1"># # Return the dataset and error code ######################################</span>
      <span class="c1"># if error==0:</span>
         <span class="c1"># success = True</span>
      <span class="c1"># else:</span>
         <span class="c1"># success = False</span>

      <span class="c1"># return success, dataset</span>

   <span class="c1"># ###</span>
   <span class="c1"># ##</span>
   <span class="c1"># # ... Still Under Construction ...</span>
   <span class="c1"># ##</span>
   <span class="c1"># ###</span>
<span class="c1"># ##   @classmethod</span>
<span class="c1"># ##   def from_cmdfile(cls, filenameslist, param=&#39;cond1&#39;):</span>
<span class="c1"># ##       &#39;&#39;&#39; Build a DataSet Object from Gf Instrument CMD ascii file.</span>
<span class="c1"># ##</span>
<span class="c1"># ##       Reads both Gf Instrument CMD interpolated and not interpolated</span>
<span class="c1"># ##       Gf Instrument CMD ascii file format.</span>
<span class="c1"># ##</span>
<span class="c1"># ##       Parameter</span>
<span class="c1"># ##       ---------</span>
<span class="c1"># ##       param : {&#39;cond1&#39;,&#39;inph1&#39;,&#39;cond2&#39;,&#39;inph2&#39;,&#39;cond3&#39;,&#39;inph3&#39;}</span>
<span class="c1"># ##           Parameter to be read.</span>
<span class="c1"># ##</span>
<span class="c1"># ##       Returns</span>
<span class="c1"># ##       -------</span>
<span class="c1"># ##       success : bool</span>
<span class="c1"># ##           True if DataSet Object was built, false otherwise.</span>
<span class="c1"># ##</span>
<span class="c1"># ##       dataset: DataSet Object built from the file(s) (empty if any error)</span>
<span class="c1"># ##</span>
<span class="c1"># ##       Example</span>
<span class="c1"># ##       -------</span>
<span class="c1"># ##       success, dataset = DataSet.from_cmdfile(&quot;DataCmdMini.dat&quot;)</span>
<span class="c1"># ##</span>
<span class="c1"># ##       &#39;&#39;&#39;</span>
<span class="c1"># ##</span>
<span class="c1"># ##       # Creating empty dataset</span>
<span class="c1"># ##       dataset = cls()</span>
<span class="c1"># ##       dataset.info = Info()</span>
<span class="c1"># ##       dataset.data = Data()</span>
<span class="c1"># ##       dataset.georef = GeoRefSystem()</span>
<span class="c1"># ##</span>
<span class="c1"># ##       # Reading cmd file and populating dataset</span>
<span class="c1"># ##       error_code = iofiles.from_cmdfile(dataset, filenameslist, param=param)</span>
<span class="c1"># ##</span>
<span class="c1"># ##       # Return the dataset and error code #####################################</span>
<span class="c1"># ##       if error_code==0:</span>
<span class="c1"># ##           success = True</span>
<span class="c1"># ##       else:</span>
<span class="c1"># ##           success = False</span>
<span class="c1"># ##</span>
<span class="c1"># ##       return success, dataset</span>

   <span class="c1"># def to_file(self, filename, fileformat=None, delimiter=&#39;\t&#39;, description=None, gridtype=&#39;surfer7bin&#39;):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Save a DataSet Object to a file.</span>

      <span class="c1"># Parameters :</span>

      <span class="c1"># :filename: name of file to save.</span>

      <span class="c1"># :fileformat: format of output file ...</span>

      <span class="c1"># :delimiter: delimiter between fields in a line of the output file, &#39;\t&#39;, &#39;,&#39;, &#39;;&#39;, ...</span>

      <span class="c1"># :gridtype: str {&#39;surfer7bin&#39;, &#39;surfer6bin&#39;, &#39;surfer6ascii&#39;}, optional</span>
          <span class="c1"># Format of the grid file to write. By default &#39;surfer7bin&#39;.</span>

      <span class="c1"># Returns :</span>

      <span class="c1"># :success: boolean</span>

      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># # Dispatch method ##############################################</span>
      <span class="c1"># class To():</span>
         <span class="c1"># @staticmethod</span>
         <span class="c1"># def ascii():</span>
            <span class="c1"># return iofiles.to_ascii(self, filename, delimiter=delimiter)</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def netcdf():</span>
            <span class="c1"># return iofiles.to_netcdf(self, filename, description=description)</span>

         <span class="c1"># @staticmethod</span>
         <span class="c1"># def surfer():</span>
            <span class="c1"># return iofiles.to_grd(self, filename, gridtype=gridtype)</span>

      <span class="c1"># # Choose the dataset format ####################################</span>
      <span class="c1"># if fileformat is None:</span>
         <span class="c1"># # Determine the format from filename extension</span>
         <span class="c1"># file_extension = os.path.splitext(filename)[1]</span>
         <span class="c1"># fileformat = format_chooser.get(file_extension, None)</span>

      <span class="c1"># # Write the dataset to file ####################################</span>
      <span class="c1"># if fileformat in fileformat_getlist():</span>
         <span class="c1"># writefile = getattr(To, fileformat)</span>
         <span class="c1"># error     = writefile()</span>
      <span class="c1"># else:</span>
         <span class="c1"># # Undefined file format #####################################</span>
         <span class="c1"># # ...TBD... raise an error here !</span>
         <span class="c1"># error = 1</span>

      <span class="c1"># # Return the error code ########################################</span>
      <span class="c1"># if (error == 0):</span>
         <span class="c1"># success = True</span>
      <span class="c1"># else:</span>
         <span class="c1"># success = False</span>
      <span class="c1"># return success</span>

   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># # DataSet Plotting                                                          #</span>
   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># def plot(self, plottype=&#39;2D-SCATTER&#39;, cmapname=None, creversed=False,</span>
            <span class="c1"># fig=None, filename=None, cmmin=None, cmmax=None, interpolation=&#39;bilinear&#39;,</span>
            <span class="c1"># levels=100, cmapdisplay=True, axisdisplay=True, labeldisplay=True,</span>
            <span class="c1"># pointsdisplay=False, dpi=None, transparent=False, logscale=False,</span>
            <span class="c1"># rects=None, points=None, marker=&#39;+&#39;, markersize=None):</span>
       <span class="c1"># &#39;&#39;&#39; 2D representation of the dataset.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># plottype : str, {&#39;2D-SCATTER&#39;, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, &#39;2D-CONTOURF&#39;, &#39;2D-POSTMAP&#39;}</span>
           <span class="c1"># Plot type for the data representation.</span>
           <span class="c1"># Plot type can be</span>

           <span class="c1"># ``2D-SCATTER``</span>
               <span class="c1"># (by default) ungridded data values are dispay in a scatter plot.</span>
               <span class="c1"># Plot type &#39;SCATTER&#39;, &#39;SCAT&#39; and &#39;SC&#39; are also recognised.</span>

           <span class="c1"># ``2D-SURFACE``</span>
               <span class="c1"># Gridded data values are dispay in a surface (image) plot.</span>
               <span class="c1"># Plot type &#39;SURFACE&#39;, &#39;SURF&#39; and &#39;SF&#39; are also recognised.</span>

           <span class="c1"># ``2D-CONTOUR``</span>
               <span class="c1"># Gridded data values are dispay in a UNFILLED contour plot.</span>
               <span class="c1"># If this plot type is used, you can specify the number of</span>
               <span class="c1"># contours used with the ``levels`` keyword.</span>
               <span class="c1"># Plot type &#39;CONTOUR&#39;, &#39;CONT&#39; and &#39;CT&#39; are also recognised.</span>

           <span class="c1"># ``2D-CONTOURF``</span>
               <span class="c1"># Gridded data values are dispay in a FILLED contour plot.</span>
               <span class="c1"># If this plot type is used, you can specify the number of</span>
               <span class="c1"># contours used with the ``levels`` keyword.</span>
               <span class="c1"># Plot type &#39;CONTOURF&#39;, &#39;CONTF&#39; and &#39;CF&#39; are also recognised.</span>

           <span class="c1"># ``2D-POSTMAP``</span>
               <span class="c1"># Ungridded data position are dispay in a scatter plot.</span>
               <span class="c1"># It is different from the &#39;2D-SCATTER&#39; plot because</span>
               <span class="c1"># the data value is not represented (all point have the same color).</span>
               <span class="c1"># Plot type &#39;POSTMAP&#39;, &#39;POST&#39; and &#39;PM&#39; are also recognised.</span>

       <span class="c1"># cmapname : str</span>
           <span class="c1"># Name of the color map to be used &#39;gray&#39; for example.</span>
           <span class="c1"># To use a reversed colormap, add &#39;_r&#39; at the end of the colormap name (&#39;gray_r&#39;)</span>
           <span class="c1"># or set ``creversed`` to ``True``.</span>

       <span class="c1"># creversed : bool</span>
           <span class="c1"># Flag to add &#39;_r&#39; at the end of the color map name to reverse it.</span>

       <span class="c1"># fig : Matplotlib figure object</span>
           <span class="c1"># Figure to plot, None by default to create a new figure.</span>
           <span class="c1"># If a figure object is provided, it wiil be cleared before displaying the current data.</span>

       <span class="c1"># filename : str or None</span>
           <span class="c1"># Name of file to save the figure, None (by default).</span>

       <span class="c1"># cmmin : scalar</span>
           <span class="c1"># Minimal value to display in the color map range.</span>

       <span class="c1"># cmmax : scalar</span>
           <span class="c1"># Maximal value to display in the color map range.</span>

       <span class="c1"># interpolation : str,</span>
           <span class="c1"># Interpolation method used for the pixel interpolation (&#39;bilinear&#39; by default).</span>
           <span class="c1"># If interpolation is &#39;none&#39;, then no interpolation is performed for the display.</span>
           <span class="c1"># Supported values are &#39;none&#39;, &#39;nearest&#39;, &#39;bilinear&#39;, &#39;bicubic&#39;,</span>
           <span class="c1"># &#39;spline16&#39;, &#39;spline36&#39;, &#39;hanning&#39;, &#39;hamming&#39;, &#39;hermite&#39;, &#39;kaiser&#39;,</span>
           <span class="c1"># &#39;quadric&#39;, &#39;catrom&#39;, &#39;gaussian&#39;, &#39;bessel&#39;, &#39;mitchell&#39;, &#39;sinc&#39;, &#39;lanczos&#39;.</span>

       <span class="c1"># levels : (int or array-like)</span>
           <span class="c1"># Determines the number and positions of the contour lines / regions.</span>
           <span class="c1"># If an int n, use n data intervals; i.e. draw n+1 contour lines. The level heights are automatically chosen.</span>
           <span class="c1"># If array-like, draw contour lines at the specified levels. The values must be in increasing order.</span>

       <span class="c1"># cmapdisplay : bool</span>
           <span class="c1"># True to display colorbar, False to hide the colorbar.</span>

       <span class="c1"># axisdisplay : bool</span>
           <span class="c1"># True to display axis (and their labels), False to hide axis (and labels).</span>

       <span class="c1"># labeldisplay : bool</span>
           <span class="c1"># True to display labels on axis, False to hide labels on axis.</span>

       <span class="c1"># pointsdisplay : bool</span>
           <span class="c1"># True to display grid points.</span>

       <span class="c1"># dpi : int or None</span>
           <span class="c1"># Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

       <span class="c1"># transparent : bool</span>
           <span class="c1"># Flag to manage transparency when saving the figure into a file (False by default).</span>

       <span class="c1"># logscale : bool</span>
           <span class="c1"># Flag to use a logarithmic color scale.</span>

       <span class="c1"># rects: None or array_like</span>
           <span class="c1"># Coordinates of additional rectanngles to display:</span>
           <span class="c1"># [[x0, y0, w0, h0], [x1, y1, w1, h1], ...].</span>
           <span class="c1"># None by default.</span>

       <span class="c1"># points: None or array_like</span>
           <span class="c1"># Coordinates of additional points to display:</span>
           <span class="c1"># [[x0, y0], [x1, y1], ...]. None by default.</span>

       <span class="c1"># marker: str</span>
           <span class="c1"># Matplotlib marker style for data point display.</span>

       <span class="c1"># markersize: scalar</span>
           <span class="c1"># Size for the marker for data point display.</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># fig : Matplotlib Figure Object</span>
           <span class="c1"># Dataset map figure.</span>

       <span class="c1"># cmap : Matplotlib ColorBar Object</span>
           <span class="c1"># Colorbar associated with the figure if ``cmapdisplay`` is ``True``, ``None`` otherwise.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

      <span class="c1"># # Updating dataset colormap name</span>
       <span class="c1"># if cmapname is None:</span>
           <span class="c1"># cmapname = self.info.cmapname</span>

       <span class="c1"># self.info.cmapname = cmapname</span>

       <span class="c1"># return plot.plot(self, plottype, cmapname, creversed=creversed, fig=fig, filename=filename, cmmin=cmmin, cmmax=cmmax, interpolation=interpolation, levels=levels, cmapdisplay=cmapdisplay, axisdisplay=axisdisplay, labeldisplay=labeldisplay, pointsdisplay=pointsdisplay, dpi=dpi, transparent=transparent, logscale=logscale, rects=rects, points=points, marker=marker, markersize=markersize)</span>

   <span class="c1"># def histo_getlimits(self, valfilt=False):</span>
       <span class="c1"># &#39;&#39;&#39; Return the data min and max values.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># valfilt : bool</span>
           <span class="c1"># If True, min and max are taken from data values.</span>
           <span class="c1"># Otherxise, min and max are taken from data z_image.</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># zmin, zmax : float</span>
           <span class="c1"># Data min and max values.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return histo.getlimits(self, valfilt=valfilt)</span>

<span class="c1"># ###</span>
<span class="c1"># ###</span>
<span class="c1"># ##</span>
<span class="c1"># # TO IMPLEMENT in the next version</span>
<span class="c1"># ##</span>
<span class="c1"># ###</span>
<span class="c1"># ##   def histo_fit(self):</span>
<span class="c1"># ##       &#39;&#39;&#39; &#39;&#39;&#39;</span>
<span class="c1"># ##       return</span>

   <span class="c1"># ### Change name to plot_histo</span>
   <span class="c1"># def histo_plot(self, fig=None, filename=None, zmin=None, zmax=None, cmapname=None, creversed=False, cmapdisplay=False, coloredhisto=True, dpi=None, transparent=False, valfilt=False):</span>
       <span class="c1"># &#39;&#39;&#39; Plot the dataset histogram.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># fig : Matplotlib figure object</span>
           <span class="c1"># Figure to use for the plot, None (by default) to create a new figure.</span>

       <span class="c1"># filename : str or None</span>
           <span class="c1"># Name of file to save the figure, None (by default).</span>

       <span class="c1"># zmin, zmax : float or None</span>
           <span class="c1"># Minimal and maximal values to represent.</span>

       <span class="c1"># cmapname : str</span>
           <span class="c1"># Name of the color map to be used &#39;gray&#39; for example.</span>
           <span class="c1"># To use a reversed colormap, add &#39;_r&#39; at the end of the colormap name (&#39;gray_r&#39;)</span>
           <span class="c1"># or set ``creversed`` to ``True``.</span>

       <span class="c1"># creversed : bool</span>
           <span class="c1"># Flag to add &#39;_r&#39; at the end of the color map name to reverse it.</span>

       <span class="c1"># cmapdisplay : bool</span>
           <span class="c1"># Flag to display a color bar (True by default).</span>

       <span class="c1"># coloredhisto : bool</span>
           <span class="c1"># Flag to color the histogram using the given colormap (True by default). If False, balck will be used.</span>

       <span class="c1"># dpi : int or None</span>
           <span class="c1"># Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

       <span class="c1"># transparent : bool</span>
           <span class="c1"># Flag to manage transparency when saving the figure into a file (False by default).</span>

       <span class="c1"># valfilt : bool</span>
           <span class="c1"># If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
           <span class="c1"># are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`</span>
           <span class="c1"># (False By default).</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># fig : Matplotlib Figure Object</span>
           <span class="c1"># Dataset histogram figure.</span>

       <span class="c1"># cmap : Matplotlib ColorBar Object</span>
           <span class="c1"># Colorbar associated with the figure if ``cmapdisplay`` is ``True``, ``None`` otherwise.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># # Updating dataset colormap name</span>
       <span class="c1"># if cmapname is None:</span>
           <span class="c1"># cmapname = self.info.cmapname</span>

       <span class="c1"># self.info.cmapname = cmapname</span>

       <span class="c1"># return histo.plot(self, fig=fig, filename=filename, zmin=zmin, zmax=zmax, cmapname=cmapname, creversed=creversed, cmapdisplay=cmapdisplay, coloredhisto=coloredhisto, dpi=dpi, transparent=transparent, valfilt=valfilt)</span>

   <span class="c1"># ### Change name to plot_corrmap</span>
   <span class="c1"># def correlation_plotmap(self, method=&quot;Crosscorr&quot; , cmapname=&#39;jet&#39;,</span>
                           <span class="c1"># fig=None, filename=None, dpi=None, transparent=False, showenvelope=False, cmapdisplay=True):</span>
       <span class="c1"># &#39;&#39;&#39; Plot profile-to-profile correlation map.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># method : str, {&#39;Crosscorr&#39;, &#39;Pearson&#39;, &#39;Spearman&#39; or &#39;Kendall&#39;}</span>
           <span class="c1"># Correlation method.</span>

       <span class="c1"># cmapname : str or None</span>
           <span class="c1"># Name of the color map to be used, &#39;gray_r&#39; for example.</span>

       <span class="c1"># fig : Matplotlib figure object</span>
           <span class="c1"># Figure to use for the plot, None (by default) to create a new figure.</span>

       <span class="c1"># filename : str or None</span>
           <span class="c1"># Name of the file to save the figure, None (by default).</span>

       <span class="c1"># dpi : int or None</span>
           <span class="c1"># Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

       <span class="c1"># transparent : bool</span>
           <span class="c1"># Flag to manage transparency when saving the figure into a file (False by default).</span>

       <span class="c1"># showenvelope : bool</span>
           <span class="c1"># Flag to display the correlation map envelope.</span>

       <span class="c1"># cmapdisplay : bool</span>
           <span class="c1"># Flag to display a color bar (True by default).</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># fig : Matplotlib Figure Object</span>
           <span class="c1"># Dataset profile-to-profile correlation map.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return correlation.plotmap(self, method=method, cmapname=cmapname, fig=fig, filename=filename,</span>
                                  <span class="c1"># dpi=dpi, transparent=transparent, showenvelope=showenvelope)</span>

   <span class="c1"># ### Change name to plot_corrsum</span>
   <span class="c1"># def correlation_plotsum(self, fig=None, filename=None, method=&#39;Crosscorr&#39;, dpi=None, transparent=False,</span>
                           <span class="c1"># showenvelope=False, showfit=False):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Plot correlation sum.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># fig : Matplotlib figure object</span>
           <span class="c1"># Figure to use for the plot, None (by default) to create a new figure.</span>

       <span class="c1"># filename : str or None</span>
           <span class="c1"># Name of the file to save the figure, None (by default).</span>

       <span class="c1"># method : str, {&#39;Crosscorr&#39;, &#39;Pearson&#39;, &#39;Spearman&#39; or &#39;Kendall&#39;}</span>
           <span class="c1"># Correlation method.</span>

       <span class="c1"># transparent : bool</span>
           <span class="c1"># Flag to manage transparency when saving the figure into a file (False by default).</span>
           <span class="c1"># (False By default).</span>

       <span class="c1"># showenvelope : bool</span>
           <span class="c1"># Flag to display the curve envelope.</span>

       <span class="c1"># showfit : bool</span>
           <span class="c1"># Flag to display the curve gausian beest fit.</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># fig : Matplotlib Figure Object</span>
           <span class="c1"># Dataset profile-to-profile correlation sum.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return correlation.plotsum(self, fig=fig, filename=filename,</span>
                                  <span class="c1"># method=method, dpi=dpi, transparent=transparent,</span>
                                  <span class="c1"># showenvelope=showenvelope, showfit=showfit)</span>

   <span class="c1"># ### Change name to plot_meantrack</span>
   <span class="c1"># def meantrack_plot(self, fig=None, filename=None, Nprof=0, setmin=None, setmax=None,</span>
                      <span class="c1"># method=&#39;additive&#39;, reference=&#39;mean&#39;, config=&#39;mono&#39;, Ndeg=None,</span>
                      <span class="c1"># plotflag=&#39;raw&#39;, dpi=None, transparent=False):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Plot the dataset mean cross-track profile before and after destriping.</span>

      <span class="c1"># Parameters :</span>

      <span class="c1"># :fig: figure to plot, None by default to create a new figure. `matplotlib.figure.Figure`</span>

      <span class="c1"># :filename: Name of the histogram file to save, None if no file to save.</span>

      <span class="c1"># :Nprof: number of profiles to compute the reference mean</span>

      <span class="c1"># :setmin: float, While computing the mean, do not take into account data values lower than *setmin*.</span>

      <span class="c1"># :setmax: float, While computing the mean, do not take into account data values greater than *setmax*.</span>

      <span class="c1"># :method: destriping method (additive or multiplicative)</span>

      <span class="c1"># :reference: destriping reference (mean and standard deviation or median and interquartile range)</span>

      <span class="c1"># :config: destriping configuration (&#39;mono&#39; sensor: only offset matching (mean / median), &#39;multi&#39; sensor: both offset and gain (standard deviation/interquartile range))</span>

      <span class="c1"># :plotflag: str, {&#39;raw&#39;, &#39;destriped&#39;, &#39;both&#39;} to plot raw, destriped or both data</span>

      <span class="c1"># :Ndeg: polynomial degree of the curve to fit</span>

      <span class="c1"># :transparent: True to manage the transparency.</span>

      <span class="c1"># Returns :</span>

      <span class="c1"># :fig: Figure Object</span>

      <span class="c1"># Note</span>
      <span class="c1"># ----</span>

      <span class="c1"># The mean cross-track profile is the profile composed the mean of each</span>
      <span class="c1"># profile in the dataset.</span>

      <span class="c1"># &#39;&#39;&#39;</span>

      <span class="c1"># return destriping.plot_mean_track(self, fig=fig, filename=filename, Nprof=Nprof, setmin=setmin, setmax=setmax, method=method, reference=reference, config=config,Ndeg=Ndeg, plotflag=plotflag, dpi=dpi, transparent=transparent)</span>

   <span class="c1"># ### Change name to plot_sprectum</span>
   <span class="c1"># def spectral_plotmap(self, fig=None, filename=None, dpi=None, plottype=&#39;magnitude&#39;, logscale=False, cmapdisplay=True, axisdisplay=True, lines=None):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Plot the dataset 2-D Fourier Transform.</span>

       <span class="c1"># Paramters</span>
       <span class="c1"># ---------</span>
       <span class="c1"># fig: figure to plot,</span>
           <span class="c1"># Figure used for the plot. None by default to create a new figure.</span>

       <span class="c1"># filename: str</span>
           <span class="c1"># Name of the file to save the figure. None (default) if no file to save.</span>

       <span class="c1"># dpi: int</span>
           <span class="c1"># &#39;dot per inch&#39; definition of the picture file if filename is not None.</span>

       <span class="c1"># plottype: str {&#39;magnitude&#39; or &#39;amplitude&#39;,&#39;power&#39;,phase&#39;,&#39;real&#39;,&#39;imag&#39;}</span>
           <span class="c1"># Spectrum composante to plot.</span>

       <span class="c1"># logscale: bool</span>
           <span class="c1"># True for a plot with a logarithmic colorscale.</span>

       <span class="c1"># cmapdisplay: bool</span>
           <span class="c1"># True to display colorbar, False to hide the colorbar.</span>

       <span class="c1"># axisdisplay: bool</span>
           <span class="c1"># True to display axis, False to hide the axis.</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># return spectral.plotmap(self, fig=fig, filename=filename, dpi=dpi, plottype=plottype, logscale=logscale, cmapdisplay=cmapdisplay, axisdisplay=axisdisplay, lines=lines)</span>

   <span class="c1"># def plot_directional_filter(self, cmapname=None, creversed=False, fig=None, filename=None, dpi=None, cmapdisplay=True, axisdisplay=True, paramdisplay=False, cutoff=100, azimuth=0, width=2):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Plot the dataset 2-D directional filter.</span>

       <span class="c1"># Paramters</span>
       <span class="c1"># ---------</span>
       <span class="c1"># cmapname : str</span>
           <span class="c1"># Name of the color map to be used, &#39;gray_r&#39; for example.</span>

       <span class="c1"># creversed : bool</span>
           <span class="c1"># True to reverse the color map (add &#39;_r&#39; at the cmapname).</span>

        <span class="c1"># fig : figure to plot,</span>
            <span class="c1"># Figure used for the plot. None by default to create a new figure.</span>

        <span class="c1"># filename : str</span>
            <span class="c1"># Name of the file to save the figure. None (default) if no file to save.</span>

        <span class="c1"># dpi : int</span>
            <span class="c1"># &#39;dot per inch&#39; definition of the picture file if filename is not None.</span>

        <span class="c1"># cmapdisplay : bool</span>
            <span class="c1"># True to display colorbar, False to hide the colorbar.</span>

        <span class="c1"># axisdisplay : bool</span>
            <span class="c1"># True to display axis, False to hide the axis.</span>

        <span class="c1"># axisdisplay : bool</span>
            <span class="c1"># True to display filter parameter in the title.</span>

        <span class="c1"># shape : tuple</span>
            <span class="c1"># Filter shape.</span>

        <span class="c1"># cutoff : ndarray</span>
            <span class="c1"># Input array to filter.</span>

        <span class="c1"># azimuth : scalar</span>
            <span class="c1"># Directional filter azimuth angle in degree.</span>

        <span class="c1"># width : integer</span>
            <span class="c1"># Gaussian filter cutoff frequency.</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># fig : Matplotlib Figure Object</span>

       <span class="c1"># cmap : Matplotlib ColorMap Object</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return spectral.plot_directional_filter(self, cmapname=cmapname, creversed=creversed, fig=fig, filename=filename, dpi=dpi, cmapdisplay=cmapdisplay, axisdisplay=axisdisplay, paramdisplay=paramdisplay,</span>
                                               <span class="c1"># cutoff=cutoff, azimuth=azimuth, width=width)</span>

   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># # DataSet Operations                                                        #</span>
   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># def copy(self):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># To duplicate a DataSet Object.</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :dataset: DataSet Object to duplicate</span>

       <span class="c1"># Returns:</span>

       <span class="c1"># :newdataset: duplicated DataSet Object</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.copy(self)</span>

   <span class="c1"># def interpolate(self, interpolation=&#39;none&#39;, x_step=None, y_step=None, x_prec=2, y_prec=2, x_frame_factor=0., y_frame_factor=0.):</span>
       <span class="c1"># &#39;&#39;&#39; Dataset gridding.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># interpolation : str {&#39;none&#39;, &#39;nearest&#39;, &#39;linear&#39;, &#39;cubic&#39;}</span>
           <span class="c1"># Method used to grid the dataset. Can be:</span>

           <span class="c1"># ``none``</span>
               <span class="c1"># (by default) simply projects raw data on a regular grid without interpolation.</span>
               <span class="c1"># Holes are filled with NaNs and values falling in the same grid cell are averaged.</span>

           <span class="c1"># ``nearest``</span>
               <span class="c1"># return the value at the data point closest to</span>
               <span class="c1"># the point of interpolation.</span>

           <span class="c1"># ``linear``</span>
               <span class="c1"># tesselate the input point set to n-dimensional</span>
               <span class="c1"># simplices, and interpolate linearly on each simplex.</span>

           <span class="c1"># ``cubic``</span>
               <span class="c1"># return the value determined from a</span>
               <span class="c1"># piecewise cubic, continuously differentiable (C1), and</span>
               <span class="c1"># approximately curvature-minimizing polynomial surface.</span>

       <span class="c1"># x_step, y_step : float or None</span>
           <span class="c1"># Gridding step in the x and y direction.</span>
           <span class="c1"># Use None (by default) to estimate the median x- and y-step from data values.</span>

       <span class="c1"># x_prec, y_prec : int or None</span>
           <span class="c1"># Decimal precision to keep for the grid computation.</span>
           <span class="c1"># None (by default) to use the maximal number of decimal present in the data values coordinates.</span>

       <span class="c1"># x_frame_factor :</span>
           <span class="c1"># Frame extension coefficient along x axis (e.g. 0.1 means xlength +10% on each side, i.e. xlength +20% in total) ; pixels within extended borders will be filled with &quot;nan&quot;</span>

       <span class="c1"># y_frame_factor :</span>
           <span class="c1"># Frame extension coefficient along y axis (e.g. 0.45 means yheight +45% top and bottom, i.e. yheight +90% in total) ; pixels within extended borders will be filled with &quot;nan&quot;</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># Gridded DataSet object.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.interpolate(self, interpolation=interpolation, x_step=x_step, y_step=y_step, x_prec=x_prec, y_prec=y_prec, x_frame_factor=x_frame_factor, y_frame_factor=y_frame_factor)</span>

   <span class="c1"># def sample(self):</span>
       <span class="c1"># &#39;&#39;&#39; Re-sample data at ungridded sample position from gridded Z_image.</span>

       <span class="c1"># Re-sample ungridded values from gridded Z_image using a</span>
       <span class="c1"># cubic spline spline interpolation.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.sample(self)</span>

   <span class="c1"># def regrid(self, x_step=None, y_step=None, method=&#39;cubic&#39;):</span>
       <span class="c1"># &#39;&#39;&#39; Dataset re-gridding.</span>

       <span class="c1"># During regridding, a copy of the dataset is re-sampled</span>
       <span class="c1"># (see :meth:`~geophpy.dataset.DataSet.sample`)</span>
       <span class="c1"># and interpolated with the given x and y-steps.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># x_step, y_step : float or None</span>
           <span class="c1"># Gridding step in the x and y direction.</span>
           <span class="c1"># Use None (by default) to resample current grid by a factor 2 (step_new = step_old*0.5).</span>

       <span class="c1"># method : str {&#39;cubic&#39;, &#39;nearest&#39;, &#39;linear&#39;}</span>
           <span class="c1"># Method used to re-grid the dataset. see :meth:`~geophpy.dataset.DataSet.interpolate`</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># Re-gridded DataSet object.</span>

       <span class="c1"># Note</span>
       <span class="c1"># ----</span>
       <span class="c1"># Only the grid is affected and the ungriddedd data values are kept unchanged.</span>
       <span class="c1"># to propagate a change in the ungriddedd data values,</span>
       <span class="c1"># you may want to use the filters ``valfilt`` keyword or the association of</span>
       <span class="c1"># :meth:`~geophpy.dataset.DataSet.sample` and</span>
       <span class="c1"># :meth:`~geophpy.dataset.DataSet.sample`.</span>

       <span class="c1"># See Also</span>
       <span class="c1"># --------</span>
       <span class="c1"># sample, interpolate</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.regrid(self, x_step=None, y_step=None, method=&#39;cubic&#39;)</span>

   <span class="c1"># def stats(self, valfilt=True, valmin=None, valmax=None):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Computes the dataset basic statistics.</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :dataset: DataSet Object from which to compute stats.</span>

       <span class="c1"># :valfilt: if set to True, computes on data.values instead of data.z_image.</span>

       <span class="c1"># :valmin, valmax: Consider only data values between valmin and valmax.</span>

       <span class="c1"># Returns:</span>

       <span class="c1"># :mean, std, median: array arithmetic mean, standard deviation and median.</span>

       <span class="c1"># :Q1, Q3: dataset 1st and 3rd quartiles (25th and 75th percentiles).</span>

       <span class="c1"># :IQR: dataset interquartile range (Q3 - Q1).</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.stats(self, valfilt=valfilt, valmin=valmin, valmax=valmax)</span>

   <span class="c1"># def add(self, val=0, valfilt=True, zimfilt=True):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Add a constant to the dataset Values and Z_image.</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :val: constant to add.</span>

       <span class="c1"># :valfilt: flag to add constant on dataset values.</span>

       <span class="c1"># :zimfilt: flag to add constant on dataset z_image.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.add_constant(self, constant=val, valfilt=valfilt, zimfilt=zimfilt)</span>

   <span class="c1"># def times(self, val=1, valfilt=True, zimfilt=True):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Multiply by a constant the dataset Values and Z_image</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :val: constant to multiply by.</span>

       <span class="c1"># :valfilt: flag to add constant on dataset values.</span>

       <span class="c1"># :zimfilt: flag to add constant on dataset z_image.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.times_constant(self, constant=val, valfilt=valfilt, zimfilt=zimfilt)</span>

   <span class="c1"># def setmedian(self, median=None, method=&#39;additive&#39;):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Set the dataset values and Z_image to a given value</span>
       <span class="c1"># (for instance zero for zero median surveys).</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :median: target value to set the dataset median to.</span>

       <span class="c1"># :method: method used to set the median (&#39;additive&#39; or &#39;multiplicative&#39;).</span>

       <span class="c1"># :profilefilter: ...TBD... True: set each survey profiles median to &#39;median&#39;.</span>
                       <span class="c1"># False: set the global survey median to &#39;median&#39;.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.setmedian(self, median=median, method=method)</span>

   <span class="c1"># def setmean(self, mean=None, method=&#39;additive&#39;):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Set the dataset values and Z_image to a given value</span>
       <span class="c1"># (for instance zero for zero median surveys).</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :mean: value to set the dataset mean to.</span>

       <span class="c1"># :method: method used to set the mean (&#39;additive&#39; or &#39;multiplicative&#39;).</span>

       <span class="c1"># :profilefilter: ...TBD... True: set each survey profiles mean to &#39;mean&#39;.</span>
                       <span class="c1"># False: set the global survey mean to &#39;mean&#39;.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.setmean(self, mean=mean, method=method)</span>

   <span class="c1"># def translate(self, shiftx=0, shifty=0):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Dataset translation.</span>

       <span class="c1"># Parameters:</span>

       <span class="c1"># :shiftx: Constant to apply to the x-abscisse.</span>

       <span class="c1"># :shifty: Constant to apply to the y-abscisse.</span>

       <span class="c1"># Returns:</span>

       <span class="c1"># Translated DataSet object.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.translate(self, shiftx=shiftx, shifty=shifty)</span>

   <span class="c1"># def rotate(self, angle=0, center=None):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Dataset rotation (clockwise).</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>

       <span class="c1"># angle: float</span>
           <span class="c1"># Rotation angle (in °).</span>

       <span class="c1"># center: str {None, &#39;BL&#39;, &#39;BR&#39;, &#39;TL, &#39;TR&#39;}</span>
           <span class="c1"># Center of rotation: &#39;BL&#39;, &#39;BR&#39;, &#39;TL and &#39;TR&#39; for bottom left,</span>
           <span class="c1"># bottom rght, top left and top right corner.</span>
           <span class="c1"># If None,  the dataset centroid will be used.</span>

       <span class="c1"># Returns:</span>

       <span class="c1"># Rotated DataSet object.</span>
       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.rotate(self, angle=angle, center=center)</span>


<span class="c1"># ##   def matchedges(self, datasets, matchmethod=&#39;equalmedian&#39;, setmed=None, valfilt=True, setmethod=&#39;additive&#39;):</span>
<span class="c1"># ##       &#39;&#39;&#39;</span>
<span class="c1"># ##       &#39;&#39;&#39;</span>
<span class="c1"># ##       return genop.matchedges(datasets, matchmethod=matchmethod, setmed=setmed, valfilt=valfilt, setmethod=setmethod)</span>

   <span class="c1"># #staticmethod</span>
   <span class="c1"># #def merge(datasetlist, matchmethod=None, setval=None, setmethod=&#39;additive&#39;, meanrange=None):</span>
   <span class="c1"># def merge(self, datasets, matchmethod=None, setval=None, setmethod=&#39;additive&#39;, meanrange=None):</span>
       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># Merge datasets together.</span>

       <span class="c1"># Parameters</span>
       <span class="c1"># ----------</span>
       <span class="c1"># datasetlist : tuple or list.</span>
           <span class="c1"># Sequence of datasets to merge. Each DataSet Object must have the same coordinates system.</span>

       <span class="c1"># matchmethod :</span>

       <span class="c1"># setmethod : {&#39;additive&#39;, &#39;multiplicative&#39;}</span>
           <span class="c1"># Method used to merge the datasets ## TODO Complete docstring.</span>

       <span class="c1"># setval :</span>

       <span class="c1"># meanrange :</span>

       <span class="c1"># Returns</span>
       <span class="c1"># -------</span>
       <span class="c1"># merged :  new DataSet Object.</span>

       <span class="c1"># &#39;&#39;&#39;</span>
       <span class="c1"># # Empty Merge DataSet</span>
       <span class="c1"># datasetout = DataSet._new()</span>
       <span class="c1"># genop.merge(datasetout, datasets, matchmethod=matchmethod, setval=setval, setmethod=setmethod, meanrange=meanrange)</span>

       <span class="c1"># return datasetout</span>

   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># # DataSet Coordinates/values                                                #</span>
   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># def get_xgrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset x-coordinate matrix of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xgrid(self)</span>

   <span class="c1"># def get_ygrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset y-coordinate matrix of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_ygrid(self)</span>

   <span class="c1"># def get_xygrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset x- and y-coordinate matrices of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xygrid(self)</span>

   <span class="c1"># def get_grid_values(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.z_image</span>

   <span class="c1"># def get_gridcorners(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset grid corners coordinates.</span>

       <span class="c1"># Returns ``None`` if no interpolation was made.</span>
       <span class="c1"># Use :meth:~geophpy.dataset.DataSet.get_boundingbox`</span>
       <span class="c1"># to get the ungridded data values&#39; bounding box.</span>

       <span class="c1"># &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_gridcorners(self)</span>

   <span class="c1"># def get_gridextent(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset grid extent. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_gridextent(self)</span>

   <span class="c1"># def get_xvect(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset x-coordinate vector of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xvect(self)</span>

   <span class="c1"># def get_yvect(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset y-coordinate vector of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_yvect(self)</span>

   <span class="c1"># def get_xyvect(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return dataset x- and y-coordinate vectors of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xyvect(self)</span>

   <span class="c1"># def get_xvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the x-coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xvalues(self)</span>

   <span class="c1"># def get_yvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the y-coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_yvalues(self)</span>

   <span class="c1"># def get_values(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_values(self)</span>

   <span class="c1"># def get_xyvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the x- and y-coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xyvalues(self)</span>

   <span class="c1"># def get_xyzvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return both the x, y-coordinates and dataset ungridded values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_xyzvalues(self)</span>

   <span class="c1"># def get_boundingbox(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the coordinates (BL, BR, TL, TR) of the box bouding the data values. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_boundingbox(self)</span>

   <span class="c1"># def get_median_xstep(self, prec=2):</span>
       <span class="c1"># &#39;&#39;&#39; Return the median step between two distinct x values rounded to the given precision. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_median_xstep(self, prec=prec)</span>

   <span class="c1"># def get_median_ystep(self, prec=2):</span>
       <span class="c1"># &#39;&#39;&#39; Return the median step between two distinct y values rounded to the given precision. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_median_ystep(self, prec=prec)</span>

   <span class="c1"># def get_median_xystep(self, x_prec=2, y_prec=2):</span>
       <span class="c1"># &#39;&#39;&#39; Return the median steps between two distinct x and y values rounded to the given precisions. &#39;&#39;&#39;</span>

       <span class="c1"># return genop.get_median_xystep(self, x_prec=x_prec, y_prec=y_prec)</span>

   <span class="c1"># def get_georef_xvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the easting coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.easting</span>

   <span class="c1"># def get_georef_yvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the northing coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.northing</span>

   <span class="c1"># def get_georef_xyvalues(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the easting and northing coordinates from the dataset values. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.easting, self.data.northing</span>

   <span class="c1"># def get_georef_xgrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the easting coordinates matrices of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.easting_image</span>

   <span class="c1"># def get_georef_ygrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the northing coordinates matrices of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.northing_image</span>

   <span class="c1"># def get_georef_xygrid(self):</span>
       <span class="c1"># &#39;&#39;&#39; Return the easting and northing coordinates matrices of the Z_image. &#39;&#39;&#39;</span>

       <span class="c1"># return self.data.easting_image, self.data.northing_image</span>

   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># # DataSet Geopositioning                                                    #</span>
   <span class="c1"># #---------------------------------------------------------------------------#</span>
   <span class="c1"># def to_kml(self, plottype, cmapname, kmlfilename, creversed=False, picturefilename=&quot;image.png&quot;, cmmin=None, cmmax=None, interpolation=&#39;bilinear&#39;, dpi=100):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Plot in 2D dimensions the cartography representation to export in google earth.</span>

      <span class="c1"># Parameters :</span>

      <span class="c1"># :plottype: plotting type, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, ...xyz</span>

      <span class="c1"># :cmapname: name of the color map used.</span>

      <span class="c1"># :kmlfilename: name of the kml file to create</span>

      <span class="c1"># :creversed: True to add &#39;_r&#39; at the cmname to reverse the color map</span>

      <span class="c1"># :picturefilename: name of the picture file to save, None if no file to save.</span>

      <span class="c1"># :cmmin: minimal value to display in the color map range.</span>

      <span class="c1"># :cmmax: maximal value to display in the color map range.</span>

      <span class="c1"># :interpolation: interpolation mode to display DataSet Image (&#39;bilinear&#39;, &#39;nearest&#39;, &#39;bicubic&#39;), &#39;bilinear&#39; by default.</span>

      <span class="c1"># :cmapdisplay: True to display color map bar, False to hide the color map bar.</span>

      <span class="c1"># :axisdisplay: True to display axis and labels, False to hide axis and labels</span>

      <span class="c1"># :dpi: &#39;dot per inch&#39; definition of the picture file if filename != None</span>

      <span class="c1"># Returns:</span>

      <span class="c1"># :success: True if success, False if not.</span>

      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># # calculation of the 4 points utm coordinates</span>
      <span class="c1"># success, [blcorner, brcorner, urcorner, ulcorner] = self.getquadcoords()</span>

      <span class="c1"># if (success == True):</span>
         <span class="c1"># # utm to wgs84 conversion</span>
         <span class="c1"># blcorner_wgs84_lat, blcorner_wgs84_lon = geopos.utm_to_wgs84(blcorner.utm_easting, blcorner.utm_northing, self.georef.utm_zonenumber, self.georef.utm_zoneletter)</span>
         <span class="c1"># brcorner_wgs84_lat, brcorner_wgs84_lon = geopos.utm_to_wgs84(brcorner.utm_easting, brcorner.utm_northing, self.georef.utm_zonenumber, self.georef.utm_zoneletter)</span>
         <span class="c1"># urcorner_wgs84_lat, urcorner_wgs84_lon = geopos.utm_to_wgs84(urcorner.utm_easting, urcorner.utm_northing, self.georef.utm_zonenumber, self.georef.utm_zoneletter)</span>
         <span class="c1"># ulcorner_wgs84_lat, ulcorner_wgs84_lon = geopos.utm_to_wgs84(ulcorner.utm_easting, ulcorner.utm_northing, self.georef.utm_zonenumber, self.georef.utm_zoneletter)</span>

         <span class="c1"># quadcoords = [(blcorner_wgs84_lon, blcorner_wgs84_lat), (brcorner_wgs84_lon, brcorner_wgs84_lat), (urcorner_wgs84_lon, urcorner_wgs84_lat), (ulcorner_wgs84_lon, ulcorner_wgs84_lat)]</span>

         <span class="c1"># # creation of the picture file to overlay</span>
         <span class="c1"># self.plot(plottype, cmapname, creversed, fig=None, filename=picturefilename, cmmin=cmmin, cmmax=cmmax, interpolation=interpolation, cmapdisplay=False, axisdisplay=False, dpi=dpi, transparent=True)</span>

         <span class="c1"># # creation of the kml file</span>
         <span class="c1"># kml.picture_to_kml(picturefilename, quadcoords, kmlfilename)</span>

      <span class="c1"># return success</span>

   <span class="c1"># def to_raster(self, plottype, cmapname, picturefilename, creversed=False, cmmin=None, cmmax=None, interpolation=&#39;bilinear&#39;, dpi=100):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Plot in 2D dimensions the cartography representation with the world file associated, to using in a SIG application.</span>

      <span class="c1"># Parameters:</span>

      <span class="c1"># :plottype: plotting type, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, ...xyz</span>

      <span class="c1"># :cmapname: name of the color map used.</span>

      <span class="c1"># :picturefilename: name of the picture file to save (.jpg, .jpeg, .tif, .tiff, .png) , None if no file to save.</span>

      <span class="c1"># :creversed: True to add &#39;_r&#39; at the cmname to reverse the color map</span>

      <span class="c1"># :cmmin: minimal value to display in the color map range.</span>

      <span class="c1"># :cmmax: maximal value to display in the color map range.</span>

      <span class="c1"># :interpolation: interpolation mode to display DataSet Image (&#39;bilinear&#39;, &#39;nearest&#39;, &#39;bicubic&#39;), &#39;bilinear&#39; by default.</span>

      <span class="c1"># :dpi: &#39;dot per inch&#39; definition of the picture file</span>

      <span class="c1"># Returns:</span>

      <span class="c1"># :success: True if success, False if not.</span>

      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># # calculation of the 4 points utm coordinates</span>
      <span class="c1"># success, [blcorner, brcorner, urcorner, ulcorner] = self.getquadcoords()</span>

      <span class="c1"># if (success == True):</span>
         <span class="c1"># # tests if picture format available for raster</span>
         <span class="c1"># success = raster.israsterformat(picturefilename)</span>

         <span class="c1"># if (success == True):</span>
            <span class="c1"># quadcoords = [(blcorner.utm_easting, blcorner.utm_northing), (brcorner.utm_easting, brcorner.utm_northing), (urcorner.utm_easting, urcorner.utm_northing), (ulcorner.utm_easting, ulcorner.utm_northing)]</span>

            <span class="c1"># # creation of the picture file to overlay</span>
            <span class="c1"># self.plot(plottype, cmapname, creversed, fig=None, filename=picturefilename, cmmin=cmmin, cmmax=cmmax, interpolation=interpolation, cmapdisplay=False, axisdisplay=False, dpi=dpi, transparent=True)</span>

            <span class="c1"># # creation of the world file</span>
            <span class="c1"># success = raster.picture_to_worldfile(picturefilename, quadcoords)</span>

      <span class="c1"># return success</span>

   <span class="c1"># def setgeoref(self, refsystem, points_list, utm_zoneletter=None, utm_zonenumber=None, valfilt=False):</span>
      <span class="c1"># &#39;&#39;&#39; Georeferencing dataset using 2-D linear interpolation.</span>

      <span class="c1"># Dataset is georeferenced using a list of Ground Control Points (GCPs).</span>
      <span class="c1"># The geographic positions are linearly interpolated in 2-D at the dataset position.</span>

      <span class="c1"># As no exrapolatio is available yet, there must GCPs that spatially includes</span>
      <span class="c1"># the dataset positions (typically grid nodes).</span>

      <span class="c1"># Parameters</span>
      <span class="c1"># ----------</span>
      <span class="c1"># refsystem : str or None</span>
          <span class="c1"># Geographic reference system (&#39;UTM&#39;, &#39;WGS84&#39;, ...).</span>

      <span class="c1"># points_list : list</span>
          <span class="c1"># List of GCPs points. ex:</span>
          <span class="c1"># [[num1, lat1, lon1, x1, y1], ..., [numN, latN, lonN, xN, yN]].</span>

      <span class="c1"># utm_zoneletter : str or None</span>
        <span class="c1"># UTM zone letter if `refsystem` is &#39;UTM&#39;.</span>

      <span class="c1"># utm_zonenumber : int or None</span>
          <span class="c1"># UTM zone number if `refsystem` is &#39;UTM&#39;.</span>

      <span class="c1"># valfilt : bool</span>
          <span class="c1"># If True, the ungridded dataset value (class:`~values`) are used instead</span>
          <span class="c1"># of the gridded (class:`~z_images`).</span>
          <span class="c1"># Then, the georeferenced coordinates will be stored in :obj:`eatsing` and :obj:`northing`</span>
          <span class="c1"># instead of :obj:`easting_image` and :obj:`northing_image`.</span>

      <span class="c1"># Returns</span>
      <span class="c1"># -------</span>
      <span class="c1"># error : {0, -1, -2}</span>
          <span class="c1"># Error code.</span>
          <span class="c1"># 0 if no error occured.</span>
          <span class="c1"># -1 if there are not enough points.</span>
          <span class="c1"># -2 if an error occured during georeferenincg,</span>
          <span class="c1"># probably the dataset are unconsistent with the GCPs area.</span>

      <span class="c1"># Georeferenced dataset object</span>

      <span class="c1"># &#39;&#39;&#39;</span>

      <span class="c1"># return gengeopositioning.setgeoref(self, refsystem, points_list,</span>
                                         <span class="c1"># utm_zoneletter=utm_zoneletter,</span>
                                         <span class="c1"># utm_zonenumber=utm_zonenumber,</span>
                                         <span class="c1"># valfilt=valfilt)</span>

   <span class="c1"># def getquadcoords(self):</span>
      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># Calculates the utm coordinates of the DataSet Image corners.</span>

      <span class="c1"># Returns:</span>

      <span class="c1"># :success: True if coordinates getted, False if not</span>

      <span class="c1"># :bottomleft: utm coordinates of the bottom left corner</span>

      <span class="c1"># :bottomright: utm coordinates of the bottom right corner</span>

      <span class="c1"># :upright: utm coordinates of the up right corner</span>

      <span class="c1"># :upleft: utm coordinates of the up left corner</span>

      <span class="c1"># &#39;&#39;&#39;</span>
      <span class="c1"># bottomleft = None</span>
      <span class="c1"># bottomright = None</span>
      <span class="c1"># upright = None</span>
      <span class="c1"># upleft = None</span>
      <span class="c1"># if (self.georef.active == True):</span>
         <span class="c1"># bottomleft = GeoRefPoint()</span>
         <span class="c1"># bottomright = GeoRefPoint()</span>
         <span class="c1"># upright = GeoRefPoint()</span>
         <span class="c1"># upleft = GeoRefPoint()</span>
         <span class="c1"># bottomleft.utm_easting, bottomleft.utm_northing = self.data.easting_image[0][0], self.data.northing_image[0][0]</span>
         <span class="c1"># bottomright.utm_easting, bottomright.utm_northing = self.data.easting_image[0][-1], self.data.northing_image[0][-1]</span>
         <span class="c1"># upleft.utm_easting, upleft.utm_northing = self.data.easting_image[-1][0], self.data.northing_image[-1][0]</span>
         <span class="c1"># upright.utm_easting, upright.utm_northing = self.data.easting_image[-1][-1], self.data.northing_image[-1][-1]</span>

      <span class="c1"># return self.georef.active, [bottomleft, bottomright, upright, upleft]</span>

   <span class="c1">#---------------------------------------------------------------------------#</span>
   <span class="c1"># DataSet General Processing                                                #</span>
   <span class="c1">#---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="DataSet.threshold"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.threshold">[docs]</a>   <span class="k">def</span> <span class="nf">threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Threshold a dataset in the given interval.</span>

<span class="sd">      Returns the thresholded :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      setmin : float</span>
<span class="sd">          Minimal interval value.</span>
<span class="sd">          All values lower than ``setmin`` will be replaced by ``setmin``</span>
<span class="sd">          (if both ``setmed`` and ``setnan`` are False).</span>

<span class="sd">      setmax : float</span>
<span class="sd">          Maximal interval value.</span>
<span class="sd">          All values lower than ``setmax`` will be replaced by ``setmax``</span>
<span class="sd">          (if both ``setmed`` and ``setnan`` are False).</span>

<span class="sd">      setmed : bool</span>
<span class="sd">          If set to True, out of range values are replaced by the profile&#39;s median.</span>

<span class="sd">      setnan : bool</span>
<span class="sd">          If set to True, out of range values are replaced by NaNs</span>

<span class="sd">      valfilt : bool</span>
<span class="sd">          If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">          are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">      Note</span>
<span class="sd">      ----</span>
<span class="sd">      If both ``setnan`` and ``setmed`` are True at the same time, ``setnan`` prevails.</span>

<span class="sd">      &#39;&#39;&#39;</span>
      <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span> <span class="n">setmed</span><span class="o">=</span><span class="n">setmed</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="n">setnan</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.peakfilt"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.peakfilt">[docs]</a>   <span class="k">def</span> <span class="nf">peakfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hampel&#39;</span><span class="p">,</span> <span class="n">halfwidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Eliminate peaks from the dataset.</span>

<span class="sd">       Returns the de-peaked :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>

<span class="sd">       method : str {&#39;median&#39;, &#39;hampel&#39;}</span>
<span class="sd">           Type of the ``decision-theoric filter`` used to determine outliers.</span>

<span class="sd">       halfwidth : scalar</span>
<span class="sd">           Filter half-width.</span>

<span class="sd">       threshold : scalar (positive)</span>
<span class="sd">           Filter threshold parameter.</span>
<span class="sd">           If t=0 and method=&#39;hampel&#39;, it is equal to a ``standard median filter``.</span>

<span class="sd">       mode : str {&#39;relative&#39;, &#39;absolute&#39;}</span>
<span class="sd">           Median filter mode. If &#39;relative&#39;, the threshold is a percentage of the local</span>
<span class="sd">           median value. If &#39;absolute&#39;, the threshold is a value.</span>

<span class="sd">       setnan : bool</span>
<span class="sd">           If True, the outliers are replaced by nan instead of the local median.</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">peakfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">halfwidth</span><span class="o">=</span><span class="n">halfwidth</span><span class="p">,</span>
                                      <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="n">setnan</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.medianfilt"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.medianfilt">[docs]</a>   <span class="k">def</span> <span class="nf">medianfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Apply a median filter (*decision-theoretic* or *standard*) to the dataset.</span>

<span class="sd">       Returns the filtered :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       nx : int</span>
<span class="sd">           Size, in number of sample, of the filer in the x-direction.</span>

<span class="sd">       ny : int</span>
<span class="sd">           Size, in number of sample, of the filter in the y-direction.</span>

<span class="sd">       percent : float</span>
<span class="sd">           Threshold deviation (in percents) to the local median value (for absolute field measurements).</span>

<span class="sd">       gap : float</span>
<span class="sd">           Threshold deviation (in raw units) to the median value (for relative anomaly measurements).</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">medianfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span> <span class="n">percent</span><span class="o">=</span><span class="n">percent</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="n">gap</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.festoonfilt"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.festoonfilt">[docs]</a>   <span class="k">def</span> <span class="nf">festoonfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Crosscorr&#39;</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">corrmin</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">uniformshift</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Filters festoon-like artefacts out of in the dataset.</span>

<span class="sd">       Returns the destaggered :func:`~geophpy.dataset.DataSet` object</span>
<span class="sd">       and the shift used for each profile.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       method : str, {&#39;Crosscorr&#39;, &#39;Pearson&#39;, &#39;Spearman&#39; or &#39;Kendall&#39;} (from :func:`~geophpy.dataset.festooncorrelation_getlist`)</span>
<span class="sd">           Correlation method to use to compute the correlation coefficient in the correlation map.</span>

<span class="sd">       shift : scalar or array of float</span>
<span class="sd">           Shift value (in pixels) to apply to the dataset profile.</span>
<span class="sd">           If shit=0, the shift will be determined for each profile by correlation with neighbours.</span>
<span class="sd">           If shift is a vector each value in shift will be applied to its corresponding odd profile.</span>
<span class="sd">           In that case shift must have the same size as the number of odd profiles.</span>

<span class="sd">       corrmin : scalar in the range [0-1]</span>
<span class="sd">           Minimum correlation coefficient value to allow shifting.</span>

<span class="sd">       uniformshift : bool</span>
<span class="sd">           If True, the shift is uniform on the map. If False the shift depends on each profile.</span>

<span class="sd">       setmin : float</span>
<span class="sd">           Data values lower than ``setmin`` are ignored.</span>

<span class="sd">       setmax : float</span>
<span class="sd">           Data values higher than ``setmax`` are ignored.</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       Returns</span>
<span class="sd">       -------</span>
<span class="sd">       shift : array of float</span>
<span class="sd">           Shift values used to destagger the dataset (unmodified if provided as an input parameter).</span>

<span class="sd">       See Also</span>
<span class="sd">       --------</span>
<span class="sd">       correlmap, correlshift</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>
<span class="sd">       The festoon-like artefacts are filtered based on the correlation between</span>
<span class="sd">       neighboring profiles.</span>

<span class="sd">       For each odd profile index in the dataset, the correlation with its</span>
<span class="sd">       neighboring profile is calculated using the provided ``correlation method``.</span>
<span class="sd">       Then, the profile is shifted from a sample and the correlation is computed</span>
<span class="sd">       anew and so forth to build a ``correlation map`` fo revery possible shift.</span>
<span class="sd">       For each profile, the shift with the maximum correlation coefficient is</span>
<span class="sd">       chosen as the ``best shift`` and used to destagger the dataset.</span>
<span class="sd">       It the shift is set to be uniform on the map, the correlation map is</span>
<span class="sd">       summed up and the shit correspoding to the global maximum correlation</span>
<span class="sd">       coefficient is used for each odd profile.</span>

<span class="sd">       Alternatively, if a custom ``set of shift`` is provided, it will be used to</span>
<span class="sd">       destagger the dataset. It must have the same size as the number of odd profile</span>
<span class="sd">       in the dataset.</span>

<span class="sd">       Example</span>
<span class="sd">       -------</span>

<span class="sd">       &gt;&gt;&gt; dataset.festoonfilt(method=&#39;Crosscorr&#39;, shift=0, corrmin=0.6, uniformshift=False)</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">festoonfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
                                        <span class="n">corrmin</span><span class="o">=</span><span class="n">corrmin</span><span class="p">,</span> <span class="n">uniformshift</span><span class="o">=</span><span class="n">uniformshift</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.correlmap"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.correlmap">[docs]</a>   <span class="k">def</span> <span class="nf">correlmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Crosscor&#39;</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39; Profile-to-profile correlation map.</span>

<span class="sd">       Each even profile in the dataset is incrementally shifted and</span>
<span class="sd">       the correlation coefficient is computed against the (standardized) mean</span>
<span class="sd">       of the two neighbouring profiles for each shift value.</span>

<span class="sd">       Profiles are considered to be vertical and the shift is performed along</span>
<span class="sd">       the profile direction (y-direction).</span>
<span class="sd">       For a dataset of size ny*nx , the correlation map size is then 2*ny*nx</span>
<span class="sd">       (shift may vary from -ymax to +ymax).</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       method : str, {&#39;Crosscor&#39;, &#39;Pearson&#39;, &#39;Spearman&#39;, &#39;Kendall&#39;}</span>
<span class="sd">           Correlation method use.</span>

<span class="sd">       Returns</span>
<span class="sd">       -------</span>
<span class="sd">       cormap : 2-D array_like</span>
<span class="sd">           Profile-to-profile correlation map.</span>

<span class="sd">       pva1 : 2-D array_like</span>
<span class="sd">           Correlation weight map.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">correlmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.zeromeanprofile"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.zeromeanprofile">[docs]</a>   <span class="k">def</span> <span class="nf">zeromeanprofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setvar</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Subtract the mean (or median) of each profile in the dataset.</span>

<span class="sd">       Returns the zero-mean (or zero-median) :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       setvar: str, {&#39;mean&#39;, &#39;median&#39;}</span>
<span class="sd">           Profile&#39;s statistical property be subtracted from each profile.</span>

<span class="sd">       setmin: float</span>
<span class="sd">           While computing the mean, do not take into account data values lower than *setmin*.</span>

<span class="sd">       setmax: float</span>
<span class="sd">           While computing the mean, do not take into account data values greater than *setmax*.</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       See Also</span>
<span class="sd">       --------</span>
<span class="sd">       destripecon, destripecub</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>
<span class="sd">       For each profile in the dataset, the mean (or median depending on</span>
<span class="sd">       ``setvar``) is calculated and subtracted from the profile.</span>

<span class="sd">       This is equivalent to the :func:`~geophpy.dataset.DataSet.destripecon` method in</span>
<span class="sd">       configuration ``mono sensor`` using the ``additive`` destriping ``method`` and a</span>
<span class="sd">       ``number of profile`` for the calculation equals to ``zero``.</span>

<span class="sd">       Examples</span>
<span class="sd">       --------</span>
<span class="sd">       &gt;&gt;&gt; dataset.zeromeanprofile(setvar=&#39;median&#39;)</span>
<span class="sd">           equivalent to</span>
<span class="sd">       &gt;&gt;&gt; dataset.destripecon(Nprof=0, method=&#39;additive&#39;, config=&#39;mono&#39;, reference=&#39;median&#39;)</span>
<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">zeromeanprofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setvar</span><span class="o">=</span><span class="n">setvar</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.destripecon"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.destripecon">[docs]</a>   <span class="k">def</span> <span class="nf">destripecon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="s1">&#39;mono&#39;</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Destriping dataset using profiles&#39; statistical moments (Moment Matching method).</span>

<span class="sd">       Moment Matching method: the statistical moments (mean and standard deviation)</span>
<span class="sd">       of each profile in the dataset are computed and matched to reference values.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       Nprof : int or str (&#39;all&#39;)</span>
<span class="sd">           Number of neighboring profiles used to compute the the reference values.</span>
<span class="sd">           Set to ``&#39;all&#39;`` by default) to compute the mean over the whole dataset.</span>
<span class="sd">           If set to ``0``, it is the zero-mean (or zero-median) traverse filter.</span>

<span class="sd">       setmin : float or None</span>
<span class="sd">           While computing the mean, do not take into account data values lower than ``setmin``.</span>
<span class="sd">           If ``None``, all data are considered.</span>

<span class="sd">       setmax : float or None</span>
<span class="sd">           While computing the mean, do not take into account data values greater than ``setmax``.</span>
<span class="sd">           If ``None``, all data are considered.</span>

<span class="sd">       method : str {&#39;additive&#39;,&#39;multiplicative&#39;}</span>
<span class="sd">           Destriping methode.</span>
<span class="sd">           If set to ``&#39;additive&#39;`` (default), destriping is done additively.</span>
<span class="sd">           If set to ``&#39;multiplicative&#39;``, it is done multiplicatively.</span>

<span class="sd">       reference : str {&#39;mean&#39; &#39;median&#39;}</span>
<span class="sd">           References used for destriping.</span>
<span class="sd">           If set to ``&#39;mean&#39;`` (default), destriping is done using mean and standard deviation.</span>
<span class="sd">           If set to ``&#39;median&#39;``, destriping is done using median and interquartile range.</span>

<span class="sd">       config : str {&#39;mono&#39;,&#39;multi&#39;}</span>
<span class="sd">           Sensors configuration.</span>
<span class="sd">           If set to ``&#39;mono&#39;`` (default), destriping is done using only offset matching (mean or median).</span>
<span class="sd">           If set to ``&#39;multi&#39;``, destriping is done using both offset and gain (mean and standard deviation or median and interquartile range).</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">destripecon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="n">Nprof</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.destripecub"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.destripecub">[docs]</a>   <span class="k">def</span> <span class="nf">destripecub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Ndeg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      To destripe a DataSet Object by a cubic curvilinear regression (chi squared)</span>

<span class="sd">      Parameters:</span>

<span class="sd">      :dataset: DataSet Object to be destriped</span>

<span class="sd">      :Nprof: number of profiles over which to compute the polynomial reference ; if set to 0 (default), compute the mean over the whole data</span>

<span class="sd">      :setmin: while fitting the polynomial curve, do not take into account data values lower than setmin</span>

<span class="sd">      :setmax: while fitting the polynomail curve, do not take into account data values greater than setmax</span>

<span class="sd">      :Ndeg: polynomial degree of the curve to fit</span>

<span class="sd">      :valfilt: If True, the dataset *values* are filtered instead of the dataset *z_image*.</span>

<span class="sd">      See Also</span>
<span class="sd">      --------</span>
<span class="sd">      destripecon, zeromeanprofile</span>
<span class="sd">      &#39;&#39;&#39;</span>

      <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">destripecub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="n">Nprof</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span> <span class="n">Ndeg</span><span class="o">=</span><span class="n">Ndeg</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

   <span class="k">def</span> <span class="nf">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Remove trend from dataset&#39;s profiles.</span>

<span class="sd">       Subtract a polynomial fit for each profile in the dataset and return the</span>
<span class="sd">       detrendend :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       order : int</span>
<span class="sd">           Degree for the fitting polynomial.</span>

<span class="sd">       setmin: float</span>
<span class="sd">           While computing the fit, do not take into account data values lower than *setmin*.</span>

<span class="sd">       setmax: float</span>
<span class="sd">           While computing the fit, do not take into account data values greater than *setmax*.</span>

<span class="sd">       valfilt : bool</span>
<span class="sd">           If set to True, the ungridded :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">           are filtered instead of the gridded :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">       See Also</span>
<span class="sd">       --------</span>
<span class="sd">       destripecon, zeromeanprofile, regtrend</span>
<span class="sd">       &#39;&#39;&#39;</span>

       <span class="c1">### TODO</span>
       <span class="c1">## Implement moving window detrending for multitrend on a profile</span>
       <span class="c1">## Implement jumpdiscontinuities detrending</span>
       <span class="c1">###</span>

       <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span>


<div class="viewcode-block" id="DataSet.regtrend"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.regtrend">[docs]</a>   <span class="k">def</span> <span class="nf">regtrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;relative&#39;</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      To filter a DataSet Object from its regional trend</span>

<span class="sd">      Parameters:</span>

<span class="sd">      :dataset: DataSet Object to be filtered</span>

<span class="sd">      :nx: filter size in x coordinate</span>

<span class="sd">      :ny: filter size in y coordinate</span>

<span class="sd">      :method: set to &quot;relative&quot; to filter by relative value (resistivity) or to &quot;absolute&quot; to filter by absolute value (magnetic field)</span>

<span class="sd">      :component: set to &quot;local&quot; to keep the local variations or to &quot;regional&quot; to keep regional variations</span>

<span class="sd">      :valfilt: if set to True, then filters data.values instead of data.zimage</span>

<span class="sd">      &#39;&#39;&#39;</span>
      <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">regtrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="n">component</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.wallisfilt"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.wallisfilt">[docs]</a>   <span class="k">def</span> <span class="nf">wallisfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">targmean</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span> <span class="n">targstdev</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">setgain</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                  <span class="n">limitstdev</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">edgefactor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Apply the Wallis contrast enhancement filter to the dataset.</span>

<span class="sd">      Returns the contrast-enhanced :func:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      nx : int</span>
<span class="sd">          filter window size in x-direction</span>

<span class="sd">      ny : int</span>
<span class="sd">          filter window size in y-direction</span>

<span class="sd">      targmean : float</span>
<span class="sd">          The target mean brigthness level (:math:`m_d`)</span>

<span class="sd">      targstdev : float</span>
<span class="sd">          The target standard deviation (:math:`\sigma_d`)</span>

<span class="sd">      setgain : float</span>
<span class="sd">          Amplification factor for contrast (:math:`A`)</span>

<span class="sd">      limitstdev : float</span>
<span class="sd">          Limitation on the window standard deviation to prevent too high gain value if data are dispersed</span>

<span class="sd">      edgefactor : float in the range of [0,1]</span>
<span class="sd">          Brightness forcing factor (:math:`\alpha`), controls ratio of edge to background intensities.</span>

<span class="sd">      valfilt : bool</span>
<span class="sd">          If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">          are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">      Notes</span>
<span class="sd">      -----</span>

<span class="sd">      The Wallis filter is a locally adaptative contrast enhancement filter</span>
<span class="sd">      based on the local statistical properties of sub-windows in the image.</span>
<span class="sd">      It adjusts brightness values (grayscale image) in the local window so that</span>
<span class="sd">      the local mean and standard deviation match target values.</span>

<span class="sd">      The Wallis operator is defined as [#]_:</span>

<span class="sd">      .. math::</span>
<span class="sd">         \frac{A \sigma_d}{A \sigma_{(x, y)} + \sigma_d} [f_{(x, y)} - m_{(x, y)}] + \alpha m_d + (1 - \alpha)m_{(x, y)}</span>

<span class="sd">      where: :math:`A` is the amplification factor for contrast;</span>
<span class="sd">      :math:`\sigma_d` is the target standard deviation;</span>
<span class="sd">      :math:`\sigma_{(x, y)}` is the standard deviation in the current window;</span>
<span class="sd">      :math:`f_{(x, y)}` is the center pixel of the current window;</span>
<span class="sd">      :math:`m_{(x, y)}` is the mean of the current window;</span>
<span class="sd">      :math:`\alpha` is the edge factor (controlling portion of the observed mean, and brightness locally to reduce or increase the total range) and</span>
<span class="sd">      :math:`m_d` is the target mean.</span>

<span class="sd">      As the Wallis filter is design for grayscale image, the data are</span>
<span class="sd">      internally converted to brightness level before applying the filter.</span>
<span class="sd">      The conversion is based on the minimum and maximum value in the dataset</span>
<span class="sd">      and uses 256 levels (from 0 to 255).</span>

<span class="sd">      References</span>
<span class="sd">      ----------</span>

<span class="sd">      .. [#] Scollar I., Tabbagh A., Hesse A. and Herzog I. 1990.</span>
<span class="sd">         Archaeological Prospecting and Remote Sensing (Topics in Remote Sensing 2).</span>
<span class="sd">         647p, chapter 4.5 p174.</span>
<span class="sd">         Cambridge University Press.</span>

<span class="sd">      Examples</span>
<span class="sd">      --------</span>
<span class="sd">      &gt;&gt;&gt; dataset.wallisfilt()</span>
<span class="sd">      &gt;&gt;&gt; dataset.wallisfilt(nx=21, ny=21, targmean=125, targstdev=50)</span>
<span class="sd">      &#39;&#39;&#39;</span>

      <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">wallisfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span> <span class="n">targmean</span><span class="o">=</span><span class="n">targmean</span><span class="p">,</span> <span class="n">targstdev</span><span class="o">=</span><span class="n">targstdev</span><span class="p">,</span> <span class="n">setgain</span><span class="o">=</span><span class="n">setgain</span><span class="p">,</span> <span class="n">limitstdev</span><span class="o">=</span><span class="n">limitstdev</span><span class="p">,</span> <span class="n">edgefactor</span><span class="o">=</span><span class="n">edgefactor</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.ploughfilt"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.ploughfilt">[docs]</a>   <span class="k">def</span> <span class="nf">ploughfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
      <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Apply a directionnal (&quot;anti-ploughing&quot;) filter to the dataset.</span>

<span class="sd">      Returns the filtered :meth:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>

<span class="sd">      apod : float</span>
<span class="sd">          Apodization factor in percent [0,1].</span>

<span class="sd">      azimuth : scalar</span>
<span class="sd">          Filter azimuth in degree.</span>

<span class="sd">      cutoff : scalar</span>
<span class="sd">          Cutoff spatial frequency (in number of sample).</span>

<span class="sd">      width : int</span>
<span class="sd">          Filter width parameter.</span>

<span class="sd">      valfilt : bool</span>
<span class="sd">          If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">          are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`.</span>

<span class="sd">      Notes</span>
<span class="sd">      -----</span>

<span class="sd">      The filter used is a combination of a classic gaussian low-pass filter of order 2 with a directional filter.</span>
<span class="sd">      This gaussian low-pass directional filter is defined as [#]_:</span>

<span class="sd">      .. math::</span>
<span class="sd">         \mathcal{F}(\rho, \theta, f_c) = e^{-(\rho / f_c)^2} \cdot ( 1-e^{-r^2 / \tan(\theta - \theta_0)^n} )</span>

<span class="sd">      where: :math:`\rho` and :math:`\theta` are the current point polar coordinates;</span>
<span class="sd">      :math:`f_c` is the gaussian low-pass filter cutoff frequency;</span>
<span class="sd">      :math:`\theta_0` is the directional filter&#39;s azimuth and</span>
<span class="sd">      :math:`n` is the parameter that controls the filter width.</span>

<span class="sd">      References</span>
<span class="sd">      ----------</span>

<span class="sd">      .. [#] Tabbagh J. 2001.</span>
<span class="sd">         Filtre directionel permettant d&#39;eliminer les anomalies crees par le labour,</span>
<span class="sd">         in &quot;Filtering, Optimisation and Modelling of Geophysical Data in Archaeological Prospecting&quot;,</span>
<span class="sd">         Fondazione Ing. Carlo Maurillo Lerici, Politecnico di Milano, M. Cucarzi and P. Conti (eds.),</span>
<span class="sd">         Roma 2001, 202p, p161-166.</span>

<span class="sd">      Examples</span>
<span class="sd">      --------</span>
<span class="sd">      &gt;&gt;&gt; dataset.ploughfilt()</span>
<span class="sd">      &gt;&gt;&gt; dataset.ploughfilt(apod=0, azimuth=30, cutoff=100, width=2)</span>
<span class="sd">      &gt;&gt;&gt; dataset.ploughfilt(azimuth=45, cutoff=None)</span>

<span class="sd">      &#39;&#39;&#39;</span>

      <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">ploughfilt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

   <span class="c1">#---------------------------------------------------------------------------#</span>
   <span class="c1"># DataSet Magnetism Processing                                              #</span>
   <span class="c1">#---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="DataSet.logtransform"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.logtransform">[docs]</a>   <span class="k">def</span> <span class="nf">logtransform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multfactor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">       Apply a logarihtmic transformation to the dataset.</span>

<span class="sd">       The logarihtmic transformation is a contrast enhancement filter that</span>
<span class="sd">       enhances information at low-amplitude values while preserving the</span>
<span class="sd">       relative amplitude information.</span>

<span class="sd">       Returns the transformed :meth:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       multfactor : float</span>
<span class="sd">           Multiplying factor to apply to the data to increase/decrease the number of data that falls into the condition ]-1,1[.</span>

<span class="sd">       setnan : bool,</span>
<span class="sd">          If True, the data value between ]-1,1[ will be replaced by nans.</span>
<span class="sd">          If False, they will be replaced by zero.</span>

<span class="sd">       valfilt : bool,</span>
<span class="sd">          If True, then filters :attr:`~geophpy.dataset.Data.values` instead of :attr:`~geophpy.dataset.Data.data.z_image`</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>

<span class="sd">       The logarihtmic transformation is defined as [#]_:</span>

<span class="sd">       .. math::</span>
<span class="sd">          \mathcal{F}\{f\} =</span>
<span class="sd">             \left\{</span>
<span class="sd">             \begin{array}{ccc}</span>
<span class="sd">                -\log_{10} (-f) &amp; for &amp; f &lt;-1 \\</span>
<span class="sd">                 \log_{10} (f) &amp; for &amp; f &gt;1 \\</span>
<span class="sd">                     0         &amp; for &amp; -1&lt; f &gt;1 \\</span>
<span class="sd">             \end{array}</span>
<span class="sd">             \right.</span>

<span class="sd">       where: :math:`f` is the original data.</span>

<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">       .. [#] Morris B., Pozza M., Boyce J. and Leblanc G. 2001.</span>
<span class="sd">          Enhancement of magnetic data by logarithmic transformation.</span>
<span class="sd">          The Leading Edge, vol. 20, no. 8, p882-885.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">logtransform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">multfactor</span><span class="o">=</span><span class="n">multfactor</span><span class="p">,</span> <span class="n">setnan</span><span class="o">=</span><span class="n">setnan</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.polereduction"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.polereduction">[docs]</a>   <span class="k">def</span> <span class="nf">polereduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inclination</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">declination</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">magazimuth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">incl_magn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">decl_magn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Reduction to the pole.</span>

<span class="sd">       The reduction to the pole is a phase transformation in the spectral domain</span>
<span class="sd">       applied to the **total magnetic field** to computes the</span>
<span class="sd">       &quot;anomaly that would be measured at the north magnetic pole,</span>
<span class="sd">       where induced magnetization and ambient field both would be directed</span>
<span class="sd">       vertically down.&quot; [#]_</span>

<span class="sd">       Returns the transformed :meth:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>

<span class="sd">       apod : float</span>
<span class="sd">           Apodization factor, to limit Gibbs phenomenon at jump discontinuities.</span>

<span class="sd">       inclination : float</span>
<span class="sd">           Ambient magnetic field inclination (:math:`I`) in degrees</span>
<span class="sd">           positive below horizontal.</span>

<span class="sd">       declination : float</span>
<span class="sd">           Ambient magnetic field declination (:math:`D`) in degrees</span>
<span class="sd">           positive east of geographic (true) north.</span>

<span class="sd">       azimuth : float</span>
<span class="sd">           Azimuth of the survey **x-axis** in degrees positive east of north</span>
<span class="sd">           (:math:`\theta`, the angle between the survey profile direction and the geographic north).</span>
<span class="sd">           The `magnetic azimuth` (:math:`\phi`) is computed from the ``declination`` (:math:`D`)</span>
<span class="sd">           and the azimuth as :math:`\phi= D - \theta`.</span>

<span class="sd">       magazimuth :  float</span>
<span class="sd">           `Magnetic azimuth` survey **x-axis** in degrees positive east of north</span>
<span class="sd">           (:math:`\phi`, the angle between the survey profile direction and the magnetic north).</span>
<span class="sd">           ``None`` by default. If a value is given, the ``declination`` is ignored and the magnetic azimuth will derectly be used.</span>

<span class="sd">       incl_magn, decl_magn : float, optional</span>
<span class="sd">           The source remanent magnetization inclination and declination in degrees.</span>
<span class="sd">           By default they are set to ``None``, the remanent magnetization is neglected.</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>

<span class="sd">       If the magnetization and ambient field are not vertical, a uniform</span>
<span class="sd">       magnetic source will produce a skewed anomaly.</span>
<span class="sd">       The reduction to the pole aims to eliminate this effect by transforming</span>
<span class="sd">       the &quot;measured **total field** anomaly into the vertical component of the</span>
<span class="sd">       field caused by the same source distribution magnetized in the vertical direction&quot;.</span>

<span class="sd">       This transformation is given in the spectral domain by:</span>

<span class="sd">       .. math::</span>
<span class="sd">          \mathcal{F}_{RTP} = \mathcal{F}_{TF} \cdot \mathcal{F}</span>

<span class="sd">       where :math:`\mathcal{F}_{TF}` is the Fourier Transform of measured `total field` anomaly and :math:`\mathcal{F}` is defined as:</span>

<span class="sd">       .. math::</span>
<span class="sd">          \mathcal{F}_{m,f}\{k_x, k_x\} = \frac{|k|^2}{</span>
<span class="sd">              a_1 k_x^2</span>
<span class="sd">              + a_2 k_y^2</span>
<span class="sd">              + a_3 k_x k_y</span>
<span class="sd">              + i |k| (b1 k_x + b2 k_y)}, |k| \ne 0</span>

<span class="sd">       with</span>

<span class="sd">       .. math::</span>
<span class="sd">          a_1 &amp;= m_z f_z - m_x f_x, \\</span>
<span class="sd">          a_2 &amp;= m_z f_z - m_y f_y, \\</span>
<span class="sd">          a_3 &amp;= -m_y f_x - m_x f_y, \\</span>
<span class="sd">          b_1 &amp;= m_x f_z + m_z f_x, \\</span>
<span class="sd">          b_2 &amp;= m_y f_z + m_z f_y, \\</span>

<span class="sd">       where :math:`m=(m_x, m_y, m_z)` is the unit-vector in the direction of the magnetization of the source;</span>
<span class="sd">       :math:`f = (f_x, f_y, f_z)` is the unit-vector in the direction of the ambiant field;</span>
<span class="sd">       :math:`|k| = \sqrt{k_x^2 + k_y^2}` is the radial wavenumber and</span>
<span class="sd">       :math:`k_x` and :math:`k_y` are the wavenumber in the x and y-diection respectively.</span>


<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">       .. [#] Blakely R. J. 1996.</span>
<span class="sd">          Potential Theory in Gravity and Magnetic Applications.</span>
<span class="sd">          Chapter 12.3.1, p330.</span>
<span class="sd">          Cambridge University Press.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">polereduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span> <span class="n">inclination</span><span class="o">=</span><span class="n">inclination</span><span class="p">,</span> <span class="n">declination</span><span class="o">=</span><span class="n">declination</span><span class="p">,</span>
                                          <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">magazimuth</span><span class="o">=</span><span class="n">magazimuth</span><span class="p">,</span>
                                          <span class="n">incl_magn</span><span class="o">=</span><span class="n">incl_magn</span><span class="p">,</span> <span class="n">decl_magn</span><span class="o">=</span><span class="n">decl_magn</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.continuation"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.continuation">[docs]</a>   <span class="k">def</span> <span class="nf">continuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">continuationflag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">totalfieldconversionflag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Upward or downwad continuation of the magnetic field.</span>

<span class="sd">       The continuation computes the data that would be measured at an upper</span>
<span class="sd">       (`upward continuation`) or lower survey altitude</span>
<span class="sd">       (`downward continuation`). The computation is done in the spectral</span>
<span class="sd">       (frequency) domain using Fast Fourier Transform.</span>

<span class="sd">       Returns the continued :meth:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       apod : float</span>
<span class="sd">           Apodization factor (in %), to limit Gibbs phenomenon at jump discontinuities.</span>

<span class="sd">       distance : float</span>
<span class="sd">           Continuation distance. Positive for an `upward continuation` (above ground level, away from the source) and</span>
<span class="sd">           negative for a `downward continuation` (under ground level, toward the source).</span>

<span class="sd">       totalfieldconversionflag: bool,</span>
<span class="sd">           If True, the data are considered as gradient data (Total-field gradient or Fluxgate)</span>
<span class="sd">           and will be converted to total-field data after the continuation using the provided separation.</span>

<span class="sd">       separation :folat</span>
<span class="sd">           Sensor separation for the conversion to Total-field data.</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>

<span class="sd">       Assuming that all the magnetic sources are located below the observation surface,</span>
<span class="sd">       the continuation at a new observation altitude :math:`z` of a survey</span>
<span class="sd">       acquired at an original altitude :math:`z_0` is given in the spectral</span>
<span class="sd">       domain by [#]_:</span>

<span class="sd">       .. math::</span>

<span class="sd">          \mathcal{F}_{\Delta z,k} = \mathcal{F}_{TF} \cdot e^{-\Delta z |k|}</span>

<span class="sd">       where :math:`\mathcal{F}_{TF}` is the Fourier Transform of the measured data at the original altitude of observation :math:`z_0`;</span>
<span class="sd">       :math:`\mathcal{F}_{\Delta z,k}` is the Fourier Transform of the anomaly at the new altitude of observation :math:`z = z_0 - \Delta z`;</span>
<span class="sd">       :math:`\Delta z = z_0 - z` is the altitude increase between the original and new altitude of observation and</span>
<span class="sd">       :math:`|k| = \sqrt{k_x^2 + k_y^2}` is the radial wavenumber where :math:`k_x` and :math:`k_y` are the wavenumber in the x and y-direction respectively.</span>

<span class="sd">       The given  altitude increase (:math:`\Delta z`) is an algebraic value:</span>

<span class="sd">       * If :math:`\Delta z&gt;0`, the new altitude of observation is above the original altitude: the operation is an `upward continuation`;</span>
<span class="sd">       * if :math:`\Delta z&lt;0`, the new altitude of observation is below the original altitude: the operation is a `downward continuation`.</span>

<span class="sd">       The `upward continuation` attenuates anomalies with respect to the wavelength in way that accentuates anomalies caused by deep sources and  attenuates at the anomalies caused by shallow sources.</span>
<span class="sd">       It is hence a smoothing operator.</span>

<span class="sd">       The `downward continuation` accentuates the shallowest components. It reduces spread of anomalies and corrects anomalies coalescences.</span>
<span class="sd">       It is usefull to discriminates the number of body source at the origin of a one big anomaly.</span>
<span class="sd">       It is an unsmoothing operator that is instable as small changes in the data can cause large and unrealistic variations so it is to be used with caution.</span>
<span class="sd">       Low-pass filtering before the `downward continuation` can be a solution to increase the filter stability.</span>

<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">       .. [#] Blakely R. J. 1996.</span>
<span class="sd">          Potential Theory in Gravity and Magnetic Applications.</span>
<span class="sd">          Chapter 12.1, p313-320.</span>
<span class="sd">          Cambridge University Press.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">continuation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span> <span class="n">totalfieldconversionflag</span><span class="o">=</span><span class="n">totalfieldconversionflag</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="n">separation</span><span class="p">)</span></div>

   <span class="k">def</span> <span class="nf">eulerdeconvolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">structind</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xstep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ystep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Classic Euler deconvolution.</span>

<span class="sd">       Euler deconvolution is a method to estimate magnetic sources depth based on Euler&#39;s homogeneity relation.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       apod : float</span>
<span class="sd">           Apodization factor, to limit Gibbs phenomenon at jump discontinuities.</span>

<span class="sd">       structind : int {1, 2, 3, None}</span>
<span class="sd">           The Structural Index to used for the Euler deconvolution.</span>
<span class="sd">           If None, it will be estimated by Least-square regression simultenaously</span>
<span class="sd">           with the source position and depth for each dataset sub-window.</span>

<span class="sd">       windows : list or None</span>
<span class="sd">           The list containing the satial extent of each sub-window to be considered</span>
<span class="sd">           for the deconvolution:</span>
<span class="sd">           [[xmin1, xmax1, ymin1, ymax1],...,[xmink, xmaxk, ymink, ymaxk]].</span>
<span class="sd">           If None, a 2-D sliding window od size *xstep x ystep* will be created</span>
<span class="sd">           and used for the deconvolution.</span>

<span class="sd">       xstep : int</span>
<span class="sd">           Size, in number of sample, of the sub-windows in the x-direction.</span>
<span class="sd">           Used only if windows is None.</span>
<span class="sd">           If Only xstep is specified, a square window is used.</span>

<span class="sd">       ystep : int</span>
<span class="sd">           Size, in number of sample, of the sub-windows in the y-direction.</span>
<span class="sd">           Used only if windows is None.</span>
<span class="sd">           If Only ystep is specified, a square window is used.</span>

<span class="sd">       Returns</span>
<span class="sd">       -------</span>
<span class="sd">       out : list</span>
<span class="sd">           The list containing for each sub-window,</span>
<span class="sd">           the estimated source x and y position and</span>
<span class="sd">           depth, the structural index , the corresponding residuals</span>
<span class="sd">           and the correspondig sub-window spatial extend.</span>

<span class="sd">       Note</span>
<span class="sd">       ----</span>
<span class="sd">       [#]_</span>

<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">        .. [#] Reid A. B., Allsop J. M., Granser H., Millett A. J. and Somerton I. W. 1990.</span>
<span class="sd">           Magnetic interpretation in three dimensions using Euler deconvolution.</span>
<span class="sd">           Geophysics, vol. 55, no. 1, p80-91.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">eulerdeconvolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span> <span class="n">structind</span><span class="o">=</span><span class="n">structind</span><span class="p">,</span> <span class="n">windows</span><span class="o">=</span><span class="n">windows</span><span class="p">,</span> <span class="n">xstep</span><span class="o">=</span><span class="n">xstep</span><span class="p">,</span> <span class="n">ystep</span><span class="o">=</span><span class="n">ystep</span><span class="p">)</span>

<div class="viewcode-block" id="DataSet.analyticsignal"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.analyticsignal">[docs]</a>   <span class="k">def</span> <span class="nf">analyticsignal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Conversion from potential field to *analytic signal*.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       apod : float</span>
<span class="sd">           Apodization factor, to limit Gibbs phenomenon at jump discontinuities.</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>
<span class="sd">       The amplitude of the *analytical signal* (or the *amplitude of the total gradient*)</span>
<span class="sd">       of a potential field :math:`T` is defined as [#]_:</span>

<span class="sd">       .. math::</span>

<span class="sd">          |A(x, y, z)| = \sqrt{ \left( \frac{\partial T}{\partial x} \right)^2</span>
<span class="sd">                    + \left( \frac{\partial T}{\partial y} \right)^2</span>
<span class="sd">                    + \left( \frac{\partial T}{\partial z} \right)^2 }</span>

<span class="sd">       The directional derivative are computed in the spectral domain using [#]_:</span>

<span class="sd">       .. math::</span>

<span class="sd">          \mathcal{F} \left[ \frac{\partial^2 T}{\partial x^2} \right] = (ik_x)^2 \mathcal{F} \left[ T \right],</span>
<span class="sd">          \mathcal{F} \left[ \frac{\partial^2 T}{\partial y^2} \right] = (ik_y)^2 \mathcal{F} \left[ T \right],</span>
<span class="sd">          \mathcal{F} \left[ \frac{\partial^2 T}{\partial z^2} \right] = |k|^2 \mathcal{F} \left[ T \right].</span>

<span class="sd">       and transformed back in the spatial domain for the total gradient amplitude calculation.</span>

<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">       .. [#] Blakely R. J. 1996.</span>
<span class="sd">          Potential Theory in Gravity and Magnetic Applications.</span>
<span class="sd">          Chapter 12.1, p313-320.</span>
<span class="sd">          Cambridge University Press.</span>

<span class="sd">       .. [#] Roest Walter R. , Verhoef Jacob and Pilkington Mark 1992.</span>
<span class="sd">          Magnetic interpretation using the 3-D analytic signal.</span>
<span class="sd">          Geophysics, vol. 57, no. 1, p116-125.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">analyticsignal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataSet.magconfigconversion"><a class="viewcode-back" href="../../api.html#geophpy.dataset.DataSet.magconfigconversion">[docs]</a>   <span class="k">def</span> <span class="nf">magconfigconversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromconfig</span><span class="p">,</span> <span class="n">toconfig</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                           <span class="n">FromBottomSensorAlt</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">FromTopSensorAlt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ToBottomSensorAlt</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ToTopSensorAlt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                           <span class="n">inclination</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">declination</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">magazimuth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Conversion between the different magnetic survey sensor&#39;s configurations.</span>

<span class="sd">       Returns the transformed :meth:`~geophpy.dataset.DataSet` object.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       fromconfig : str {&quot;TotalField&quot;|&quot;TotalFieldGradient&quot;|&quot;Fluxgate&quot;}, from sensorconfig_getlist()</span>
<span class="sd">           Initial sensor&#39;s configuration from which to convert de data.</span>

<span class="sd">       toconfig : str {&quot;TotalField&quot;|&quot;TotalFieldGradient&quot;|&quot;Fluxgate&quot;}, from sensorconfig_getlist()</span>
<span class="sd">           Final sensor&#39;s configuration to which to convert de data.</span>

<span class="sd">       apod : float</span>
<span class="sd">           Apodization factor, to limit Gibbs phenomenon at jump discontinuities.</span>

<span class="sd">       FromBottomSensorAlt : float</span>
<span class="sd">          Bottom sensor altidue of the initial sensor&#39;s configuration.</span>

<span class="sd">       FromTopSensorAlt : float</span>
<span class="sd">          Top sensor altidue of the initial sensor&#39;s configuration.</span>

<span class="sd">       ToBottomSensorAlt : float</span>
<span class="sd">          Bottom sensor altidue of the final sensor&#39;s configuration.</span>

<span class="sd">       ToTopSensorAlt : float</span>
<span class="sd">          Top sensor altidue of the final sensor&#39;s configuration.</span>

<span class="sd">       inclination : float</span>
<span class="sd">           Ambient magnetic field inclination (:math:`I`) in degrees</span>
<span class="sd">           positive below horizontal.</span>

<span class="sd">       declination : float</span>
<span class="sd">           Ambient magnetic field declination (:math:`D`) in degrees</span>
<span class="sd">           positive east of geographic (true) north.</span>

<span class="sd">       azimuth : float</span>
<span class="sd">           Azimuth of the survey **x-axis** in degrees positive east of north</span>
<span class="sd">           (:math:`\theta`, the angle between the survey profile direction and the geographic north).</span>
<span class="sd">           The `magnetic azimuth` (:math:`\phi`) is computed from the ``declination`` (:math:`D`)</span>
<span class="sd">           and the azimuth as :math:`\phi= D - \theta`.</span>

<span class="sd">       magazimuth :  float</span>
<span class="sd">           `Magnetic azimuth` survey **x-axis** in degrees positive east of north</span>
<span class="sd">           (:math:`\phi`, the angle between the survey profile direction and the magnetic north).</span>
<span class="sd">           ``None`` by default. If a value is given, the ``declination`` is ignored and the magnetic azimuth will derectly be used.</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>
<span class="sd">       as [#]_:</span>

<span class="sd">       References</span>
<span class="sd">       ----------</span>

<span class="sd">       .. [#] Tabbagh A., Desvignes G. and Dabas M. 1997.</span>
<span class="sd">          Processing of Z Gradiometer Magnetic data using Linear Transforms and Analytical Signal.</span>
<span class="sd">          Archaelogical Prospection, vol. 4, issue 1, p1-13.</span>

<span class="sd">       &#39;&#39;&#39;</span>

       <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">magconfigconversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fromconfig</span><span class="p">,</span> <span class="n">toconfig</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span>
                                                <span class="n">FromBottomSensorAlt</span><span class="o">=</span><span class="n">FromBottomSensorAlt</span><span class="p">,</span> <span class="n">FromTopSensorAlt</span><span class="o">=</span><span class="n">FromTopSensorAlt</span><span class="p">,</span>
                                                <span class="n">ToBottomSensorAlt</span><span class="o">=</span><span class="n">ToBottomSensorAlt</span><span class="p">,</span> <span class="n">ToTopSensorAlt</span><span class="o">=</span><span class="n">ToTopSensorAlt</span><span class="p">,</span>
                                                <span class="n">inclination</span><span class="o">=</span><span class="n">inclination</span><span class="p">,</span> <span class="n">declination</span><span class="o">=</span><span class="n">declination</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">magazimuth</span><span class="o">=</span><span class="n">magazimuth</span><span class="p">)</span></div>

   <span class="k">def</span> <span class="nf">susceptibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prosptech</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">downsensoraltitude</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">upsensoraltitude</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">calculationdepth</span><span class="o">=</span><span class="mf">.0</span><span class="p">,</span> <span class="n">stratumthickness</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inclineangle</span> <span class="o">=</span> <span class="mi">65</span><span class="p">,</span> <span class="n">alphaangle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
      <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Calcultation of an equivalent stratum of magnetic susceptibility</span>

<span class="sd">      Parameters :</span>

<span class="sd">      :prosptech: Prospection technical</span>

<span class="sd">      :apod: apodization factor, to limit side effects</span>

<span class="sd">      :downsensoraltitude: Altitude of the down magnetic sensor</span>

<span class="sd">      :upsensoraltitude: Altitude of the upper magnetic sensor</span>

<span class="sd">      :calculationdepth: Depth(m) to do the calculation</span>

<span class="sd">      :stratumthickness: Thickness of the equivalent stratim</span>

<span class="sd">      :inclineangle: magnetic field incline</span>

<span class="sd">      :alphaangle: magnetic field alpha angle</span>
<span class="sd">      &#39;&#39;&#39;</span>
      <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">susceptibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prosptech</span><span class="p">,</span> <span class="n">apod</span><span class="p">,</span> <span class="n">downsensoraltitude</span><span class="p">,</span> <span class="n">upsensoraltitude</span><span class="p">,</span> <span class="n">calculationdepth</span><span class="p">,</span> <span class="n">stratumthickness</span><span class="p">,</span> <span class="n">inclineangle</span><span class="p">,</span> <span class="n">alphaangle</span><span class="p">)</span></div>


<span class="c1">#===========================================================================#</span>


<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="c1"># General DataSet Environment functions                                     #</span>
<span class="c1">#---------------------------------------------------------------------------#</span>
<span class="n">format_chooser</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;.dat&quot;</span> <span class="p">:</span> <span class="s2">&quot;ascii&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.txt&quot;</span> <span class="p">:</span> <span class="s2">&quot;ascii&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.xyz&quot;</span> <span class="p">:</span> <span class="s2">&quot;ascii&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.csv&quot;</span> <span class="p">:</span> <span class="s2">&quot;ascii&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.uxo&quot;</span> <span class="p">:</span> <span class="s2">&quot;uxo&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.nc&quot;</span>  <span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.cdf&quot;</span> <span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.pga&quot;</span> <span class="p">:</span> <span class="s2">&quot;wumap&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.grd&quot;</span> <span class="p">:</span> <span class="s2">&quot;surfer&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.mat&quot;</span> <span class="p">:</span> <span class="s2">&quot;matrix&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.app&quot;</span> <span class="p">:</span> <span class="s2">&quot;profile&quot;</span><span class="p">,</span>
   <span class="s2">&quot;.rt&quot;</span>  <span class="p">:</span> <span class="s2">&quot;electric&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_file_format</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Return the file format from file extension.</span>

<span class="sd">    Return the file formats from :meth:`~geophpy.dataset.fileformat_getlist`</span>
<span class="sd">    if recognized.</span>
<span class="sd">    Return ``None`` otherwise.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="c1"># Recognized extension</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">format_chooser</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">format_chooser</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>

    <span class="c1"># Unrecognized extension</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="k">return</span> <span class="kc">None</span>


<div class="viewcode-block" id="getlinesfrom_file"><a class="viewcode-back" href="../../api.html#geophpy.dataset.getlinesfrom_file">[docs]</a><span class="k">def</span> <span class="nf">getlinesfrom_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">fileformat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skiprowsnb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rowsnb</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Reads lines in a file.</span>

<span class="sd">   Parameters :</span>

<span class="sd">   :fileformat: file format</span>

<span class="sd">   :filename: file name with extension to read, &quot;test.dat&quot; for example.</span>

<span class="sd">   :delimiter: delimiter between fields, tabulation by default.</span>

<span class="sd">   :skipinitialspace: if True, considers severals delimiters as only one : &quot;\t\t&quot; as &#39;\t&#39;.</span>

<span class="sd">   :skiprowsnb: number of rows to skip to get lines.</span>

<span class="sd">   :rowsnb: number of the rows to read, 1 by default.</span>

<span class="sd">   Returns:</span>

<span class="sd">   :colsnb: number of columns in all rows, 0 if rows have different number of columns</span>

<span class="sd">   :rows: rows.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="c1"># Dispatch method ##############################################</span>
   <span class="k">class</span> <span class="nc">From</span><span class="p">():</span>
      <span class="nd">@staticmethod</span>
      <span class="k">def</span> <span class="nf">ascii</span><span class="p">():</span>
         <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">getlinesfrom_ascii</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">,</span> <span class="n">skiprowsnb</span><span class="p">,</span> <span class="n">rowsnb</span><span class="p">)</span>
      <span class="nd">@staticmethod</span>
      <span class="k">def</span> <span class="nf">netcdf</span><span class="p">():</span>
         <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">getlinesfrom_netcdf</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

   <span class="c1"># Choose the input file format #################################</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">fileformat</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
      <span class="c1"># ...TBD... Determine the format from file header</span>
      <span class="k">pass</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">fileformat</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
      <span class="c1"># Determine the format from filename extension</span>
      <span class="n">file_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filenameslist</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">fileformat</span> <span class="o">=</span> <span class="n">format_chooser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">file_extension</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="c1">###</span>
      <span class="c1">#...TBD... raise an error if fileformat is unrecognized</span>
      <span class="c1">###</span>

   <span class="c1"># Read the dataset from input file #############################</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">fileformat</span> <span class="ow">in</span> <span class="n">fileformat_getlist</span><span class="p">()):</span>
      <span class="n">readfile</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">From</span><span class="p">,</span> <span class="n">fileformat</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">readfile</span><span class="p">()</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Undefined file format #####################################</span>
      <span class="c1"># ...TBD... raise an error here !</span>
      <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="fileformat_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.fileformat_getlist">[docs]</a><span class="k">def</span> <span class="nf">fileformat_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of format files availables</span>

<span class="sd">   Returns: list of file formats availables, [&#39;ascii&#39;, ...]</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">fileformat_getlist</span><span class="p">()</span></div>


<div class="viewcode-block" id="pictureformat_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.pictureformat_getlist">[docs]</a><span class="k">def</span> <span class="nf">pictureformat_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of pictures format availables</span>

<span class="sd">   Returns: list of picture formats availables, [&#39;jpg&#39;, &#39;png&#39;, ...]</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">getpictureformatlist</span><span class="p">()</span></div>


<div class="viewcode-block" id="rasterformat_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.rasterformat_getlist">[docs]</a><span class="k">def</span> <span class="nf">rasterformat_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of raster format files availables</span>

<span class="sd">   Returns : list of raster file formats availables, [&#39;jpg&#39;, &#39;png&#39;, ...]</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">raster</span><span class="o">.</span><span class="n">getrasterformatlist</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">gridtype_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39; Return the list of the available GRD grid format [&#39;surf7bin&#39;, &#39;surf6bin&#39;, ...].&#39;&#39;&#39;</span>

   <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">gridfiletype_getlist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">gridformat_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39; Return the list of the available GRD grid format [&#39;Surfer 7 binary grid&#39;, &#39;Surfer 6 binary grid&#39;, ...].&#39;&#39;&#39;</span>

   <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">gridfileformat_getlist</span><span class="p">()</span>


<div class="viewcode-block" id="plottype_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.plottype_getlist">[docs]</a><span class="k">def</span> <span class="nf">plottype_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of plot type availables</span>

<span class="sd">   Returns : list of plot type availables, [&#39;2D_SURFACE&#39;, &#39;2D_CONTOUR&#39;, ...]</span>
<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">gettypelist</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">spectrum_plottype_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;Get list of available spectrum plot type.&#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">spectral</span><span class="o">.</span><span class="n">getspectrum_plottype_list</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">rotation_angle_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of the available angles of rotation for the z_image.</span>
<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_rotation_angle_list</span><span class="p">()</span>


<div class="viewcode-block" id="festooncorrelation_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.festooncorrelation_getlist">[docs]</a><span class="k">def</span> <span class="nf">festooncorrelation_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available festoon correlation methods.</span>
<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getfestooncorrelationlist</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">destriping_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available destriping methods.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getdestripinglist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">destripingreference_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available destriping reference calculation methods.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getdestripingreferencelist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">destripingconfig_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available destriping configuration.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getdestripingconfiglist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">regtrendmethod_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available destriping methods.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getregtrendmethodlist</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">regtrendcomp_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available destriping methods.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">getregtrendcomplist</span><span class="p">()</span>


<div class="viewcode-block" id="griddinginterpolation_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.griddinginterpolation_getlist">[docs]</a><span class="k">def</span> <span class="nf">griddinginterpolation_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get the list of available gridding interpolation methods.</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">getgriddinginterpolationlist</span><span class="p">()</span></div>


<div class="viewcode-block" id="interpolation_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.interpolation_getlist">[docs]</a><span class="k">def</span> <span class="nf">interpolation_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Get list of interpolation methods availables</span>

<span class="sd">   Returns : list of interpolation methods availables, [&#39;bilinear&#39;, &#39;bicubic&#39;, ...]</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">getinterpolationlist</span><span class="p">()</span></div>


<div class="viewcode-block" id="sensorconfig_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.sensorconfig_getlist">[docs]</a><span class="k">def</span> <span class="nf">sensorconfig_getlist</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39; Returns the list of available magnetic sensor configurations. &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">getsensorconfiglist</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">structuralindex_getlist</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39; Returns the list of available structural index for Euler deconvolution. &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">magproc</span><span class="o">.</span><span class="n">getstructuralindexlist</span><span class="p">()</span>

<span class="c1">##def prosptech_getlist():</span>
<span class="c1">##   &#39;&#39;&#39;</span>
<span class="c1">##   Get list of prospection technicals availables</span>
<span class="c1">##</span>
<span class="c1">##   Returns : list of prospection technicals</span>
<span class="c1">##</span>
<span class="c1">##   &#39;&#39;&#39;</span>
<span class="c1">##   return magproc.getprosptechlist()</span>


<div class="viewcode-block" id="colormap_getlist"><a class="viewcode-back" href="../../api.html#geophpy.dataset.colormap_getlist">[docs]</a><span class="k">def</span> <span class="nf">colormap_getlist</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
   <span class="sd">&#39;&#39;&#39; Get the list of available colormaps.</span>

<span class="sd">   If sort is True, colormaps are sorted alphabetically ingoring the case.&#39;&#39;&#39;</span>

   <span class="k">return</span> <span class="n">colormap</span><span class="o">.</span><span class="n">getlist</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="n">sort</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">colormap_icon_getpath</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Getting the colormap icons path.</span>

<span class="sd">   Returns : path of availables colormap icon &#39;**\plotting\colormapicons&#39;</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">colormap</span><span class="o">.</span><span class="n">get_icon_path</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">colormap_icon_getlist</span><span class="p">():</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Getting the colormap icons list.</span>

<span class="sd">   Returns : list of availables colormap icon, [&#39;gray_colormap_icon.jpg&#39;, ...]</span>

<span class="sd">   &#39;&#39;&#39;</span>
   <span class="k">return</span> <span class="n">colormap</span><span class="o">.</span><span class="n">get_icon_list</span><span class="p">()</span>


<div class="viewcode-block" id="colormap_plot"><a class="viewcode-back" href="../../api.html#geophpy.dataset.colormap_plot">[docs]</a><span class="k">def</span> <span class="nf">colormap_plot</span><span class="p">(</span><span class="n">cmname</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   Plots the colormap.</span>

<span class="sd">   Parameters :</span>

<span class="sd">   :cmname: Name of the colormap, &#39;gray_r&#39; for example.</span>

<span class="sd">   :creversed: True to add &#39;_r&#39; at the cmname to reverse the color map</span>

<span class="sd">   :fig: figure to plot, None by default to create a new figure.</span>

<span class="sd">   :filename: Name of the color map file to save, None if no file to save.</span>

<span class="sd">   :dpi: &#39;dot per inch&#39; definition of the picture file if filename != None</span>

<span class="sd">   :transparent: True to manage the transparency.</span>

<span class="sd">   Returns:</span>

<span class="sd">   :fig: Figure Object</span>

<span class="sd">   &#39;&#39;&#39;</span>

   <span class="k">return</span> <span class="n">colormap</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmname</span><span class="p">,</span> <span class="n">creversed</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">colormap_make_icon</span><span class="p">(</span><span class="n">cmname</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
   <span class="sd">&#39;&#39;&#39; Make an png icon of the given colormap name.</span>

<span class="sd">   Parameters</span>
<span class="sd">   ----------</span>
<span class="sd">   cmname : str</span>
<span class="sd">        Name of the colormap, &#39;gray_r&#39; for example.</span>

<span class="sd">   path : str</span>
<span class="sd">        Path where to write the icon.</span>

<span class="sd">   creversed : bool</span>
<span class="sd">       True to add &#39;_r&#39; at the cmname to reverse the color map</span>

<span class="sd">   dpi : float</span>
<span class="sd">       &#39;dot per inch&#39; definition of the icon</span>

<span class="sd">   &#39;&#39;&#39;</span>

   <span class="k">return</span> <span class="n">colormap</span><span class="o">.</span><span class="n">make_icon</span><span class="p">(</span><span class="n">cmname</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="n">creversed</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>


<div class="viewcode-block" id="correlmap"><a class="viewcode-back" href="../../api.html#geophpy.dataset.correlmap">[docs]</a><span class="k">def</span> <span class="nf">correlmap</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Crosscor&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Profile-to-profile correlation map.</span>

<span class="sd">    Profile-to-profile correlation map:</span>
<span class="sd">       * each odd profile in the dataset is incrementally shifted and the correlation coefficient computed against neighbouring profiles for each shift value</span>
<span class="sd">       * profiles are considered to be vertical, and the shift performed along the profile (hence vertically)</span>
<span class="sd">       * the correlation map size is then &quot;twice the image vertical size&quot; (shift may vary from -ymax to +ymax) by &quot;number of profiles&quot; (correlation is computed for each column listed in input)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    method : str, {&#39;Crosscor&#39;, &#39;Pearson&#39;, &#39;Spearman&#39;, &#39;Kendall&#39;}</span>
<span class="sd">        Correlation method use.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    cormap : 2-D array_like</span>
<span class="sd">        Profile-to-profile correlation map.</span>

<span class="sd">    pva1 : 2-D array_like</span>
<span class="sd">        Correlation weight map.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">correlmap</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">correlshift</span><span class="p">(</span><span class="n">correlmap</span><span class="p">,</span> <span class="n">pva1</span><span class="p">,</span> <span class="n">corrmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Maximum correlation shift.</span>

<span class="sd">    Compute the &quot;best&quot; shift to re-align/destagger dataset profiles.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    correlmap : 2-D array_like</span>
<span class="sd">        Dataset correlation map.</span>

<span class="sd">    pva1 : 2-D array_like</span>
<span class="sd">        Dataset Correlation weight map.</span>

<span class="sd">    corrmin : float</span>
<span class="sd">        Minimum correlation value for profile shifting [0-1].</span>

<span class="sd">    apod : float</span>
<span class="sd">        Apodization threshold (in percent of the max correl coef)</span>

<span class="sd">    :output: correlation profile computed as a weighted mean across the correlation map ; the best shift value is found at this profile&#39;s maximum</span>

<span class="sd">    Returns:</span>

<span class="sd">    :shift: number of pixels to shift along the profile</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">correlshift</span><span class="p">(</span><span class="n">correlmap</span><span class="p">,</span> <span class="n">pva1</span><span class="p">,</span> <span class="n">corrmin</span><span class="o">=</span><span class="n">corrmin</span><span class="p">,</span> <span class="n">apod</span><span class="o">=</span><span class="n">apod</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>

<span class="c1">###</span>
<span class="c1">##</span>
<span class="c1"># ISIT Really useful here ?</span>
<span class="c1">##</span>
<span class="c1">###</span>
<span class="k">def</span> <span class="nf">wallisoperator</span><span class="p">(</span><span class="n">cval</span><span class="p">,</span> <span class="n">winval</span><span class="p">,</span> <span class="n">setgain</span><span class="p">,</span> <span class="n">targmean</span><span class="p">,</span> <span class="n">targstdev</span><span class="p">,</span> <span class="n">limitstdev</span><span class="p">,</span> <span class="n">edgefactor</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Computes the Wallis operator (brigthess contrast enhancement).</span>

<span class="sd">    Parameters:</span>

<span class="sd">    :cval:  current window center value [f(x,y)]</span>

<span class="sd">    :winval: current window values</span>

<span class="sd">    :setgain: amplification factor for contrast [A]</span>

<span class="sd">    :targmean: target mean brightness level (typically between {0-255}) [m_d]</span>

<span class="sd">    :targstdev: target brightness standard deviation [\sigma_d]</span>

<span class="sd">    :limitstdev: maximal allowed window standard deviation (prevent infinitly high gain value if data are dispersed)</span>

<span class="sd">    :edgefactor: brightness forcing factor (controls ratio of edge to background intensities) [\alpha]</span>

<span class="sd">    Returns:</span>

<span class="sd">    :g_xy: Wallis operator at the current window center location [g(x,y)]</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">genproc</span><span class="o">.</span><span class="n">wallisoperator</span><span class="p">(</span><span class="n">cval</span><span class="p">,</span> <span class="n">winval</span><span class="p">,</span> <span class="n">setgain</span><span class="p">,</span> <span class="n">targmean</span><span class="p">,</span> <span class="n">targstdev</span><span class="p">,</span> <span class="n">limitstdev</span><span class="p">,</span> <span class="n">edgefactor</span><span class="p">)</span>


<span class="n">help_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;help&#39;</span><span class="p">)</span>
<span class="n">htmlhelp_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">help_path</span><span class="p">,</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">))</span>
<span class="n">pdfhelp_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">help_path</span><span class="p">,</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;GeophPy.pdf&#39;</span><span class="p">))</span>

<span class="c1">###</span>
<span class="c1">##</span>
<span class="c1"># Should be simply renamed get_help(), no ?</span>
<span class="c1">##</span>
<span class="c1">###</span>
<span class="k">def</span> <span class="nf">getgeophpyhelp</span><span class="p">(</span><span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">doctype</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">):</span>
   <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">   To get help documentation of GeophPy module</span>

<span class="sd">   Parameters:</span>

<span class="sd">   :type: type of help needed, &#39;html&#39; or &#39;pdf&#39;.</span>

<span class="sd">   Returns:</span>

<span class="sd">   :helpcommand: application to start followed by pathname and filename of the &#39;html&#39; or &#39;pdf&#39; help document.</span>

<span class="sd">   &#39;&#39;&#39;</span>

   <span class="n">path_selector</span> <span class="o">=</span> <span class="p">{</span>
       <span class="s1">&#39;pdf&#39;</span> <span class="p">:</span> <span class="n">pdfhelp_filename</span><span class="p">,</span>
       <span class="s1">&#39;html&#39;</span> <span class="p">:</span> <span class="n">htmlhelp_filename</span>
       <span class="p">}</span>

   <span class="n">pathfilename</span> <span class="o">=</span> <span class="n">path_selector</span><span class="p">[</span><span class="n">doctype</span><span class="p">]</span>

<span class="c1">##   if (doctype == &#39;pdf&#39;):</span>
<span class="c1">##      pathfilename = pdfhelp_filename</span>
<span class="c1">##   else :</span>
<span class="c1">##      pathfilename = htmlhelp_filename</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">viewer</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">):</span>           <span class="c1"># start automatically the best application</span>
       <span class="n">helpcommand</span> <span class="o">=</span> <span class="n">pathfilename</span>
   <span class="k">else</span> <span class="p">:</span>
       <span class="n">helpcommand</span> <span class="o">=</span> <span class="n">viewer</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">pathfilename</span>
   <span class="k">return</span> <span class="n">helpcommand</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2019, Lionel Darras, Quentin Vitale

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>