

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>geophpy.datasetbase &mdash; GeophPy 0.32.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> GeophPy
          

          
            
            <img src="../../_static/geophpy-square.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.32.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General informations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About GeophPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick-start.html">Getting started</a></li>
</ul>
<p class="caption"><span class="caption-text">Feature overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plot-fun.html">Plotting functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gen-proc.html">General Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mag-proc.html">Magnetic Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geopos.html">Geographic Positionning</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gui.html">Using a GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../feedback.html">Feedback &amp; Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GeophPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>geophpy.datasetbase</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for geophpy.datasetbase</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   GeophPy.datasetbase</span>
<span class="sd">   -------------------</span>

<span class="sd">   DataSet base Object constructor and methods.</span>

<span class="sd">   :copyright: Copyright 2014-2020 L. Darras, P. Marty, Q. Vitale and contributors, see AUTHORS.</span>
<span class="sd">   :license: GNU GPL v3.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">geophpy.filesmanaging.files</span> <span class="k">as</span> <span class="nn">iofiles</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.general</span> <span class="k">as</span> <span class="nn">gengeopositioning</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.kml</span> <span class="k">as</span> <span class="nn">kml</span>
<span class="kn">import</span> <span class="nn">geophpy.geopositioning.raster</span> <span class="k">as</span> <span class="nn">raster</span>
<span class="c1"># import geophpy.filesmanaging as io</span>
<span class="kn">import</span> <span class="nn">geophpy.geoposset</span> <span class="k">as</span> <span class="nn">geopos</span>
<span class="kn">import</span> <span class="nn">geophpy.operation.general</span> <span class="k">as</span> <span class="nn">genop</span>
<span class="c1">#import geophpy.plotting.colormap as colormap</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.correlation</span> <span class="k">as</span> <span class="nn">correlation</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.destriping</span> <span class="k">as</span> <span class="nn">destriping</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.histo</span> <span class="k">as</span> <span class="nn">histo</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.plot</span> <span class="k">as</span> <span class="nn">plot</span>
<span class="kn">import</span> <span class="nn">geophpy.plotting.spectral</span> <span class="k">as</span> <span class="nn">spectral</span>
<span class="c1">#import geophpy.processing.general as genproc</span>
<span class="c1">#import geophpy.processing.magnetism as magproc</span>
<span class="kn">from</span> <span class="nn">geophpy.filesmanaging.files</span> <span class="kn">import</span> <span class="n">FILE_FORMAT_DICT</span><span class="p">,</span> <span class="n">FORMAT_LIST</span>


<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="c1"># Information about DataSet Object                                         #</span>
<span class="c1"># ---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="Info"><a class="viewcode-back" href="../../api.html#geophpy.dataset.Info">[docs]</a><span class="k">class</span> <span class="nc">Info</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Class to store grid information.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    x_min : float</span>
<span class="sd">        Grid minimum x values.</span>

<span class="sd">    x_max : float</span>
<span class="sd">        Grid maximum x values.</span>

<span class="sd">    y_min : float</span>
<span class="sd">        Grid minimum y values.</span>

<span class="sd">    y_max : float</span>
<span class="sd">        Grid maximum y values.</span>

<span class="sd">    z_min : float</span>
<span class="sd">        Grid minimum z values.</span>

<span class="sd">    z_max : float</span>
<span class="sd">        Grid maximum z values.</span>

<span class="sd">    x_gridding_delta : float</span>
<span class="sd">        Grid stepsize in the x_direction.</span>

<span class="sd">    y_gridding_delta : float</span>
<span class="sd">        Grid stepsize in the y_direction.</span>

<span class="sd">    gridding_interpolation : str</span>
<span class="sd">        Interpolation method used for gridding.</span>

<span class="sd">    plottype : str</span>
<span class="sd">        Grid plot type.</span>

<span class="sd">    cmapname : str</span>
<span class="sd">        Grid plot colormap name.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">##    def __init__(self, xmin=None, xmax=None, ymin=None, ymax=None, zmin=None ,zmax=None, dx=None, dy=None,</span>
    <span class="c1">##                 interp=None, plottype =&#39;2D-SURFACE&#39;, cmap=&#39;Greys&#39;):</span>
    <span class="c1">##        self.x_min = xmin</span>
    <span class="c1">##        self.x_max = xmax</span>
    <span class="c1">##        self.y_min = ymin</span>
    <span class="c1">##        self.y_max = ymax</span>
    <span class="c1">##        self.z_min = zmin</span>
    <span class="c1">##        self.z_max = zmax</span>
    <span class="c1">##        self.x_gridding_delta = dx</span>
    <span class="c1">##        self.y_gridding_delta = dy</span>
    <span class="c1">##        self.gridding_interpolation = interp</span>
    <span class="c1">##        self.plottype = plottype</span>
    <span class="c1">##        self.cmapname = cmap</span>

    <span class="n">x_min</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">x_max</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y_min</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y_max</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">z_min</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">z_max</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">x_gridding_delta</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">y_gridding_delta</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gridding_interpolation</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">plottype</span> <span class="o">=</span> <span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">gettypelist</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cmapname</span> <span class="o">=</span> <span class="s1">&#39;Greys&#39;</span></div>


<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="c1"># Fields names and values about DataSet Object                              #</span>
<span class="c1"># ---------------------------------------------------------------------------#</span>
<div class="viewcode-block" id="Data"><a class="viewcode-back" href="../../api.html#geophpy.dataset.Data">[docs]</a><span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Class to store data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    fields : list of str</span>
<span class="sd">        Field names corresponding to the data values (&#39;x&#39;, &#39;y&#39;, &#39;vgrad&#39;).</span>

<span class="sd">    values : array-like</span>
<span class="sd">        Ungridded data values.</span>

<span class="sd">    east : array-like</span>
<span class="sd">        Ungridded data east values.</span>

<span class="sd">    north : array-like</span>
<span class="sd">        Ungridded data north values.</span>

<span class="sd">    z_image : 2-D array-like.</span>
<span class="sd">        Gridded data values.</span>

<span class="sd">    easting_image :2-D array-like.</span>
<span class="sd">        Gridded data easting values.</span>

<span class="sd">    northing_image :2-D array-like.</span>
<span class="sd">        Gridded data northing values.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    fields : list of str</span>
<span class="sd">        Field names corresponding to the data values (&#39;x&#39;, &#39;y&#39;, &#39;vgrad&#39;).</span>

<span class="sd">    x : array-like</span>
<span class="sd">        Ungridded data local x-coordinates.</span>

<span class="sd">    y : array-like</span>
<span class="sd">        Ungridded data local y-coordinates.</span>

<span class="sd">    values : array-like</span>
<span class="sd">        Ungridded data values.</span>

<span class="sd">    east : array-like</span>
<span class="sd">        Ungridded data east values.</span>

<span class="sd">    north : array-like</span>
<span class="sd">        Ungridded data north values.</span>

<span class="sd">    tracks : array-like</span>
<span class="sd">        Ungridded data track number for each data value.</span>

<span class="sd">    z_image : 2-D array-like.</span>
<span class="sd">        Gridded data values.</span>

<span class="sd">    easting_image :2-D array-like.</span>
<span class="sd">        Gridded data easting values.</span>

<span class="sd">    northing_image :2-D array-like.</span>
<span class="sd">        Gridded data northing values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">east</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">north</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">long</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">lat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">track</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">z_image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">easting_image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">northing_image</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="o">=</span> <span class="n">east</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">north</span> <span class="o">=</span> <span class="n">north</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="n">long</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="n">lat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="n">track</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_image</span> <span class="o">=</span> <span class="n">z_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">easting_image</span> <span class="o">=</span> <span class="n">easting_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">northing_image</span> <span class="o">=</span> <span class="n">northing_image</span></div>


<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="c1"># Coordinates Object in local and utm referencing                           #</span>
<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="k">class</span> <span class="nc">GeoRefPoint</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">easting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">northing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">utm_easting</span> <span class="o">=</span> <span class="n">easting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="n">northing</span>


<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="c1"># Georeferencing System Object between local and geographic positions    #</span>
<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="k">class</span> <span class="nc">GeoRefSystem</span><span class="p">:</span>

    <span class="n">active</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># data set georeferencing status</span>
    <span class="n">refsystem</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># &#39;UTM&#39;, &#39;WGS84&#39;, ...</span>
    <span class="n">utm_zoneletter</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># E -&gt; X</span>
    <span class="n">utm_zonenumber</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># 1 -&gt; 60</span>
    <span class="n">points_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of points, [[num1, lon1 or eastern1, lat1 or northern1, x, y], ...]</span>


<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="c1"># DataSet Object                                                            #</span>
<span class="c1"># ---------------------------------------------------------------------------#</span>
<span class="k">class</span> <span class="nc">DataSetBase</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class to create a DataSet Object to process and display data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    info : :obj:`~geophpy.datasetbase.Info`</span>
<span class="sd">        Class containing dataset basic information.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.Info`.</span>

<span class="sd">    data : :obj:`~geophpy.datasetbase.Data`</span>
<span class="sd">        Class containing dataset data.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.Data`.</span>

<span class="sd">    georef : :obj:`~geophpy.datasetbase.GeoRefSystem`</span>
<span class="sd">        Class containing georeferencing information.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.GeoRefSystem`.</span>

<span class="sd">    name : None or str</span>
<span class="sd">        Name of the dataset.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    info : :obj:`~geophpy.datasetbase.Info`</span>
<span class="sd">        Class containing dataset basic information.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.Info`.</span>

<span class="sd">    data : :obj:`~geophpy.datasetbase.Data`</span>
<span class="sd">        Class containing dataset data.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.Data`.</span>

<span class="sd">    georef : :obj:`~geophpy.datasetbase.GeoRefSystem`</span>
<span class="sd">        Class containing georeferencing information.</span>
<span class="sd">        See :obj:`~geophpy.datasetbase.GeoRefSystem`.</span>

<span class="sd">    name : None or str</span>
<span class="sd">        Name of the dataset.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">info</span><span class="o">=</span><span class="n">Info</span><span class="p">(),</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(),</span>
                 <span class="n">georef</span><span class="o">=</span><span class="n">GeoRefSystem</span><span class="p">(),</span>
                 <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">georef</span> <span class="o">=</span> <span class="n">georef</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1"># ??? Method to delete int he future ???</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_new</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; New empty dataset. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_georef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return True is dataset has easting and northing values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">east</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">north</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="c1"># DataSet file management                                                   #</span>
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span>
                  <span class="n">filenameslist</span><span class="p">,</span>
                  <span class="n">fileformat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">delimiter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">x_colnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">y_colnum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">z_colnum</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                  <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">skip_rows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">fields_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Build a DataSet Object from a file.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :filenameslist: list of files to open</span>
<span class="sd">                        [&#39;file1.xyz&#39;, &#39;file2.xyz&#39; ...]</span>
<span class="sd">                        or</span>
<span class="sd">                        [&#39;file*.xyz&#39;] to open all files with filename beginning by &quot;file&quot; and ending by &quot;.xyz&quot;</span>

<span class="sd">        :fileformat: format of files to open (None by default implies automatic determination from filename extension)</span>

<span class="sd">        Note: all files must have the same format</span>

<span class="sd">        :delimiter: pattern delimiting fields within one line (e.g. &#39;\t&#39;, &#39;,&#39;, &#39;;&#39; ...)</span>

<span class="sd">        :x_colnum: column number of the X coordinate of the profile (1 by default)</span>

<span class="sd">        :y_colnum: column number of the Y coordinate inside the profile (2 by default)</span>

<span class="sd">        :z_colnum: column number of the measurement profile (3 by default)</span>

<span class="sd">        :skipinitialspace: if True, several contiguous delimiters are equivalent to one</span>

<span class="sd">        :skip_rows: number of rows to skip at the beginning of the file, i.e. total number of header rows (1 by default)</span>

<span class="sd">        :fields_row: row number where to read the field names ; if -1 then default field names will be &quot;X&quot;, &quot;Y&quot; and &quot;Z&quot;</span>

<span class="sd">        Returns:</span>

<span class="sd">        :success: true if DataSet Object built, false if not</span>

<span class="sd">        :dataset: DataSet Object build from file(s) (empty if any error)</span>

<span class="sd">        Example:</span>

<span class="sd">        success, dataset = DataSet.from_file(&quot;file.csv&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Conversion to list for eventual single file name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filenameslist</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">filenameslist</span> <span class="o">=</span> <span class="p">[</span><span class="n">filenameslist</span><span class="p">]</span>

        <span class="c1"># Dispatch method</span>
        <span class="k">class</span> <span class="nc">From</span><span class="p">:</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">ascii</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">from_ascii</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                          <span class="n">filenameslist</span><span class="p">,</span>
                                          <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                                          <span class="n">x_colnum</span><span class="o">=</span><span class="n">x_colnum</span><span class="p">,</span>
                                          <span class="n">y_colnum</span><span class="o">=</span><span class="n">y_colnum</span><span class="p">,</span>
                                          <span class="n">z_colnum</span><span class="o">=</span><span class="n">z_colnum</span><span class="p">,</span>
                                          <span class="n">skipinitialspace</span><span class="o">=</span><span class="n">skipinitialspace</span><span class="p">,</span>
                                          <span class="n">skip_rows</span><span class="o">=</span><span class="n">skip_rows</span><span class="p">,</span>
                                          <span class="n">fields_row</span><span class="o">=</span><span class="n">fields_row</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">netcdf</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">from_netcdf</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                           <span class="n">filenameslist</span><span class="p">,</span>
                                           <span class="n">x_colnum</span><span class="o">=</span><span class="n">x_colnum</span><span class="p">,</span>
                                           <span class="n">y_colnum</span><span class="o">=</span><span class="n">y_colnum</span><span class="p">,</span>
                                           <span class="n">z_colnum</span><span class="o">=</span><span class="n">z_colnum</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">surfer</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">from_grd</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                        <span class="n">filenameslist</span><span class="p">,</span>
                                        <span class="n">gridtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">uxo</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">from_uxo</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span>
                                        <span class="n">filenameslist</span><span class="p">)</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="c1"># Format from file extension</span>
        <span class="k">if</span> <span class="n">fileformat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filenameslist</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">fileformat</span> <span class="o">=</span> <span class="s1">&#39;ascii&#39;</span>  <span class="c1"># default format</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Determining file format from extension &quot;</span><span class="si">{}</span><span class="s1">&quot; ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">FILE_FORMAT_DICT</span><span class="p">:</span>
                <span class="n">fileformat</span> <span class="o">=</span> <span class="n">FILE_FORMAT_DICT</span><span class="p">[</span><span class="n">ext</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> format found for extension &quot;</span><span class="si">{1}</span><span class="s1">&quot; ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fileformat</span><span class="p">,</span> <span class="n">ext</span><span class="p">))</span>

        <span class="c1"># Read the data from input file</span>
        <span class="k">if</span> <span class="n">fileformat</span> <span class="ow">in</span> <span class="n">FORMAT_LIST</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... Reading file using &quot;</span><span class="si">{}</span><span class="s1">&quot;  file format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fileformat</span><span class="p">))</span>
            <span class="n">readfile</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">From</span><span class="p">,</span> <span class="n">fileformat</span><span class="p">)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">readfile</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Undefined file format&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fileformat</span><span class="p">))</span>
            <span class="c1"># Undefined file format</span>
            <span class="c1"># ...TBD... raise an error here !</span>
            <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Error code</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">success</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">success</span><span class="p">,</span> <span class="n">dataset</span>

    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">filename</span><span class="p">,</span>
                <span class="n">fileformat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">gridtype</span><span class="o">=</span><span class="s1">&#39;surfer7bin&#39;</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ignore_nodata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Save a DataSet Object to a file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        filename : str</span>
<span class="sd">            Name of file to save.</span>

<span class="sd">        fileformat : {&quot;ascii&quot;, &quot;netcdf&quot;, &quot;surfer&quot;, &quot;uxo&quot;, &quot;cmd&quot;}</span>
<span class="sd">            Format for the output file.</span>
<span class="sd">            If None (by default), the fileformat will automatically by determined from filename extension.</span>

<span class="sd">        delimiter : {&quot;\t&quot;, &quot;,&quot;, &quot;;&quot;}, optional</span>
<span class="sd">            Delimiter of the output file when fileformat is &#39;ascii&#39;.</span>
<span class="sd">            By default &quot;\t&quot;.</span>

<span class="sd">        gridtype : {&#39;surfer7bin&#39;, &#39;surfer6bin&#39;, &#39;surfer6ascii&#39;}, optional</span>
<span class="sd">            Format for the surfer grid file when fileformat is &#39;surfer&#39;. </span>
<span class="sd">            By default &#39;surfer7bin&#39;.</span>

<span class="sd">        description : str</span>
<span class="sd">            Description of the output file when fileformat is &#39;netcdf&#39;. </span>
<span class="sd">            By default &#39;None&#39;.</span>

<span class="sd">        ignore_nodata : bool, optional</span>
<span class="sd">            Flag to ignore when saving the file. Default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        success : bool</span>
<span class="sd">            True if the file was written successfully, False otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Dispatch method</span>
        <span class="k">class</span> <span class="nc">To</span><span class="p">:</span>
            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">ascii</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">to_ascii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                        <span class="n">filename</span><span class="p">,</span>
                                        <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
                                        <span class="n">ignore_nodata</span><span class="o">=</span><span class="n">ignore_nodata</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">netcdf</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                         <span class="n">filename</span><span class="p">,</span>
                                         <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">surfer</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">to_grd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">filename</span><span class="p">,</span>
                                      <span class="n">gridtype</span><span class="o">=</span><span class="n">gridtype</span><span class="p">)</span>

            <span class="nd">@staticmethod</span>
            <span class="k">def</span> <span class="nf">uxo</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">iofiles</span><span class="o">.</span><span class="n">to_uxo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

        <span class="c1"># Choose the dataset format</span>
        <span class="k">if</span> <span class="n">fileformat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># Format from file extension</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Determining file format from extension &quot;</span><span class="si">{}</span><span class="s1">&quot; ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ext</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">FILE_FORMAT_DICT</span><span class="p">:</span>
                <span class="n">fileformat</span> <span class="o">=</span> <span class="n">FILE_FORMAT_DICT</span><span class="p">[</span><span class="n">ext</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">fileformat</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> format found for extension &quot;</span><span class="si">{1}</span><span class="s1">&quot; ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fileformat</span><span class="p">,</span> <span class="n">ext</span><span class="p">))</span>

        <span class="c1"># Write the dataset to file</span>
        <span class="k">if</span> <span class="n">fileformat</span> <span class="ow">in</span> <span class="n">FORMAT_LIST</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;writting file using &quot;</span><span class="si">{}</span><span class="s1">&quot; format &quot; ...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fileformat</span><span class="p">))</span>
            <span class="n">writefile</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">To</span><span class="p">,</span> <span class="n">fileformat</span><span class="p">)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">writefile</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Undefined file format</span>
            <span class="c1"># ...TBD... raise an error here !</span>
            <span class="n">error</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Return error code</span>
        <span class="k">if</span> <span class="n">error</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Return dataset data as a dictionary. &#39;&#39;&#39;</span>
        
        <span class="n">dic</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;crs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">refsystem</span>
        <span class="c1">#dic[&#39;values&#39;] = self.data.values[:, -1]</span>

        <span class="k">return</span> <span class="n">dic</span>
        
    
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="c1"># DataSet Plotting                                                          #</span>
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">plottype</span><span class="o">=</span><span class="s1">&#39;2D-SCATTER&#39;</span><span class="p">,</span>
             <span class="n">cmapname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">cmmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">cmmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span>
             <span class="n">levels</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
             <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">axisdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">labeldisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">pointsdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">rects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
             <span class="n">markersize</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># replacing with **kwargs</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the dataset.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plottype : str, {&#39;2D-SCATTER&#39;, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, &#39;2D-CONTOURF&#39;, &#39;2D-POSTMAP&#39;}</span>
<span class="sd">            Plot type for the data representation.</span>
<span class="sd">            Plot type can be</span>

<span class="sd">            ``2D-SCATTER``</span>
<span class="sd">                (by default) ungridded data values are dispay in a scatter plot.</span>
<span class="sd">                Plot type &#39;SCATTER&#39;, &#39;SCAT&#39; and &#39;SC&#39; are also recognised.</span>

<span class="sd">            ``2D-SURFACE``</span>
<span class="sd">                Gridded data values are dispay in a surface (image) plot.</span>
<span class="sd">                Plot type &#39;SURFACE&#39;, &#39;SURF&#39; and &#39;SF&#39; are also recognised.</span>

<span class="sd">            ``2D-CONTOUR``</span>
<span class="sd">                Gridded data values are dispay in a UNFILLED contour plot.</span>
<span class="sd">                If this plot type is used, you can specify the number of</span>
<span class="sd">                contours used with the ``levels`` keyword.</span>
<span class="sd">                Plot type &#39;CONTOUR&#39;, &#39;CONT&#39; and &#39;CT&#39; are also recognised.</span>

<span class="sd">            ``2D-CONTOURF``</span>
<span class="sd">                Gridded data values are dispay in a FILLED contour plot.</span>
<span class="sd">                If this plot type is used, you can specify the number of</span>
<span class="sd">                contours used with the ``levels`` keyword.</span>
<span class="sd">                Plot type &#39;CONTOURF&#39;, &#39;CONTF&#39; and &#39;CF&#39; are also recognised.</span>

<span class="sd">            ``2D-POSTMAP``</span>
<span class="sd">                Ungridded data position are dispay in a scatter plot.</span>
<span class="sd">                It is different from the &#39;2D-SCATTER&#39; plot because</span>
<span class="sd">                the data value is not represented (all point have the same color).</span>
<span class="sd">                Plot type &#39;POSTMAP&#39;, &#39;POST&#39; and &#39;PM&#39; are also recognised.</span>

<span class="sd">        cmapname : str</span>
<span class="sd">            Name of the color map to be used &#39;gray&#39; for example.</span>
<span class="sd">            To use a reversed colormap, add &#39;_r&#39; at the end of the colormap name (&#39;gray_r&#39;)</span>
<span class="sd">            or set ``creversed`` to ``True``.</span>

<span class="sd">        creversed : bool</span>
<span class="sd">            Flag to add &#39;_r&#39; at the end of the color map name to reverse it.</span>

<span class="sd">        fig : Matplotlib figure object</span>
<span class="sd">            Figure to plot, None by default to create a new figure.</span>
<span class="sd">            If a figure object is provided, it wiil be cleared before displaying the current data.</span>

<span class="sd">        filename : str or None</span>
<span class="sd">            Name of file to save the figure, None (by default).</span>

<span class="sd">        cmmin : scalar</span>
<span class="sd">            Minimal value to display in the color map range.</span>

<span class="sd">        cmmax : scalar</span>
<span class="sd">            Maximal value to display in the color map range.</span>

<span class="sd">        interpolation : str,</span>
<span class="sd">            Interpolation method used for the pixel interpolation (&#39;bilinear&#39; by default).</span>
<span class="sd">            If interpolation is &#39;none&#39;, then no interpolation is performed for the display.</span>
<span class="sd">            Supported values are &#39;none&#39;, &#39;nearest&#39;, &#39;bilinear&#39;, &#39;bicubic&#39;,</span>
<span class="sd">            &#39;spline16&#39;, &#39;spline36&#39;, &#39;hanning&#39;, &#39;hamming&#39;, &#39;hermite&#39;, &#39;kaiser&#39;,</span>
<span class="sd">            &#39;quadric&#39;, &#39;catrom&#39;, &#39;gaussian&#39;, &#39;bessel&#39;, &#39;mitchell&#39;, &#39;sinc&#39;, &#39;lanczos&#39;.</span>

<span class="sd">        levels : (int or array-like)</span>
<span class="sd">            Determines the number and positions of the contour lines / regions.</span>
<span class="sd">            If an int n, use n data intervals; i.e. draw n+1 contour lines. The level heights are automatically chosen.</span>
<span class="sd">            If array-like, draw contour lines at the specified levels. The values must be in increasing order.</span>

<span class="sd">        cmapdisplay : bool</span>
<span class="sd">            True to display colorbar, False to hide the colorbar.</span>

<span class="sd">        axisdisplay : bool</span>
<span class="sd">            True to display axis (and their labels), False to hide axis (and labels).</span>

<span class="sd">        labeldisplay : bool</span>
<span class="sd">            True to display labels on axis, False to hide labels on axis.</span>

<span class="sd">        pointsdisplay : bool</span>
<span class="sd">            True to display grid points.</span>

<span class="sd">        dpi : int or None</span>
<span class="sd">            Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

<span class="sd">        transparent : bool</span>
<span class="sd">            Flag to manage transparency when saving the figure into a file (False by default).</span>

<span class="sd">        logscale : bool</span>
<span class="sd">            Flag to use a logarithmic color scale.</span>

<span class="sd">        rects: None or array_like</span>
<span class="sd">            Coordinates of additional rectanngles to display:</span>
<span class="sd">            [[x0, y0, w0, h0], [x1, y1, w1, h1], ...].</span>
<span class="sd">            None by default.</span>

<span class="sd">        points: None or array_like</span>
<span class="sd">            Coordinates of additional points to display:</span>
<span class="sd">            [[x0, y0], [x1, y1], ...]. None by default.</span>

<span class="sd">        marker: str</span>
<span class="sd">            Matplotlib marker style for data point display.</span>

<span class="sd">        markersize: scalar</span>
<span class="sd">            Size for the marker for data point display.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>
<span class="sd">            Dataset map figure.</span>

<span class="sd">        cmap : Matplotlib ColorBar Object</span>
<span class="sd">            Colorbar associated with the figure if ``cmapdisplay`` is ``True``, ``None`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Updating dataset colormap name</span>
        <span class="k">if</span> <span class="n">cmapname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmapname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">cmapname</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">cmapname</span> <span class="o">=</span> <span class="n">cmapname</span>

        <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plottype</span><span class="p">,</span> <span class="n">cmapname</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="n">creversed</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">cmmin</span><span class="o">=</span><span class="n">cmmin</span><span class="p">,</span>
                         <span class="n">cmmax</span><span class="o">=</span><span class="n">cmmax</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="n">cmapdisplay</span><span class="p">,</span>
                         <span class="n">axisdisplay</span><span class="o">=</span><span class="n">axisdisplay</span><span class="p">,</span> <span class="n">labeldisplay</span><span class="o">=</span><span class="n">labeldisplay</span><span class="p">,</span> <span class="n">pointsdisplay</span><span class="o">=</span><span class="n">pointsdisplay</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
                         <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span> <span class="n">rects</span><span class="o">=</span><span class="n">rects</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                         <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the dataset. &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">plot_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the ungridded data values in a scatter plot. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Additional keyword arguments for display options.</span>
<span class="sd">            see :meth:`~geophpy.dataset.DataSet.plot` for details.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>
<span class="sd">            Dataset map figure.</span>

<span class="sd">        cmap : Matplotlib ColorBar Object</span>
<span class="sd">            Colorbar associated with the figure if ``cmapdisplay`` is ``True``, ``None`` otherwise.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;2D-SCATTER&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmapname&#39;</span><span class="p">,</span> <span class="s1">&#39;Greys&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_postmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the dataset. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the dataset. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">plot_contourf</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
        <span class="sd">&quot;&quot;&quot; 2D representation of the dataset. &quot;&quot;&quot;</span>
        

    <span class="k">def</span> <span class="nf">histo_getlimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the data min and max values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        valfilt : bool</span>
<span class="sd">            If True, min and max are taken from data values.</span>
<span class="sd">            Otherxise, min and max are taken from data z_image.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        zmin, zmax : float</span>
<span class="sd">            Data min and max values.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">histo</span><span class="o">.</span><span class="n">getlimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span>


<span class="c1">###</span>
<span class="c1">###</span>
<span class="c1">##</span>
<span class="c1"># TO IMPLEMENT in the next version</span>
<span class="c1">##</span>
<span class="c1">###</span>
<span class="c1">##   def histo_fit(self):</span>
<span class="c1">##       &#39;&#39;&#39; &#39;&#39;&#39;</span>
<span class="c1">##       return</span>

<span class="c1">### Change name to plot_histo</span>
    <span class="k">def</span> <span class="nf">histo_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">coloredhisto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showtitle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot the dataset histogram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : Matplotlib figure object</span>
<span class="sd">            Figure to use for the plot, None (by default) to create a new figure.</span>

<span class="sd">        filename : str or None</span>
<span class="sd">            Name of file to save the figure, None (by default).</span>

<span class="sd">        zmin, zmax : float or None</span>
<span class="sd">            Minimal and maximal values to represent.</span>

<span class="sd">        cmapname : str</span>
<span class="sd">            Name of the color map to be used &#39;gray&#39; for example.</span>
<span class="sd">            To use a reversed colormap, add &#39;_r&#39; at the end of the colormap name (&#39;gray_r&#39;)</span>
<span class="sd">            or set ``creversed`` to ``True``.</span>

<span class="sd">        creversed : bool</span>
<span class="sd">            Flag to add &#39;_r&#39; at the end of the color map name to reverse it.</span>

<span class="sd">        cmapdisplay : bool</span>
<span class="sd">            Flag to display a color bar (True by default).</span>

<span class="sd">        coloredhisto : bool</span>
<span class="sd">            Flag to color the histogram using the given colormap (True by default). If False, black will be used.</span>

<span class="sd">        showtitle : bool</span>
<span class="sd">            Flag to display the dataset name as title (True by default).</span>

<span class="sd">        dpi : int or None</span>
<span class="sd">            Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

<span class="sd">        transparent : bool</span>
<span class="sd">            Flag to manage transparency when saving the figure into a file (False by default).</span>

<span class="sd">        valfilt : bool</span>
<span class="sd">            If set to True, the :func:`~geophpy.dataset.DataSet.data.values`</span>
<span class="sd">            are filtered instead of the :func:`~geophpy.dataset.DataSet.data.z_image`</span>
<span class="sd">            (False By default).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>
<span class="sd">            Dataset histogram figure.</span>

<span class="sd">        cmap : Matplotlib ColorBar Object</span>
<span class="sd">            Colorbar associated with the figure if ``cmapdisplay`` is ``True``, ``None`` otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Updating dataset colormap name</span>
        <span class="k">if</span> <span class="n">cmapname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmapname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">cmapname</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">cmapname</span> <span class="o">=</span> <span class="n">cmapname</span>

        <span class="k">return</span> <span class="n">histo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">zmin</span><span class="o">=</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="n">zmax</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="n">cmapname</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="n">creversed</span><span class="p">,</span>
                          <span class="n">cmapdisplay</span><span class="o">=</span><span class="n">cmapdisplay</span><span class="p">,</span> <span class="n">coloredhisto</span><span class="o">=</span><span class="n">coloredhisto</span><span class="p">,</span> <span class="n">showtitle</span><span class="o">=</span><span class="n">showtitle</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                          <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span>


    <span class="c1">### Change name to plot_corrmap</span>
    <span class="k">def</span> <span class="nf">correlation_plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Crosscorr&quot;</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span>
                            <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showenvelope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot profile-to-profile correlation map.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str, {&#39;Crosscorr&#39;, &#39;Pearson&#39;, &#39;Spearman&#39; or &#39;Kendall&#39;}</span>
<span class="sd">            Correlation method.</span>

<span class="sd">        cmapname : str or None</span>
<span class="sd">            Name of the color map to be used, &#39;gray_r&#39; for example.</span>

<span class="sd">        fig : Matplotlib figure object</span>
<span class="sd">            Figure to use for the plot, None (by default) to create a new figure.</span>

<span class="sd">        filename : str or None</span>
<span class="sd">            Name of the file to save the figure, None (by default).</span>

<span class="sd">        dpi : int or None</span>
<span class="sd">            Definition (&#39;dot per inch&#39;) to use when saving the figure into a file (None by default).</span>

<span class="sd">        transparent : bool</span>
<span class="sd">            Flag to manage transparency when saving the figure into a file (False by default).</span>

<span class="sd">        showenvelope : bool</span>
<span class="sd">            Flag to display the correlation map envelope.</span>

<span class="sd">        cmapdisplay : bool</span>
<span class="sd">            Flag to display a color bar (True by default).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>
<span class="sd">            Dataset profile-to-profile correlation map.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">correlation</span><span class="o">.</span><span class="n">plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="n">cmapname</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                                   <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span> <span class="n">showenvelope</span><span class="o">=</span><span class="n">showenvelope</span><span class="p">)</span>


    <span class="c1">### Change name to plot_corrsum</span>
    <span class="k">def</span> <span class="nf">correlation_plotsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Crosscorr&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">showenvelope</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">showfit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot correlation sum.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : Matplotlib figure object</span>
<span class="sd">            Figure to use for the plot, None (by default) to create a new figure.</span>

<span class="sd">        filename : str or None</span>
<span class="sd">            Name of the file to save the figure, None (by default).</span>

<span class="sd">        method : str, {&#39;Crosscorr&#39;, &#39;Pearson&#39;, &#39;Spearman&#39; or &#39;Kendall&#39;}</span>
<span class="sd">            Correlation method.</span>

<span class="sd">        transparent : bool</span>
<span class="sd">            Flag to manage transparency when saving the figure into a file (False by default).</span>
<span class="sd">            (False By default).</span>

<span class="sd">        showenvelope : bool</span>
<span class="sd">            Flag to display the curve envelope.</span>

<span class="sd">        showfit : bool</span>
<span class="sd">            Flag to display the curve gausian beest fit.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>
<span class="sd">            Dataset profile-to-profile correlation sum.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">correlation</span><span class="o">.</span><span class="n">plotsum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                                   <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">,</span>
                                   <span class="n">showenvelope</span><span class="o">=</span><span class="n">showenvelope</span><span class="p">,</span> <span class="n">showfit</span><span class="o">=</span><span class="n">showfit</span><span class="p">)</span>


    <span class="c1">### Change name to plot_meantrack</span>
    <span class="k">def</span> <span class="nf">meantrack_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">method</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="s1">&#39;mono&#39;</span><span class="p">,</span> <span class="n">Ndeg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">plotflag</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the dataset mean cross-track profile before and after destriping.</span>

<span class="sd">        Parameters :</span>

<span class="sd">        :fig: figure to plot, None by default to create a new figure. `matplotlib.figure.Figure`</span>

<span class="sd">        :filename: Name of the histogram file to save, None if no file to save.</span>

<span class="sd">        :Nprof: number of profiles to compute the reference mean</span>

<span class="sd">        :setmin: float, While computing the mean, do not take into account data values lower than *setmin*.</span>

<span class="sd">        :setmax: float, While computing the mean, do not take into account data values greater than *setmax*.</span>

<span class="sd">        :method: destriping method (additive or multiplicative)</span>

<span class="sd">        :reference: destriping reference (mean and standard deviation or median and interquartile range)</span>

<span class="sd">        :config: destriping configuration (&#39;mono&#39; sensor: only offset matching (mean / median), &#39;multi&#39; sensor: both offset and gain (standard deviation/interquartile range))</span>

<span class="sd">        :plotflag: str, {&#39;raw&#39;, &#39;destriped&#39;, &#39;both&#39;} to plot raw, destriped or both data</span>

<span class="sd">        :Ndeg: polynomial degree of the curve to fit</span>

<span class="sd">        :transparent: True to manage the transparency.</span>

<span class="sd">        Returns :</span>

<span class="sd">        :fig: Figure Object</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>

<span class="sd">        The mean cross-track profile is the profile composed the mean of each</span>
<span class="sd">        profile in the dataset.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">destriping</span><span class="o">.</span><span class="n">plot_mean_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">Nprof</span><span class="o">=</span><span class="n">Nprof</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="n">setmin</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="n">setmax</span><span class="p">,</span>
                                          <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">Ndeg</span><span class="o">=</span><span class="n">Ndeg</span><span class="p">,</span> <span class="n">plotflag</span><span class="o">=</span><span class="n">plotflag</span><span class="p">,</span>
                                          <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">setmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Plot the dataset track n.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">spectral</span><span class="o">.</span><span class="n">plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">plottype</span><span class="o">=</span><span class="n">plottype</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                <span class="n">cmapdisplay</span><span class="o">=</span><span class="n">cmapdisplay</span><span class="p">,</span> <span class="n">axisdisplay</span><span class="o">=</span><span class="n">axisdisplay</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>
    
    
    <span class="c1">### Change name to plot_sprectum</span>
    <span class="k">def</span> <span class="nf">spectral_plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plottype</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">axisdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the dataset 2-D Fourier Transform.</span>

<span class="sd">        Paramters</span>
<span class="sd">        ---------</span>
<span class="sd">        fig : figure to plot,</span>
<span class="sd">            Figure used for the plot. None by default to create a new figure.</span>

<span class="sd">        filename : str</span>
<span class="sd">            Name of the file to save the figure. None (default) if no file to save.</span>

<span class="sd">        dpi : int</span>
<span class="sd">            &#39;dot per inch&#39; definition of the picture file if filename is not None.</span>

<span class="sd">        plottype : str {&#39;magnitude&#39; or &#39;amplitude&#39;,&#39;power&#39;,phase&#39;,&#39;real&#39;,&#39;imag&#39;}</span>
<span class="sd">            Spectrum composante to plot.</span>

<span class="sd">        logscale : bool</span>
<span class="sd">            True for a plot with a logarithmic colorscale.</span>

<span class="sd">        cmapdisplay : bool</span>
<span class="sd">            True to display a colorbar.</span>

<span class="sd">        axisdisplay : bool</span>
<span class="sd">            True to display axis, False to hide the axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">spectral</span><span class="o">.</span><span class="n">plotmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">plottype</span><span class="o">=</span><span class="n">plottype</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="n">logscale</span><span class="p">,</span>
                                <span class="n">cmapdisplay</span><span class="o">=</span><span class="n">cmapdisplay</span><span class="p">,</span> <span class="n">axisdisplay</span><span class="o">=</span><span class="n">axisdisplay</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">plot_directional_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">axisdisplay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">paramdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the dataset 2-D directional filter.</span>

<span class="sd">        Paramters</span>
<span class="sd">        ---------</span>
<span class="sd">        cmapname : str</span>
<span class="sd">            Name of the color map to be used, &#39;gray_r&#39; for example.</span>

<span class="sd">        creversed : bool</span>
<span class="sd">            True to reverse the color map (add &#39;_r&#39; at the cmapname).</span>

<span class="sd">         fig : figure to plot,</span>
<span class="sd">             Figure used for the plot. None by default to create a new figure.</span>

<span class="sd">         filename : str</span>
<span class="sd">             Name of the file to save the figure. None (default) if no file to save.</span>

<span class="sd">         dpi : int</span>
<span class="sd">             &#39;dot per inch&#39; definition of the picture file if filename is not None.</span>

<span class="sd">         cmapdisplay : bool</span>
<span class="sd">             True to display colorbar, False to hide the colorbar.</span>

<span class="sd">         axisdisplay : bool</span>
<span class="sd">             True to display axis, False to hide the axis.</span>

<span class="sd">         axisdisplay : bool</span>
<span class="sd">             True to display filter parameter in the title.</span>

<span class="sd">         shape : tuple</span>
<span class="sd">             Filter shape.</span>

<span class="sd">         cutoff : ndarray</span>
<span class="sd">             Input array to filter.</span>

<span class="sd">         azimuth : scalar</span>
<span class="sd">             Directional filter azimuth angle in degree.</span>

<span class="sd">         width : integer</span>
<span class="sd">             Gaussian filter cutoff frequency.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Matplotlib Figure Object</span>

<span class="sd">        cmap : Matplotlib ColorMap Object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">spectral</span><span class="o">.</span><span class="n">plot_directional_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmapname</span><span class="o">=</span><span class="n">cmapname</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="n">creversed</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                                                <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="n">cmapdisplay</span><span class="p">,</span> <span class="n">axisdisplay</span><span class="o">=</span><span class="n">axisdisplay</span><span class="p">,</span>
                                                <span class="n">paramdisplay</span><span class="o">=</span><span class="n">paramdisplay</span><span class="p">,</span>
                                                <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>


    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="c1"># DataSet Operations                                                        #</span>
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To duplicate a DataSet Object.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :dataset: DataSet Object to duplicate</span>

<span class="sd">        Returns:</span>

<span class="sd">        :newdataset: duplicated DataSet Object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">x_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_frame_factor</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                    <span class="n">y_frame_factor</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dataset gridding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        interpolation : str {&#39;none&#39;, &#39;nearest&#39;, &#39;linear&#39;, &#39;cubic&#39;}</span>
<span class="sd">            Method used to grid the dataset. Can be:</span>

<span class="sd">            ``none``</span>
<span class="sd">                (by default) simply projects raw data on a regular grid without interpolation.</span>
<span class="sd">                Holes are filled with NaNs and values falling in the same grid cell are averaged.</span>

<span class="sd">            ``nearest``</span>
<span class="sd">                return the value at the data point closest to</span>
<span class="sd">                the point of interpolation.</span>

<span class="sd">            ``linear``</span>
<span class="sd">                tesselate the input point set to n-dimensional</span>
<span class="sd">                simplices, and interpolate linearly on each simplex.</span>

<span class="sd">            ``cubic``</span>
<span class="sd">                return the value determined from a</span>
<span class="sd">                piecewise cubic, continuously differentiable (C1), and</span>
<span class="sd">                approximately curvature-minimizing polynomial surface.</span>

<span class="sd">        x_step, y_step : float or None</span>
<span class="sd">            Gridding step in the x and y direction.</span>
<span class="sd">            Use None (by default) to estimate the median x- and y-step from data values.</span>

<span class="sd">        x_prec, y_prec : int or None</span>
<span class="sd">            Decimal precision to keep for the grid computation.</span>
<span class="sd">            None (by default) to use the maximal number of decimal present in the data values coordinates.</span>

<span class="sd">        x_frame_factor :</span>
<span class="sd">            Frame extension coefficient along x axis (e.g. 0.1 means xlength +10% on each side, i.e. xlength +20% in total) ; pixels within extended borders will be filled with &quot;nan&quot;</span>

<span class="sd">        y_frame_factor :</span>
<span class="sd">            Frame extension coefficient along y axis (e.g. 0.45 means yheight +45% top and bottom, i.e. yheight +90% in total) ; pixels within extended borders will be filled with &quot;nan&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Gridded DataSet object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">x_step</span><span class="o">=</span><span class="n">x_step</span><span class="p">,</span> <span class="n">y_step</span><span class="o">=</span><span class="n">y_step</span><span class="p">,</span> <span class="n">x_prec</span><span class="o">=</span><span class="n">x_prec</span><span class="p">,</span>
                                 <span class="n">y_prec</span><span class="o">=</span><span class="n">y_prec</span><span class="p">,</span> <span class="n">x_frame_factor</span><span class="o">=</span><span class="n">x_frame_factor</span><span class="p">,</span> <span class="n">y_frame_factor</span><span class="o">=</span><span class="n">y_frame_factor</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Re-sample data at ungridded sample position from gridded Z_image.</span>

<span class="sd">        Re-sample ungridded values from gridded Z_image using a</span>
<span class="sd">        cubic spline spline interpolation.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Dataset re-gridding.</span>

<span class="sd">        During regridding, a copy of the dataset is re-sampled</span>
<span class="sd">        (see :meth:`~geophpy.dataset.DataSet.sample`)</span>
<span class="sd">        and interpolated with the given x and y-steps.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_step, y_step : float or None</span>
<span class="sd">            Gridding step in the x and y direction.</span>
<span class="sd">            Use None (by default) to resample current grid by a factor 2 (step_new = step_old*0.5).</span>

<span class="sd">        method : str {&#39;cubic&#39;, &#39;nearest&#39;, &#39;linear&#39;}</span>
<span class="sd">            Method used to re-grid the dataset. see :meth:`~geophpy.dataset.DataSet.interpolate`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Re-gridded DataSet object.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Only the grid is affected and the ungriddedd data values are kept unchanged.</span>
<span class="sd">        to propagate a change in the ungriddedd data values,</span>
<span class="sd">        you may want to use the filters ``valfilt`` keyword or the association of</span>
<span class="sd">        :meth:`~geophpy.dataset.DataSet.sample` and</span>
<span class="sd">        :meth:`~geophpy.dataset.DataSet.sample`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        sample, interpolate</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the dataset basic statistics.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :dataset: DataSet Object from which to compute stats.</span>

<span class="sd">        :valfilt: if set to True, computes on data.values instead of data.z_image.</span>

<span class="sd">        :valmin, valmax: Consider only data values between valmin and valmax.</span>

<span class="sd">        Returns:</span>

<span class="sd">        :mean, std, median: array arithmetic mean, standard deviation and median.</span>

<span class="sd">        :Q1, Q3: dataset 1st and 3rd quartiles (25th and 75th percentiles).</span>

<span class="sd">        :IQR: dataset interquartile range (Q3 - Q1).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">,</span> <span class="n">valmin</span><span class="o">=</span><span class="n">valmin</span><span class="p">,</span> <span class="n">valmax</span><span class="o">=</span><span class="n">valmax</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zimfilt</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a constant to the dataset Values and Z_image.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :val: constant to add.</span>

<span class="sd">        :valfilt: flag to add constant on dataset values.</span>

<span class="sd">        :zimfilt: flag to add constant on dataset z_image.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">,</span> <span class="n">zimfilt</span><span class="o">=</span><span class="n">zimfilt</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zimfilt</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply by a constant the dataset Values and Z_image</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :val: constant to multiply by.</span>

<span class="sd">        :valfilt: flag to add constant on dataset values.</span>

<span class="sd">        :zimfilt: flag to add constant on dataset z_image.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">times_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="n">val</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">,</span> <span class="n">zimfilt</span><span class="o">=</span><span class="n">zimfilt</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">setmedian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the dataset values and Z_image to a given value</span>
<span class="sd">        (for instance zero for zero median surveys).</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :median: target value to set the dataset median to.</span>

<span class="sd">        :method: method used to set the median (&#39;additive&#39; or &#39;multiplicative&#39;).</span>

<span class="sd">        :profilefilter: ...TBD... True: set each survey profiles median to &#39;median&#39;.</span>
<span class="sd">                        False: set the global survey median to &#39;median&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">setmedian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">median</span><span class="o">=</span><span class="n">median</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">setmean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the dataset values and Z_image to a given value</span>
<span class="sd">        (for instance zero for zero median surveys).</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :mean: value to set the dataset mean to.</span>

<span class="sd">        :method: method used to set the mean (&#39;additive&#39; or &#39;multiplicative&#39;).</span>

<span class="sd">        :profilefilter: ...TBD... True: set each survey profiles mean to &#39;mean&#39;.</span>
<span class="sd">                        False: set the global survey mean to &#39;mean&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">setmean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shiftx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shifty</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dataset translation.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :shiftx: Constant to apply to the x-abscisse.</span>

<span class="sd">        :shifty: Constant to apply to the y-abscisse.</span>

<span class="sd">        Returns:</span>

<span class="sd">        Translated DataSet object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shiftx</span><span class="o">=</span><span class="n">shiftx</span><span class="p">,</span> <span class="n">shifty</span><span class="o">=</span><span class="n">shifty</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dataset rotation (clockwise).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        angle: float</span>
<span class="sd">            Rotation angle (in ).</span>

<span class="sd">        center: str {None, &#39;BL&#39;, &#39;BR&#39;, &#39;TL, &#39;TR&#39;}</span>
<span class="sd">            Center of rotation: &#39;BL&#39;, &#39;BR&#39;, &#39;TL and &#39;TR&#39; for bottom left,</span>
<span class="sd">            bottom rght, top left and top right corner.</span>
<span class="sd">            If None,  the dataset centroid will be used.</span>

<span class="sd">        Returns:</span>

<span class="sd">        Rotated DataSet object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">)</span>


    <span class="c1">##   def matchedges(self, datasets, matchmethod=&#39;equalmedian&#39;, setmed=None, valfilt=True, setmethod=&#39;additive&#39;):</span>
    <span class="c1">##       &#39;&#39;&#39;</span>
    <span class="c1">##       &#39;&#39;&#39;</span>
    <span class="c1">##       return genop.matchedges(datasets, matchmethod=matchmethod, setmed=setmed, valfilt=valfilt, setmethod=setmethod)</span>

    <span class="c1"># staticmethod</span>
    <span class="c1"># def merge(datasetlist, matchmethod=None, setval=None, setmethod=&#39;additive&#39;, meanrange=None):</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">matchmethod</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setmethod</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">meanrange</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge datasets together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        datasetlist : tuple or list.</span>
<span class="sd">            Sequence of datasets to merge. Each DataSet Object must have the same coordinates system.</span>

<span class="sd">        matchmethod :</span>

<span class="sd">        setmethod : {&#39;additive&#39;, &#39;multiplicative&#39;}</span>
<span class="sd">            Method used to merge the datasets ## TODO Complete docstring.</span>

<span class="sd">        setval :</span>

<span class="sd">        meanrange :</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        merged :  new DataSet Object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Empty Merge DataSet</span>
        <span class="n">datasetout</span> <span class="o">=</span> <span class="n">DataSetBase</span><span class="o">.</span><span class="n">_new</span><span class="p">()</span>
        <span class="n">genop</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasetout</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">matchmethod</span><span class="o">=</span><span class="n">matchmethod</span><span class="p">,</span> <span class="n">setval</span><span class="o">=</span><span class="n">setval</span><span class="p">,</span> <span class="n">setmethod</span><span class="o">=</span><span class="n">setmethod</span><span class="p">,</span> <span class="n">meanrange</span><span class="o">=</span><span class="n">meanrange</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">datasetout</span>


    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="c1"># DataSet Coordinates/values                                                 #</span>
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="k">def</span> <span class="nf">get_xgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset x-coordinate matrix of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_ygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset y-coordinate matrix of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_ygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset x- and y-coordinate matrices of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_grid_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">z_image</span>


    <span class="k">def</span> <span class="nf">get_gridcorners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset grid corners coordinates.</span>

<span class="sd">        Returns ``None`` if no interpolation was made.</span>
<span class="sd">        Use :meth:~geophpy.dataset.DataSet.get_boundingbox`</span>
<span class="sd">        to get the ungridded data values&#39; bounding box.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_gridcorners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_gridextent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset grid extent. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_gridextent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xvect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset x-coordinate vector of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xvect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_yvect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset y-coordinate vector of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_yvect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xyvect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return dataset x- and y-coordinate vectors of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xyvect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the x-coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_yvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the y-coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_yvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xyvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the x- and y-coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xyvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_xyzvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return both the x, y-coordinates and dataset ungridded values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_xyzvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_boundingbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the coordinates (BL, BR, TL, TR) of the box bouding the data values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_boundingbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_median_xstep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the median step between two distinct x values rounded to the given precision. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_median_xstep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_median_ystep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the median step between two distinct y values rounded to the given precision. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_median_ystep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_median_xystep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_prec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the median steps between two distinct x and y values rounded to the given precisions. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_median_xystep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_prec</span><span class="o">=</span><span class="n">x_prec</span><span class="p">,</span> <span class="n">y_prec</span><span class="o">=</span><span class="n">y_prec</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_georef_xvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the easting coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting</span>


    <span class="k">def</span> <span class="nf">get_georef_yvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the northing coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing</span>


    <span class="k">def</span> <span class="nf">get_georef_xyvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the easting and northing coordinates from the dataset values. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing</span>


    <span class="k">def</span> <span class="nf">get_georef_xgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the easting coordinates matrices of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span>


    <span class="k">def</span> <span class="nf">get_georef_ygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the northing coordinates matrices of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span>


    <span class="k">def</span> <span class="nf">get_georef_xygrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return the easting and northing coordinates matrices of the Z_image. &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span>

    <span class="k">def</span> <span class="nf">get_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Return the dataset attribtue corresponding to the track number. &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="n">genop</span><span class="o">.</span><span class="n">get_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>

    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="c1"># DataSet Geopositioning                                                    #</span>
    <span class="c1"># ---------------------------------------------------------------------------#</span>
    <span class="k">def</span> <span class="nf">to_kml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plottype</span><span class="p">,</span> <span class="n">cmapname</span><span class="p">,</span> <span class="n">kmlfilename</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">picturefilename</span><span class="o">=</span><span class="s2">&quot;image.png&quot;</span><span class="p">,</span> <span class="n">cmmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot in 2D dimensions the cartography representation to export in google earth.</span>

<span class="sd">        Parameters :</span>

<span class="sd">        :plottype: plotting type, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, ...xyz</span>

<span class="sd">        :cmapname: name of the color map used.</span>

<span class="sd">        :kmlfilename: name of the kml file to create</span>

<span class="sd">        :creversed: True to add &#39;_r&#39; at the cmname to reverse the color map</span>

<span class="sd">        :picturefilename: name of the picture file to save, None if no file to save.</span>

<span class="sd">        :cmmin: minimal value to display in the color map range.</span>

<span class="sd">        :cmmax: maximal value to display in the color map range.</span>

<span class="sd">        :interpolation: interpolation mode to display DataSet Image (&#39;bilinear&#39;, &#39;nearest&#39;, &#39;bicubic&#39;), &#39;bilinear&#39; by default.</span>

<span class="sd">        :cmapdisplay: True to display color map bar, False to hide the color map bar.</span>

<span class="sd">        :axisdisplay: True to display axis and labels, False to hide axis and labels</span>

<span class="sd">        :dpi: &#39;dot per inch&#39; definition of the picture file if filename != None</span>

<span class="sd">        Returns:</span>

<span class="sd">        :success: True if success, False if not.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># calculation of the 4 points utm coordinates</span>
        <span class="n">success</span><span class="p">,</span> <span class="p">[</span><span class="n">blcorner</span><span class="p">,</span> <span class="n">brcorner</span><span class="p">,</span> <span class="n">urcorner</span><span class="p">,</span> <span class="n">ulcorner</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getquadcoords</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># utm to wgs84 conversion</span>
            <span class="n">blcorner_wgs84_lat</span><span class="p">,</span> <span class="n">blcorner_wgs84_lon</span> <span class="o">=</span> <span class="n">geopos</span><span class="o">.</span><span class="n">utm_to_wgs84</span><span class="p">(</span><span class="n">blcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">blcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zonenumber</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zoneletter</span><span class="p">)</span>
            <span class="n">brcorner_wgs84_lat</span><span class="p">,</span> <span class="n">brcorner_wgs84_lon</span> <span class="o">=</span> <span class="n">geopos</span><span class="o">.</span><span class="n">utm_to_wgs84</span><span class="p">(</span><span class="n">brcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">brcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zonenumber</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zoneletter</span><span class="p">)</span>
            <span class="n">urcorner_wgs84_lat</span><span class="p">,</span> <span class="n">urcorner_wgs84_lon</span> <span class="o">=</span> <span class="n">geopos</span><span class="o">.</span><span class="n">utm_to_wgs84</span><span class="p">(</span><span class="n">urcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">urcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zonenumber</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zoneletter</span><span class="p">)</span>
            <span class="n">ulcorner_wgs84_lat</span><span class="p">,</span> <span class="n">ulcorner_wgs84_lon</span> <span class="o">=</span> <span class="n">geopos</span><span class="o">.</span><span class="n">utm_to_wgs84</span><span class="p">(</span><span class="n">ulcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">ulcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zonenumber</span><span class="p">,</span>
                                                                         <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">utm_zoneletter</span><span class="p">)</span>

            <span class="n">quadcoords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">blcorner_wgs84_lon</span><span class="p">,</span> <span class="n">blcorner_wgs84_lat</span><span class="p">),</span> <span class="p">(</span><span class="n">brcorner_wgs84_lon</span><span class="p">,</span> <span class="n">brcorner_wgs84_lat</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">urcorner_wgs84_lon</span><span class="p">,</span> <span class="n">urcorner_wgs84_lat</span><span class="p">),</span> <span class="p">(</span><span class="n">ulcorner_wgs84_lon</span><span class="p">,</span> <span class="n">ulcorner_wgs84_lat</span><span class="p">)]</span>

            <span class="c1"># creation of the picture file to overlay</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plottype</span><span class="p">,</span> <span class="n">cmapname</span><span class="p">,</span> <span class="n">creversed</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">picturefilename</span><span class="p">,</span> <span class="n">cmmin</span><span class="o">=</span><span class="n">cmmin</span><span class="p">,</span> <span class="n">cmmax</span><span class="o">=</span><span class="n">cmmax</span><span class="p">,</span>
                      <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># creation of the kml file</span>
            <span class="n">kml</span><span class="o">.</span><span class="n">picture_to_kml</span><span class="p">(</span><span class="n">picturefilename</span><span class="p">,</span> <span class="n">quadcoords</span><span class="p">,</span> <span class="n">kmlfilename</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">success</span>


    <span class="k">def</span> <span class="nf">to_raster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plottype</span><span class="p">,</span> <span class="n">cmapname</span><span class="p">,</span> <span class="n">picturefilename</span><span class="p">,</span> <span class="n">creversed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot in 2D dimensions the cartography representation with the world file associated, to using in a SIG application.</span>

<span class="sd">        Parameters:</span>

<span class="sd">        :plottype: plotting type, &#39;2D-SURFACE&#39;, &#39;2D-CONTOUR&#39;, ...xyz</span>

<span class="sd">        :cmapname: name of the color map used.</span>

<span class="sd">        :picturefilename: name of the picture file to save (.jpg, .jpeg, .tif, .tiff, .png) , None if no file to save.</span>

<span class="sd">        :creversed: True to add &#39;_r&#39; at the cmname to reverse the color map</span>

<span class="sd">        :cmmin: minimal value to display in the color map range.</span>

<span class="sd">        :cmmax: maximal value to display in the color map range.</span>

<span class="sd">        :interpolation: interpolation mode to display DataSet Image (&#39;bilinear&#39;, &#39;nearest&#39;, &#39;bicubic&#39;), &#39;bilinear&#39; by default.</span>

<span class="sd">        :dpi: &#39;dot per inch&#39; definition of the picture file</span>

<span class="sd">        Returns:</span>

<span class="sd">        :success: True if success, False if not.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># calculation of the 4 points utm coordinates</span>
        <span class="n">success</span><span class="p">,</span> <span class="p">[</span><span class="n">blcorner</span><span class="p">,</span> <span class="n">brcorner</span><span class="p">,</span> <span class="n">urcorner</span><span class="p">,</span> <span class="n">ulcorner</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getquadcoords</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># tests if picture format available for raster</span>
            <span class="n">success</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">israsterformat</span><span class="p">(</span><span class="n">picturefilename</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                <span class="n">quadcoords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">blcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">blcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">),</span> <span class="p">(</span><span class="n">brcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">brcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">urcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">urcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">),</span> <span class="p">(</span><span class="n">ulcorner</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">ulcorner</span><span class="o">.</span><span class="n">utm_northing</span><span class="p">)]</span>

                <span class="c1"># creation of the picture file to overlay</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plottype</span><span class="p">,</span> <span class="n">cmapname</span><span class="p">,</span> <span class="n">creversed</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">picturefilename</span><span class="p">,</span> <span class="n">cmmin</span><span class="o">=</span><span class="n">cmmin</span><span class="p">,</span> <span class="n">cmmax</span><span class="o">=</span><span class="n">cmmax</span><span class="p">,</span>
                          <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span> <span class="n">cmapdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axisdisplay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="c1"># creation of the world file</span>
                <span class="n">success</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">picture_to_worldfile</span><span class="p">(</span><span class="n">picturefilename</span><span class="p">,</span> <span class="n">quadcoords</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">success</span>


    <span class="k">def</span> <span class="nf">setgeoref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refsystem</span><span class="p">,</span> <span class="n">points_list</span><span class="p">,</span> <span class="n">utm_zoneletter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">utm_zonenumber</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valfilt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Georeferencing dataset using 2-D linear interpolation.</span>

<span class="sd">        Dataset is georeferenced using a list of Ground Control Points (GCPs).</span>
<span class="sd">        The geographic positions are linearly interpolated in 2-D at the dataset position.</span>

<span class="sd">        As no extrapolation is available yet, there must GCPs that spatially includes</span>
<span class="sd">        the dataset positions (typically grid nodes).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        refsystem : str or None</span>
<span class="sd">            Geographic reference system (&#39;UTM&#39;, &#39;WGS84&#39;, ...) or pyproj crs string (&#39;EPSG:4326&#39;).</span>

<span class="sd">        points_list : list</span>
<span class="sd">            List of GCPs points. ex:</span>
<span class="sd">            [[num1, lat1, lon1, x1, y1], ..., [numN, latN, lonN, xN, yN]].</span>

<span class="sd">        utm_zoneletter : str or None</span>
<span class="sd">          UTM zone letter if `refsystem` is &#39;UTM&#39;.</span>

<span class="sd">        utm_zonenumber : int or None</span>
<span class="sd">            UTM zone number if `refsystem` is &#39;UTM&#39;.</span>

<span class="sd">        valfilt : bool</span>
<span class="sd">            If True, the ungridded dataset value (class:`~values`) are used instead</span>
<span class="sd">            of the gridded (class:`~z_images`).</span>
<span class="sd">            Then, the georeferenced coordinates will be stored in :obj:`eatsing` and :obj:`northing`</span>
<span class="sd">            instead of :obj:`easting_image` and :obj:`northing_image`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        error : {0, -1, -2}</span>
<span class="sd">            Error code.</span>
<span class="sd">            0 if no error occured.</span>
<span class="sd">            -1 if there are not enough points.</span>
<span class="sd">            -2 if an error occured during georeferenincg,</span>
<span class="sd">            probably the dataset are unconsistent with the GCPs area.</span>

<span class="sd">        Georeferenced dataset object</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">gengeopositioning</span><span class="o">.</span><span class="n">setgeoref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">refsystem</span><span class="p">,</span> <span class="n">points_list</span><span class="p">,</span>
                                           <span class="n">utm_zoneletter</span><span class="o">=</span><span class="n">utm_zoneletter</span><span class="p">,</span>
                                           <span class="n">utm_zonenumber</span><span class="o">=</span><span class="n">utm_zonenumber</span><span class="p">,</span>
                                           <span class="n">valfilt</span><span class="o">=</span><span class="n">valfilt</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">getquadcoords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the utm coordinates of the DataSet Image corners.</span>

<span class="sd">        Returns:</span>

<span class="sd">        :success: True if coordinates getted, False if not</span>

<span class="sd">        :bottomleft: utm coordinates of the bottom left corner</span>

<span class="sd">        :bottomright: utm coordinates of the bottom right corner</span>

<span class="sd">        :upright: utm coordinates of the up right corner</span>

<span class="sd">        :upleft: utm coordinates of the up left corner</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bottomleft</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">bottomright</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">upright</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">upleft</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">active</span><span class="p">:</span>
            <span class="n">bottomleft</span> <span class="o">=</span> <span class="n">GeoRefPoint</span><span class="p">()</span>
            <span class="n">bottomright</span> <span class="o">=</span> <span class="n">GeoRefPoint</span><span class="p">()</span>
            <span class="n">upright</span> <span class="o">=</span> <span class="n">GeoRefPoint</span><span class="p">()</span>
            <span class="n">upleft</span> <span class="o">=</span> <span class="n">GeoRefPoint</span><span class="p">()</span>
            <span class="n">bottomleft</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">bottomleft</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">bottomright</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">bottomright</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span>
                <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">upleft</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">upleft</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">upright</span><span class="o">.</span><span class="n">utm_easting</span><span class="p">,</span> <span class="n">upright</span><span class="o">.</span><span class="n">utm_northing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">easting_image</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">northing_image</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">active</span><span class="p">,</span> <span class="p">[</span><span class="n">bottomleft</span><span class="p">,</span> <span class="n">bottomright</span><span class="p">,</span> <span class="n">upright</span><span class="p">,</span> <span class="n">upleft</span><span class="p">]</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2019, Lionel Darras, Quentin Vitale

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>