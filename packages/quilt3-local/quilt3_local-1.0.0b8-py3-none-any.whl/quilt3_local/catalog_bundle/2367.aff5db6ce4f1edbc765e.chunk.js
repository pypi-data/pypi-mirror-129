"use strict";(self.webpackChunkquilt_navigator=self.webpackChunkquilt_navigator||[]).push([[2367],{82367:(e,t,n)=>{n.r(t),n.d(t,{default:()=>kt});var r=n(70655),a=n(67294),l=n(73727),u=n(5977),o=n(41120),c=n(41423),i=n(8920),s=n(63457),m=n(14096),d=n(57156),p=n(69534),v=n(54862),h=n(33287),E=n(50843),f=n(97716),g=n(282),y=n(22318),Z=n(30585),k=n(10770),b=n(66869),x=n(37155),N=n(41810),w=n(23307),S=n(43987),q=n(92816),C=n(79895),Q=n(64436),L=n(26209),M=n(85639),D=n(95757),A=o.Z((function(e){return{header:{margin:e.spacing(0,0,1)},selectWrapper:{width:"100%"},select:{padding:e.spacing(1)}}})),W="load-more";function I(e){var t=e.queries,n=e.onChange,r=e.onLoadMore,l=e.value,u=A(),o=a.useCallback((function(e){e.target.value===W&&r?r():n(t.find((function(t){return t.key===e.target.value}))||null)}),[t,n,r]);return a.createElement(C.Z,null,a.createElement(Q.Z,{className:u.selectWrapper},a.createElement(L.Z,{classes:{root:u.select},disabled:!t.length,onChange:o,value:l?l.key:"none"},a.createElement(M.Z,{disabled:!0,value:"none"},a.createElement(D.Z,null,"Custom")),t.map((function(e){return a.createElement(M.Z,{key:e.key,value:e.key},a.createElement(D.Z,{primary:e.name,secondary:e.description}))})),!!r&&a.createElement(M.Z,{key:W,value:W},a.createElement(D.Z,null,a.createElement("em",null,"Load more"))))))}var _=n(80679),B=n(84268),z=n(33129);function T(e){return{body:e.QueryString,description:e.Description,key:e.NamedQueryId,name:e.Name}}function P(e){var t=e.athena,n=e.prev,a=e.workgroup;return(0,r.mG)(this,void 0,Promise,(function(){var e,l,u,o;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,null==t?void 0:t.listNamedQueries({WorkGroup:a,NextToken:null==n?void 0:n.next}).promise()];case 1:return(e=r.sent()).NamedQueryIds&&e.NamedQueryIds.length?[4,null==t?void 0:t.batchGetNamedQuery({NamedQueryIds:e.NamedQueryIds}).promise()]:[2,{list:(null==n?void 0:n.list)||[],next:e.NextToken}];case 2:return l=r.sent(),u=(l.NamedQueries||[]).map(T),[2,{list:((null==n?void 0:n.list)||[]).concat(u),next:e.NextToken}];case 3:throw o=r.sent(),console.log("Unable to fetch"),console.error(o),o;case 4:return[2]}}))}))}function R(e){var t=e.athena,n=e.prev;return(0,r.mG)(this,void 0,Promise,(function(){var e,a,l,u;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.listWorkGroups({NextToken:null==n?void 0:n.next}).promise()];case 1:return e=r.sent(),a=(e.WorkGroups||[]).map((function(e){return e.Name||"Unknown"})),[2,{defaultWorkgroup:(l=((null==n?void 0:n.list)||[]).concat(a))[0],list:l,next:e.NextToken}];case 2:throw u=r.sent(),console.log("Unable to fetch"),console.error(u),u;case 3:return[2]}}))}))}function F(e){var t,n,r,a,l,u;return{catalog:null===(t=null==e?void 0:e.QueryExecutionContext)||void 0===t?void 0:t.Catalog,completed:null===(n=null==e?void 0:e.Status)||void 0===n?void 0:n.CompletionDateTime,created:null===(r=null==e?void 0:e.Status)||void 0===r?void 0:r.SubmissionDateTime,db:null===(a=null==e?void 0:e.QueryExecutionContext)||void 0===a?void 0:a.Database,id:null==e?void 0:e.QueryExecutionId,outputBucket:null===(l=null==e?void 0:e.ResultConfiguration)||void 0===l?void 0:l.OutputLocation,query:null==e?void 0:e.Query,status:null===(u=null==e?void 0:e.Status)||void 0===u?void 0:u.State,workgroup:null==e?void 0:e.WorkGroup}}function G(e){var t=e.athena,n=e.prev,a=e.workgroup;return(0,r.mG)(this,void 0,Promise,(function(){var e,l,u,o,c;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,t.listQueryExecutions({WorkGroup:a,NextToken:null==n?void 0:n.next}).promise()];case 1:return e=r.sent(),(l=e.QueryExecutionIds)&&l.length?[4,null==t?void 0:t.batchGetQueryExecution({QueryExecutionIds:l}).promise()]:[2,{list:[],next:e.NextToken}];case 2:return u=r.sent(),o=(u.QueryExecutions||[]).map(F),[2,{list:((null==n?void 0:n.list)||[]).concat(o),next:e.NextToken}];case 3:throw c=r.sent(),console.log("Unable to fetch"),console.error(c),c;case 4:return[2]}}))}))}function O(e,t){var n,a;return(0,r.mG)(this,void 0,Promise,(function(){var l,u;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,e.getQueryExecution({QueryExecutionId:t}).promise()];case 1:if(l=r.sent(),"FAILED"===(u=null===(a=null===(n=null==l?void 0:l.QueryExecution)||void 0===n?void 0:n.Status)||void 0===a?void 0:a.State)||"CANCELLED"===u)throw new Error(u);if(!u)throw new Error("Unknown query execution status");return"SUCCEEDED"===u?[2,(null==l?void 0:l.QueryExecution)||null]:[4,(0,z.Z)(1e3)];case 2:return r.sent(),[3,0];case 3:return[2]}}))}))}function H(e){var t,n=e.athena,a=e.queryExecutionId,l=e.prev;return(0,r.mG)(this,void 0,Promise,(function(){var e,u,o;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return[4,O(n,a)];case 1:return e=r.sent(),[4,n.getQueryResults({QueryExecutionId:a,NextToken:null==l?void 0:l.next}).promise()];case 2:return u=r.sent(),o=(null===(t=u.ResultSet)||void 0===t?void 0:t.Rows)||[],[2,{list:((null==l?void 0:l.list)||[]).concat(o),next:u.NextToken,queryExecution:e?F(e):null}]}}))}))}function J(e,t){return(0,r.mG)(this,void 0,Promise,(function(){var n,a,l,u;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return n=(t+e).trim().replace(/\s+/g," "),a=(new TextEncoder).encode(n),[4,crypto.subtle.digest("SHA-256",a)];case 1:return l=r.sent(),u=Array.from(new Uint8Array(l)),[2,u.map((function(e){return e.toString(16).padStart(2,"0")})).join("")]}}))}))}function U(e){var t=e.athena,n=e.queryBody,a=e.workgroup;return(0,r.mG)(this,void 0,Promise,(function(){var e,l,u;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,J(n,a)];case 1:return e=r.sent(),[4,t.startQueryExecution({ClientRequestToken:e,QueryString:n,ResultConfiguration:{EncryptionConfiguration:{EncryptionOption:"SSE_S3"}},WorkGroup:a}).promise()];case 2:if(!(l=r.sent().QueryExecutionId))throw new Error("No execution id");return[2,{id:l}];case 3:throw u=r.sent(),console.log("Unable to fetch"),console.error(u),u;case 4:return[2]}}))}))}var j=n(10180),V=n(73206),$=n(45677),K=n(65060);function X(e){return t=e,j.Z(Object,t)&&j.Z(Object,t.queries)?Object.entries(e.queries).map((function(e){var t=e[0],n=e[1];return(0,r.pi)((0,r.pi)({},n),{key:t})})):[];var t}var Y=function(e){var t=e.s3,n=e.bucket;return(0,r.mG)(void 0,void 0,Promise,(function(){var e,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,$.dc({s3:t,bucket:n,path:".quilt/queries/config.yaml"})];case 1:return e=r.sent(),[2,X((0,K.Z)(e.Body.toString("utf-8")))];case 2:if((a=r.sent())instanceof V.s0||a instanceof V.V2)return[2,[]];throw console.log("Unable to fetch"),console.error(a),a;case 3:return[2]}}))}))};var ee=n(36473),te=function(e){var t=e.s3,n=e.queryUrl;return(0,r.mG)(void 0,void 0,Promise,(function(){var e,a,l,u,o,c;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:e=ee.UD(n),a=e.bucket,l=e.key,u=e.version,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,$.dc({s3:t,bucket:a,path:l,version:u})];case 2:return o=r.sent(),[2,JSON.parse(o.Body.toString("utf-8"))];case 3:if((c=r.sent())instanceof V.s0||c instanceof V.V2)return[2,null];throw console.log("Unable to fetch"),console.error(c),c;case 4:return[2]}}))}))};function ne(e){var t=_.S3.use();return(0,B.et)(te,{s3:t,queryUrl:e},{noAutoFetch:!e})}var re=n(46974),ae=n(57996);function le(e){var t=e.req,n=e.query;return(0,r.mG)(this,void 0,Promise,(function(){var e,a;return(0,r.Jh)(this,(function(r){try{if("string"==typeof n||!n)throw new Error("Query is incorrect");return e={index:n.index,filter_path:n.filter_path,action:"freeform",body:JSON.stringify(n.body)},n.size&&(e.size=n.size),n.from&&(e.from=n.size),a=(0,ae.Z)(e),[2,t("/search"+a)]}catch(e){if(e instanceof V.s0||e instanceof V.V2)return[2,null];throw console.log("Unable to fetch"),console.error(e),e}return[2]}))}))}var ue=n(74981),oe=(n(89899),n(76381),n(70397)),ce=o.Z((function(e){return{editor:{padding:e.spacing(1)},header:{margin:e.spacing(0,0,1)}}}));function ie(e){var t=e.className,n=e.query,r=e.onChange,l=ce();return a.createElement("div",{className:t},a.createElement(y.Z,{className:l.header,variant:"body1"},"Query body"),a.createElement(C.Z,{className:l.editor},a.createElement(ue.ZP,{editorProps:{$blockScrolling:!0},height:"200px",mode:"sql",onChange:r,theme:"eclipse",value:n,width:"100%"})),a.createElement(Z.Z,null,"Quilt uses AWS Athena SQL."," ",a.createElement(oe.Z,{href:"https://aws.amazon.com/athena/",target:"_blank"},"Learn more"),"."))}var se=n(10529),me=n(56847),de=n(82302),pe=n(83750),ve=n(57394),he=n(88222),Ee=n(99613),fe=n(43031),ge=o.Z((function(e){return{footer:{display:"flex",padding:e.spacing(1)},header:{margin:e.spacing(0,0,1)},more:{marginLeft:"auto"}}}));function ye(){return a.createElement(C.Z,null,a.createElement(se.Z,{p:3,textAlign:"center"},a.createElement(y.Z,{variant:"h6"},"No results for this query"),a.createElement(y.Z,null,"Select another query execution or execute another query")))}function Ze(e){var t,n=e.results,r=n[0],l=n.slice(1),u=e.onLoadMore,o=ge(),c=a.useState(1),i=c[0],s=c[1],m=a.useCallback((function(e,t){s(t)}),[s]);if(!l.length)return a.createElement(ye,null);var d=l.slice(10*(i-1),10*i),p=l.length>d.length;return a.createElement(me.Z,{component:C.Z},a.createElement(de.Z,{size:"small"},a.createElement(pe.Z,null,a.createElement(ve.Z,null,null===(t=null==r?void 0:r.Data)||void 0===t?void 0:t.map((function(e,t){return a.createElement(he.Z,{key:t},e.VarCharValue)})))),a.createElement(Ee.Z,null,d.map((function(e,t){var n;return a.createElement(ve.Z,{key:t},null===(n=null==e?void 0:e.Data)||void 0===n?void 0:n.map((function(e,t){return a.createElement(he.Z,{key:t},e.VarCharValue)})))})))),(p||!!u)&&a.createElement("div",{className:o.footer},p&&a.createElement(fe.Z,{count:Math.ceil(l.length/10),page:i,size:"small",onChange:m}),u&&a.createElement(g.Z,{className:o.more,size:"small",onClick:u},"Load more")))}var ke=n(94184),be=n.n(ke),xe=n(90584),Ne=n(84792),we=n(66037),Se=o.Z((function(e){return{date:{whiteSpace:"nowrap"},cell:{width:"40%","& + &":{width:"auto"}},collapsedCell:{borderBottom:0},expandingCell:{paddingBottom:0,paddingTop:0},expandedQuery:{maxHeight:e.spacing(30),maxWidth:"100%",overflow:"auto",padding:e.spacing(1)}}}));function qe(e){var t,n=e.bucket,r=e.queryExecution,l=Se(),u=p.D$().urls,o=a.useState(!1),c=o[0],i=o[1],s=a.useCallback((function(){return i(!c)}),[c]),m=a.useMemo((function(){var e,t;return!r.query||r.query.length<=30?r.query:(null===(e=r.query)||void 0===e?void 0:e.substring(0,30))+" … "+(null===(t=r.query)||void 0===t?void 0:t.substr(-20))}),[r.query]),d=a.useMemo((function(){return r.completed?xe.Z(r.completed,"MMM do, HH:mm:ss"):null}),[r.completed]);return a.createElement(a.Fragment,null,a.createElement(ve.Z,null,a.createElement(he.Z,{className:l.cell,onClick:s},m),a.createElement(he.Z,{className:l.cell},a.createElement("abbr",{title:r.id},r.status)),a.createElement(he.Z,{className:be()(l.cell,l.date)},r.created?xe.Z(r.created,"MMM do, HH:mm:ss"):null),a.createElement(he.Z,{className:be()(l.cell,l.date)},"SUCCEEDED"===r.status?a.createElement(oe.Z,{to:u.bucketAthenaQueryExecution(n,r.id)},d):d)),a.createElement(ve.Z,null,a.createElement(he.Z,{colSpan:4,className:be()(l.expandingCell,(t={},t[l.collapsedCell]=!c,t))},a.createElement(we.Z,{in:c},a.createElement("pre",{className:l.expandedQuery},r.query)))))}function Ce(){return a.createElement(se.Z,{p:3,textAlign:"center"},a.createElement(y.Z,{variant:"h6"},"No executions for this workgroup"),a.createElement(y.Z,null,"Select another workgroup or execute some query"))}var Qe=o.Z((function(e){var t;return{cell:{width:"40%","& + &":{width:"auto"}},header:{margin:e.spacing(0,0,1)},footer:{display:"flex",padding:e.spacing(1)},more:{marginLeft:"auto"},table:(t={},t[e.breakpoints.down("sm")]={tableLayout:"fixed"},t)}}));function Le(e){var t=e.bucket,n=e.executions,r=e.onLoadMore,l=Qe(),u=a.useState(1),o=u[0],c=u[1],i=a.useCallback((function(e,t){c(t)}),[c]),s=a.useMemo((function(){return Ne.Z((function(e,t){return(null==t?void 0:t.completed)&&(null==e?void 0:e.completed)?t.completed.valueOf()-e.completed.valueOf():-1}),n)}),[n]),m=s.slice(10*(o-1),10*o),d=s.length>m.length;return a.createElement(me.Z,{component:C.Z},a.createElement(de.Z,{size:"small",className:l.table},a.createElement(pe.Z,null,a.createElement(ve.Z,null,a.createElement(he.Z,{className:l.cell},"Query"),a.createElement(he.Z,{className:l.cell},"Status"),a.createElement(he.Z,{className:l.cell},"Date created"),a.createElement(he.Z,{className:l.cell},"Date completed"))),a.createElement(Ee.Z,null,m.map((function(e){return a.createElement(qe,{bucket:t,queryExecution:e,key:e.id})})),!n.length&&a.createElement(ve.Z,null,a.createElement(he.Z,{colSpan:4},a.createElement(Ce,null))))),(d||!!r)&&a.createElement("div",{className:l.footer},d&&a.createElement(fe.Z,{count:Math.ceil(n.length/10),page:o,size:"small",onChange:i}),r&&a.createElement(g.Z,{className:l.more,size:"small",onClick:r},"Load more")))}var Me=o.Z((function(e){return{selectWrapper:{width:"100%"},select:{padding:e.spacing(1)}}})),De="load-more";function Ae(e){var t=e.workgroups,n=e.onChange,r=e.onLoadMore,l=e.value,u=Me(),o=a.useCallback((function(e){e.target.value===De?r(t):n(t.list.find((function(t){return t===e.target.value}))||null)}),[t,n,r]);return a.createElement(C.Z,null,a.createElement(Q.Z,{className:u.selectWrapper},a.createElement(L.Z,{classes:{root:u.select},disabled:!t.list.length,onChange:o,value:l||"none"},t.list.map((function(e){return a.createElement(M.Z,{key:e,value:e},a.createElement(D.Z,null,e))})),t.next&&a.createElement(M.Z,{key:De,value:De},a.createElement(D.Z,null,a.createElement("em",null,"Load more"))))))}function We(e){var t=e.error;return a.createElement(a.Fragment,null,t?a.createElement(Te,{title:t.name,error:t}):a.createElement(b.Z,{severity:"info"},a.createElement(x.Z,null,"No workgroups configured")))}function Ie(){return a.createElement(a.Fragment,null,a.createElement(w.Z,{height:24,width:128,animate:!0}),a.createElement(w.Z,{height:48,mt:1,animate:!0}))}var _e=o.Z((function(e){return{button:{height:e.spacing(4),marginTop:e.spacing(2),width:e.spacing(14)},canvas:{flexGrow:1,height:e.spacing(27),marginLeft:e.spacing(1)},editor:{display:"flex",marginTop:e.spacing(1)},helper:{height:e.spacing(2),marginTop:e.spacing(1)},numbers:{height:e.spacing(27),width:e.spacing(5)},title:{height:e.spacing(3),width:e.spacing(16)}}}));function Be(){var e=_e();return a.createElement(a.Fragment,null,a.createElement(w.Z,{className:e.title,animate:!0}),a.createElement("div",{className:e.editor},a.createElement(w.Z,{className:e.numbers,animate:!0}),a.createElement(w.Z,{className:e.canvas,animate:!0})),a.createElement(w.Z,{className:e.helper,animate:!0}),a.createElement(w.Z,{className:e.button,animate:!0}))}function ze(e){var t=e.size;return a.createElement(a.Fragment,null,a.createElement(w.Z,{height:36,animate:!0}),v.Z(0,t).map((function(e){return a.createElement(w.Z,{key:e,height:36,mt:1,animate:!0})})))}function Te(e){var t=e.error,n=e.title,r=q.D$();return a.useEffect((function(){r("captureException",t)}),[t,r]),a.createElement(b.Z,{severity:"error"},a.createElement(x.Z,null,n),t.message)}function Pe(e){return function(t){return a.createElement(Te,{error:t,title:e})}}var Re=o.Z((function(e){return{emptySelect:{margin:e.spacing(5.5,0,0)},form:{margin:e.spacing(0,0,4)},results:{margin:e.spacing(4,0,0)},sectionHeader:{margin:e.spacing(0,0,1)},select:{flexBasis:"40%","& + &":{flexBasis:"60%",marginLeft:e.spacing(3),marginBottom:e.spacing(-3)}},selects:{display:"flex",margin:e.spacing(3,0)}}})),Fe=o.Z((function(e){return{actions:{margin:e.spacing(2,0)},error:{margin:e.spacing(1,0,0)},viewer:{margin:e.spacing(3,0,0)}}}));function Ge(e){var t=e.disabled,n=e.error,r=e.value,l=e.onChange,u=e.onSubmit,o=Fe(),c=a.useMemo((function(){return u(r||"")}),[u,r]);return a.createElement("div",null,a.createElement(ie,{className:o.viewer,onChange:l,query:r||""}),n&&a.createElement(b.Z,{className:o.error,severity:"error"},n.message),a.createElement("div",{className:o.actions},a.createElement(g.Z,{variant:"contained",color:"primary",disabled:t,onClick:c},"Run query")))}function Oe(e){var t=e.children,n=e.queryBody,r=function(e,t){var n=_.tr.use();return(0,B.et)(U,{athena:n,queryBody:t,workgroup:e},{noAutoFetch:!t})}(e.workgroup,n);return t({queryRunData:r})}function He(e){var t=e.children,n=e.queryExecutionId,r=a.useState(null),l=r[0],u=r[1],o=function(e,t){var n=_.tr.use();return(0,B.et)(H,{athena:n,prev:t,queryExecutionId:e},{noAutoFetch:!e})}(n,l);return t({queryResultsData:o,handleQueryResultsLoadMore:u})}function Je(e){var t=e.children,n=e.workgroup,r=a.useState(null),l=r[0],u=r[1],o=a.useState(null),c=o[0],i=o[1],s=function(e,t){var n=_.tr.use();return(0,B.et)(P,{athena:n,prev:t,workgroup:e},{noAutoFetch:!e})}(n,l),m=function(e,t){var n=_.tr.use();return(0,B.et)(G,{athena:n,prev:t,workgroup:e},{noAutoFetch:!e})}(n,c);return t({executionsData:m,handleExecutionsLoadMore:i,handleQueriesLoadMore:u,queriesData:s})}function Ue(e){var t=e.children,n=a.useState(null),r=n[0],l=n[1],u=function(e){var t=_.tr.use();return(0,B.et)(R,{athena:t,prev:e})}(r);return t({handleWorkgroupsLoadMore:l,workgroupsData:u})}function je(e){var t=e.children,n=e.queryExecutionId,r=a.useState(null),l=r[0],u=r[1],o=a.useState(null),c=o[0],i=o[1],s=a.useCallback((function(e){u(e),i(null)}),[u,i]),m=a.useState(null),d=m[0],p=m[1],v=a.useMemo((function(){return function(e){return function(){return p(e)}}}),[p]);a.useEffect((function(){p(null)}),[n]);var h=a.useState(null),E=h[0],f=h[1],g=a.useCallback((function(e){f(e),u(null)}),[u,f]);return a.createElement(Ue,null,(function(e){var r=e.handleWorkgroupsLoadMore,u=e.workgroupsData;return u.case({_:function(e){var o,m;return S.Z.Init.is(e)||S.Z.Pending.is(e)||(null===(m=null===(o=e.value)||void 0===o?void 0:o.list)||void 0===m?void 0:m.length)?a.createElement(He,{queryExecutionId:n},(function(o){var m,p=o.queryResultsData,h=o.handleQueryResultsLoadMore,f=p.case({_:function(){return null},Ok:function(e){return e.queryExecution}}),y=E||(null==f?void 0:f.workgroup)||(null===(m=e.value)||void 0===m?void 0:m.defaultWorkgroup)||"";return a.createElement(Je,{workgroup:y,key:n},(function(e){var n=e.queriesData,o=e.executionsData,m=e.handleQueriesLoadMore,E=e.handleExecutionsLoadMore;return a.createElement(Oe,{queryBody:d||"",workgroup:y},(function(e){var a=e.queryRunData;return t({customQueryBody:c,executionsData:o,handleExecutionsLoadMore:E,handleQueriesLoadMore:m,handleQueryBodyChange:i,handleQueryMetaChange:s,handleQueryResultsLoadMore:h,handleSubmit:v,handleWorkgroupChange:g,handleWorkgroupsLoadMore:r,queriesData:n,queryMeta:l,queryResultsData:p,queryRunData:a,workgroupsData:u,workgroup:y})}))}))})):a.createElement(We,null)},Err:function(e){return a.createElement(We,{error:e})}})}))}var Ve=function(e,t,n){return!!n||!e||!!t.case({Pending:h.Z,_:E.Z})};function $e(e){var t=e.match.params,n=t.bucket,r=t.queryExecutionId,o=Re(),c=p.D$().urls;return a.createElement(je,{queryExecutionId:r||null},(function(e){var t=e.customQueryBody,i=e.executionsData,s=e.handleExecutionsLoadMore,m=e.handleQueriesLoadMore,d=e.handleQueryBodyChange,p=e.handleQueryMetaChange,v=e.handleQueryResultsLoadMore,g=e.handleSubmit,b=e.handleWorkgroupChange,x=e.handleWorkgroupsLoadMore,w=e.queriesData,S=e.queryMeta,q=e.queryResultsData,C=e.queryRunData,Q=e.workgroupsData,L=e.workgroup;return C.case({Ok:function(e){var t=e.id;return a.createElement(u.l_,{to:c.bucketAthenaQueryExecution(n,t)})},_:function(){return a.createElement(a.Fragment,null,a.createElement(y.Z,{variant:"h6"},"Athena SQL"),a.createElement("div",{className:o.selects},a.createElement("div",{className:o.select},Q.case({Ok:function(e){return a.createElement(a.Fragment,null,a.createElement(y.Z,{className:o.sectionHeader},"Select workgroup"),e.list.length?a.createElement(Ae,{workgroups:e,onChange:b,onLoadMore:x,value:L}):a.createElement(Z.Z,null,"There are no workgroups."))},Err:Pe("Workgroups Data"),_:function(){return a.createElement(Ie,null)}})),a.createElement("div",{className:o.select},w.case({Ok:function(e){return e.list.length?a.createElement(a.Fragment,null,a.createElement(y.Z,{className:o.sectionHeader,variant:"body1"},"Select query"),a.createElement(I,{queries:e.list,onChange:p,value:t?null:S,onLoadMore:e.next?function(){return m(e)}:void 0})):a.createElement(y.Z,{className:o.emptySelect,variant:"body1"},"There are no saved queries.")},Err:Pe("Select query"),_:function(){return a.createElement(Ie,null)}}))),a.createElement("div",{className:o.form},q.case({_:function(e){var n,r,l=e.value;return w.case({Ok:h.Z,_:E.Z})?a.createElement(Ge,{disabled:Ve(t||(null===(n=null==l?void 0:l.queryExecution)||void 0===n?void 0:n.query)||(null==S?void 0:S.body)||"",C,null),onChange:d,onSubmit:g,error:C.case({Err:f.Z,_:function(){}}),value:t||(null===(r=null==l?void 0:l.queryExecution)||void 0===r?void 0:r.query)||(null==S?void 0:S.body)||""}):a.createElement(Be,null)},Err:Pe("Query Body"),Pending:function(){return a.createElement(Be,null)}})),a.createElement("div",null,r?a.createElement(k.Z,{className:o.sectionHeader},a.createElement(l.Link,{to:c.bucketAthenaQueries(n)},"Query Executions"),a.createElement(y.Z,{color:"textPrimary"},"Results for ",a.createElement(N.Z,null,r))):a.createElement(y.Z,{className:o.sectionHeader,color:"textPrimary"},"Query Executions"),!r&&i.case({Ok:function(e){return a.createElement(Le,{bucket:n,executions:e.list,onLoadMore:e.next?function(){return s(e)}:void 0})},Err:Pe("Executions Data"),_:function(){return a.createElement(ze,{size:4})}})),q.case({Init:function(){return null},Ok:function(e){return e.list.length?a.createElement(Ze,{results:e.list,onLoadMore:e.next?function(){return v(e)}:void 0}):e.queryExecution?a.createElement(Le,{bucket:n,executions:[e.queryExecution]}):Pe("Query Results Data")(new Error("Couldn't fetch query results"))},Err:Pe("Query Results Data"),_:function(){return a.createElement(ze,{size:10})}}))}})}))}var Ke=n(95477),Xe=n(74391),Ye=o.Z((function(e){return{content:{margin:e.spacing(1,0,0),maxWidth:"100%",padding:e.spacing(3,4,4)}}}));function et(e){var t=e.results,n=Ye();return a.createElement("div",null,a.createElement(y.Z,{variant:"body1"},"Search results"),a.createElement(C.Z,{className:n.content},a.createElement(Xe.Z,{className:"",value:t,name:void 0,topLevel:!0,defaultExpanded:!0})))}var tt=n(1581),nt=n.n(tt),rt=n(38616),at=n.n(rt),lt=n(14596);n(58750),n(91730),n(80400);const ut=JSON.parse('{"type":"object","properties":{"body":{"type":"object"},"filter_path":{"type":"string"},"from":{"type":"number"},"index":{"type":"string"},"size":{"type":"number"}},"required":["body","index"],"additionalProperties":false}');var ot=new(nt())({allErrors:!0,verbose:!0}),ct=o.Z((function(e){return{editor:{padding:e.spacing(1),"& .jsoneditor":{border:0}},header:{margin:e.spacing(0,0,1)}}}));function it(e){var t=e.className,n=e.query,r=e.onChange,l=e.onError,u=ct(),o=i.Z(),c=a.useState(null),s=c[0],m=c[1],d=a.useCallback((function(e){r(e)}),[r]),p=a.useCallback((function(e){m(e),l(e)}),[l,m]),v=a.useCallback((function(e){l(e&&e.length?e[0]:null)}),[l]),h=a.useMemo((function(){return{style:{height:o.spacing(30)}}}),[o]);return n?a.createElement("div",{className:t},a.createElement(y.Z,{className:u.header,variant:"body1"},"Query body"),a.createElement(C.Z,{className:u.editor},a.createElement(lt.A,{ace:at(),ajv:ot,htmlElementProps:h,mainMenuBar:!1,mode:"code",navigationBar:!1,onChange:d,onError:p,onValidationError:v,schema:ut,search:!1,statusBar:!1,theme:"ace/theme/eclipse",value:n}),s&&a.createElement(b.Z,{key:s.message,severity:"error"},s.message)),a.createElement(Z.Z,null,"Quilt uses ElasticSearch 6.7 Search API."," ",a.createElement(oe.Z,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.7/search.html",target:"_blank"},"Learn more"),".")):null}var st=o.Z((function(e){return{actions:{margin:e.spacing(2,0)},container:{display:"flex",padding:e.spacing(3)},inner:{margin:e.spacing(2,0,0)},form:{margin:e.spacing(0,0,4)},sectionHeader:{margin:e.spacing(0,0,1)},select:{margin:e.spacing(3,0)},viewer:{margin:e.spacing(3,0)}}}));function mt(e){var t=e.children,n=function(e){var t=re.D$();return(0,B.et)(le,{req:t,query:e},{noAutoFetch:!e})}(e.queryBody);return t(n)}function dt(e){var t=e.children,n=e.query;return t(ne(n?n.url:""))}function pt(e){var t=e.bucket,n=e.children,r=st(),l=function(e){var t=_.S3.use();return(0,B.et)(Y,{s3:t,bucket:e})}(t),u=a.useState(null),o=u[0],c=u[1],i=a.useState(null),s=i[0],m=i[1],d=a.useState(null),p=d[0],v=d[1],h=a.useState(null),E=h[0],f=h[1],g=a.useMemo((function(){return function(e){return function(){return v(e)}}}),[v]),y=a.useCallback((function(e){c(e),m(null)}),[]);return l.case({Ok:function(e){return a.createElement(dt,{query:o||e[0]},(function(t){return a.createElement(mt,{queryBody:p},(function(r){return n({customQueryBody:s,error:E,handleError:f,handleQueryBodyChange:m,handleQueryMetaChange:y,handleSubmit:g,queries:e,queryData:t,queryMeta:o||e[0],resultsData:r})}))}))},Err:function(e){return a.createElement("div",{className:r.container},a.createElement(b.Z,{severity:"error"},e.message))},_:function(){return a.createElement("div",{className:r.container},a.createElement(Ke.Z,{size:48}))}})}function vt(e){var t=e.disabled,n=e.value,r=e.onChange,l=e.onError,u=e.onSubmit,o=st();return a.createElement("div",{className:o.form},a.createElement(it,{query:n,className:o.viewer,onChange:r,onError:l}),a.createElement("div",{className:o.actions},a.createElement(g.Z,{variant:"contained",color:"primary",disabled:t,onClick:u(n)},"Run query")))}var ht={body:{query:{query_string:{query:"test"}}},filter_path:"hits.hits._source.key",index:"_all",size:10},Et=function(e,t,n){return!!n||!e||!!t.case({Pending:h.Z,_:E.Z})};function ft(e){var t=e.match.params.bucket,n=st();return a.createElement(pt,{bucket:t},(function(e){var t=e.customQueryBody,r=e.error,l=e.handleError,u=e.handleQueryBodyChange,o=e.handleQueryMetaChange,c=e.handleSubmit,i=e.queries,s=e.queryData,m=e.queryMeta,d=e.resultsData;return a.createElement("div",null,a.createElement(y.Z,{variant:"h6"},"ElasticSearch queries"),a.createElement("div",{className:n.select},a.createElement(y.Z,{className:n.sectionHeader,variant:"body1"},"Select query"),a.createElement(I,{queries:i,onChange:o,value:t?null:m})),s.case({Init:function(){return a.createElement(vt,{disabled:Et(t,d,r),onChange:u,onError:l,onSubmit:c,value:t||ht})},Ok:function(e){return a.createElement(vt,{disabled:Et(t||e,d,r),onChange:u,onError:l,onSubmit:c,value:t||e||ht})},Err:function(e){return a.createElement(b.Z,{severity:"error"},e.message)},Pending:function(){return a.createElement(Ke.Z,{size:96})}}),d.case({Init:function(){return null},Ok:function(e){return a.createElement(et,{results:e})},Err:function(e){return a.createElement(b.Z,{severity:"error"},e.message)},_:function(){return a.createElement(se.Z,{pt:5,textAlign:"center"},a.createElement(Ke.Z,{size:96}))}}))}))}var gt,yt=o.Z((function(e){var t,n,r;return{actions:{margin:e.spacing(2,0)},container:(t={},t[e.breakpoints.up("sm")]={display:"flex",padding:e.spacing(3)},t),inner:{margin:e.spacing(2,0,0)},form:{margin:e.spacing(0,0,4)},panel:(n={flexGrow:1,padding:e.spacing(2,0)},n[e.breakpoints.up("sm")]={padding:e.spacing(1,3),maxWidth:"calc(100% - 200px)"},n),select:{margin:e.spacing(3,0)},tabWrapper:{alignItems:"flex-start"},tabs:(r={},r[e.breakpoints.down("sm")]={borderBottom:"1px solid "+e.palette.divider},r[e.breakpoints.up("sm")]={borderRight:"1px solid "+e.palette.divider,width:e.spacing(20)},r),viewer:{margin:e.spacing(3,0)}}}));function Zt(e){return a.createElement(c.Z,(0,r.pi)({component:l.Link},e))}function kt(e){var t=e.location,n=e.match.params.bucket,r=yt(),l=p.D$(),o=l.paths,c=l.urls,v=a.useState((function(){return(0,u.LX)(t.pathname,c.bucketAthenaQueries(n))?gt.ATHENA:gt.ES})),h=v[0],E=v[1],f=a.useMemo((function(){return{wrapper:r.tabWrapper}}),[r]),g=i.Z(),y=s.Z(g.breakpoints.down("sm"));return a.createElement("div",{className:r.container},a.createElement(d.Z,null,["Queries",n]),a.createElement(m.Z,{className:r.tabs,orientation:y?"horizontal":"vertical",onChange:function(e,t){E(t)},value:h,centered:y},a.createElement(Zt,{label:"ElasticSearch",value:gt.ES,classes:f,to:c.bucketESQueries(n)}),a.createElement(Zt,{label:"Athena SQL",value:gt.ATHENA,classes:f,to:c.bucketAthenaQueries(n)})),a.createElement("div",{className:r.panel},a.createElement(u.rs,null,a.createElement(u.AW,{path:o.bucketESQueries,component:ft,exact:!0}),a.createElement(u.AW,{path:o.bucketAthenaQueries,component:$e,exact:!0}),a.createElement(u.AW,{path:o.bucketAthenaQueryExecution,component:$e,exact:!0}),a.createElement(u.AW,null,a.createElement(u.l_,{to:c.bucketESQueries(n)})))))}!function(e){e[e.ATHENA=0]="ATHENA",e[e.ES=1]="ES"}(gt||(gt={}))},33129:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(70655);function a(e){return(0,r.mG)(this,void 0,Promise,(function(){return(0,r.Jh)(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))}},74391:(e,t,n)=>{n.d(t,{Z:()=>W});var r=n(70655),a=n(94184),l=n.n(a),u=n(8598),o=n(10180),c=n(33287),i=n(35064),s=n(24402),m=n(13646),d=n(67294),p=n(41120),v=n(92863),h=n(8920),E=n(63457),f=n(10529),g=n(9001),y=n(33129),Z=p.Z((function(e){return{root:{fontFamily:e.typography.monospace.fontFamily,fontSize:e.typography.body2.fontSize,overflow:"auto",whiteSpace:"pre",width:"100%"},more:{color:e.palette.text.secondary},flex:{display:"flex"},compoundInner:{paddingLeft:e.spacing(2)},hidden:{display:"none"},iconBlank:{paddingRight:e.spacing(2.5)},key:{fontWeight:e.typography.fontWeightBold}}})),k=function(e){var t=e.classes;return d.createElement("div",{className:t.iconBlank})},b=function(){return d.createElement(v.Z,{fontSize:"small"},"chevron_right")},x=function(){return d.createElement(v.Z,{fontSize:"small"},"expand_more")},N=p.Z((function(e){return{root:{color:e.palette.text.secondary,display:"flex",fontFamily:e.typography.monospace.fontFamily,fontSize:e.typography.body2.fontSize,marginLeft:e.spacing(2)}}})),w=function(){var e=N();return d.createElement("span",{className:e.root},d.createElement(v.Z,{fontSize:"small"},"hourglass_empty"),"rendering…")};function S(e){var t=e.children,n=e.classes;return!!t&&d.createElement("div",{className:n.key},t,": ")}var q=u.Z([[o.Z(String),function(e){return'"'+e+'"'}],[c.Z,function(e){return""+e}]]);function C(e){var t=e.name,n=e.value,r=e.topLevel,a=void 0===r||r,l=e.classes;return d.createElement("div",{className:l.flex},!a&&d.createElement(k,{classes:l}),d.createElement(S,{classes:l},t),d.createElement("div",null,q(n)))}function Q(e){var t=e.keys,n=e.classes;return d.createElement("span",{className:n.more},"<","…",t,">")}var L=function(e,t){return e?d.createElement(d.Fragment,null,e,", ",t):t};function M(e){var t=e.name,n=e.value,r=e.topLevel,a=void 0===r||r,u=e.defaultExpanded,o=void 0!==u&&u,c=e.showKeysWhenCollapsed,s=e.classes,m=Array.isArray(n)?"[]":"{}",p=d.useMemo((function(){return Object.entries(n)}),[n]),v=d.useState(!!o),h=v[0],E=v[1],f=d.useCallback((function(){return E((function(e){return!e}))}),[]),g=!p.length,y=!g&&h,Z=d.useCallback((function(){var e=c-i.Z([2,4,20/8.6,t?t.length+2:0,4]);return e<=0||Array.isArray(n)?d.createElement(Q,{keys:p.length,classes:s}):p.reduce((function(e,t){var n=t[0];return e.done?e:e.availableSpace<n.length?{str:L(e.str,d.createElement(Q,{keys:p.length-e.keys,classes:s})),done:!0}:{str:L(e.str,d.createElement("span",{className:s.key},n)),availableSpace:e.availableSpace-n.length-(e.str?2:0),keys:e.keys+1,done:!1}}),{str:null,availableSpace:e,keys:0,done:!1}).str}),[s,p,t,c,n]);return d.createElement("div",null,d.createElement("div",{className:s.flex,onClick:f},g?!a&&d.createElement(k,{classes:s}):y?d.createElement(x,null):d.createElement(b,null),d.createElement(S,{classes:s},t),m[0],!y&&d.createElement(d.Fragment,null,g?"":d.createElement("span",null," ",Z()," "),m[1])),y&&d.createElement(d.Suspense,{fallback:d.createElement(d.Fragment,null,d.createElement(w,null),m[1])},d.createElement("div",{className:l()(s.compoundInner)},p.map((function(e){var t=e[0],n=e[1];return d.createElement(A,{classes:s,key:t,name:t,value:n,topLevel:!1,defaultExpanded:Number.isInteger(o)&&o>0?o-1:o,showKeysWhenCollapsed:c-20/8.6})})),d.createElement("div",{onClick:f},m[1]))))}var D=s.Z([o.Z(String),o.Z(Number),o.Z(Boolean),m.Z(null),m.Z(void 0)]);function A(e){var t=function(e,t,n){var a=this;return(0,g.Z)([e,t],(function(){return d.lazy((function(){return(0,r.mG)(a,void 0,void 0,(function(){return(0,r.Jh)(this,(function(a){switch(a.label){case 0:return[4,(0,y.Z)(n||0)];case 1:return a.sent(),[2,{default:function(){return d.createElement(e,(0,r.pi)({},t))}}]}}))}))}))}))}(D(e.value)?C:M,e);return d.createElement(t,null)}function W(e){var t,n=e.name,a=e.value,u=e.topLevel,o=e.defaultExpanded,c=e.showKeysWhenCollapsed,i=void 0===c?"auto":c,s=e.className,m=(0,r._T)(e,["name","value","topLevel","defaultExpanded","showKeysWhenCollapsed","className"]),p=Z(),v=(t=h.Z(),["sm","md","lg"].reduce((function(e,n){return E.Z(t.breakpoints.up(n))?t.breakpoints.width(n):e}),320)),g=d.useMemo((function(){return!0===i||!1===i?Number.POSITIVE_INFINITY:"auto"===i?(v-80)/8.6:i}),[i,v]);return d.createElement(f.Z,(0,r.pi)({className:l()(s,p.root)},m),d.createElement(d.Suspense,{fallback:d.createElement(w,null)},d.createElement(A,(0,r.pi)({},{name:n,value:a,topLevel:u,defaultExpanded:o,classes:p},{showKeysWhenCollapsed:g}))))}}}]);
//# sourceMappingURL=2367.aff5db6ce4f1edbc765e.chunk.js.map