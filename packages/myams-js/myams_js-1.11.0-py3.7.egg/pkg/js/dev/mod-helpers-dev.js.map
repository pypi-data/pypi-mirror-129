{"version":3,"sources":["mod-helpers.js"],"names":["$","MyAMS","helpers","clearValue","evt","target","currentTarget","data","val","clearDatetimeValue","picker","date","select2ChangeHelper","source","amsSelect2HelperTarget","amsSelect2HelperType","html","params","amsSelect2HelperArgument","get","amsSelect2HelperUrl","then","result","callback","core","getFunctionByName","amsSelect2HelperCallback","initContent","empty","catch","executeFunctionByName","refreshElement","form","options","Promise","resolve","reject","element","object_id","config","clearContent","document","replaceWith","content","refreshWidget","widget","widget_id","group","parents","addTableRow","selector","table_id","table","dtTable","DataTable","newRow","rows","add","draw","row_id","refreshTableRow","row","first","fn","remove","refreshImage","image","image_id","attr","src","moveElementToParentEnd","parent","detach","appendTo","hideDropdown","closest","dropdown","window","env","bundle","modules","push","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS generic helpers\n */\n\nconst $ = MyAMS.$;\n\n\nexport const helpers = {\n\n\t/**\n\t * Click handler used to clear input\n\t */\n\tclearValue: (evt) => {\n\t\tconst target = $(evt.currentTarget).data('target');\n\t\tif (target) {\n\t\t\t$(target).val(null);\n\t\t}\n\t},\n\n\t/**\n\t * Click handler used to clear datetime input\n\t */\n\tclearDatetimeValue: (evt) => {\n\t\tconst\n\t\t\ttarget = $(evt.currentTarget).data('target'),\n\t\t\tpicker = $(target).data('datetimepicker');\n\t\tif (picker) {\n\t\t\tpicker.date(null);\n\t\t}\n\t},\n\n\t/**\n\t * Select2 change helper\n\t */\n\tselect2ChangeHelper: (evt) => {\n\t\tconst\n\t\t\tsource = $(evt.currentTarget),\n\t\t\tdata = source.data(),\n\t\t\ttarget = $(data.amsSelect2HelperTarget);\n\n\t\tswitch (data.amsSelect2HelperType) {\n\n\t\t\tcase 'html':\n\t\t\t\ttarget.html('<div class=\"text-center\"><i class=\"fas fa-2x fa-spinner fa-spin\"></i></div>');\n\t\t\t\tconst params = {};\n\t\t\t\tparams[data.amsSelect2HelperArgument || 'value'] = source.val();\n\t\t\t\t$.get(data.amsSelect2HelperUrl, params).then((result) => {\n\t\t\t\t\tconst callback = MyAMS.core.getFunctionByName(data.amsSelect2HelperCallback) || ((result) => {\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\ttarget.html(result);\n\t\t\t\t\t\t\tMyAMS.core.initContent(target).then();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget.empty();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tcallback(result);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\ttarget.empty();\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconst callback = data.amsSelect2HelperCallback;\n\t\t\t\tif (callback) {\n\t\t\t\t\tMyAMS.core.executeFunctionByName(callback, source, data);\n\t\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Refresh a DOM element with content provided in\n\t * the <code>options</code> object.\n\t *\n\t * @param form: optional parent element\n\t * @param options: element properties:\n\t *   - object_id: ID of the refreshed element\n\t *   - content: new element content\n\t */\n\trefreshElement: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet element = $(`[id=\"${options.object_id}\"]`);\n\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.clearContent, document, element).then(() => {\n\t\t\t\telement.replaceWith($(options.content));\n\t\t\t\telement = $(`[id=\"${options.object_id}\"]`);\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent, document, element).then(() => {\n\t\t\t\t\tresolve(element);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a form widget with content provided in\n\t * the <code>options</code> object\n\t *\n\t * @param form: optional parent form\n\t * @param options: updated widget properties:\n\t *   - widget_id: ID of the refreshed widget\n\t *   - content: new element content\n\t */\n\trefreshWidget: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet widget = $(`[id=\"${options.widget_id}\"]`),\n\t\t\t\tgroup = widget.parents('.widget-group');\n\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.clearContent, document, group).then(() => {\n\t\t\t\tgroup.replaceWith($(options.content));\n\t\t\t\twidget = $(`[id=\"${options.widget_id}\"]`);\n\t\t\t\tgroup = widget.parents('.widget-group');\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent, document, group).then(() => {\n\t\t\t\t\tresolve(widget);\n\t\t\t\t}, reject);\n\t\t\t}, reject);\n\t\t});\n\t},\n\n\t/**\n\t * Add new row to table\n\t *\n\t * @param form: optional parent form\n\t * @param options: added row properties:\n\t *  - content: new row content\n\t */\n\taddTableRow: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\tselector = `table[id=\"${options.table_id}\"]`,\n\t\t\t\ttable = $(selector),\n\t\t\t\tdtTable = table.DataTable();\n\t\t\tlet newRow;\n\t\t\tif (options.data) {\n\t\t\t\tdtTable.rows.add(options.data).draw();\n\t\t\t\tnewRow = $(`tr[id=\"${options.row_id}\"]`, table);\n\t\t\t\tresolve(newRow);\n\t\t\t} else {\n\t\t\t\tnewRow = $(options.content);\n\t\t\t\tdtTable.rows.add(newRow).draw();\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent,\n\t\t\t\t\tdocument, newRow).then(() => {\n\t\t\t\t\tresolve(newRow);\n\t\t\t\t}, reject);\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a table row with content provided in\n\t * the <code>options</code> object\n\t *\n\t * @param form: optional parent form\n\t * @param options: updated row properties:\n\t *   - row_id: ID of the refreshed row\n\t *   - content: new row content\n\t */\n\trefreshTableRow: (form, options) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst\n\t\t\t\tselector = `tr[id=\"${options.row_id}\"]`,\n\t\t\t\trow = $(selector),\n\t\t\t\ttable = row.parents('table').first();\n\t\t\tif (options.data) {\n\t\t\t\tif ($.fn.DataTable) {\n\t\t\t\t\tconst dtTable = table.DataTable();\n\t\t\t\t\tif (typeof options.data === 'string') {\n\t\t\t\t\t\tdtTable.row(selector).remove().draw();\n\t\t\t\t\t\tdtTable.row.add($(options.data)).draw();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdtTable.row(selector).data(options.data);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(row);\n\t\t\t\t} else {\n\t\t\t\t\treject('No DataTable plug-in available!');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst newRow = $(options.content);\n\t\t\t\trow.replaceWith(newRow);\n\t\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.initContent,\n\t\t\t\t\tdocument, newRow).then(() => {\n\t\t\t\t\tresolve(newRow);\n\t\t\t\t}, reject);\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Refresh a single image with content provided in\n\t * the <code>options</code> object.\n\t *\n\t * @param form: optional parent element\n\t * @param options: image properties:\n\t *   - image_id: ID of the refreshed image\n\t *   - src: new image source URL\n\t */\n\trefreshImage: (form, options) => {\n\t\tconst image = $(`[id=\"${options.image_id}\"]`);\n\t\timage.attr('src', options.src);\n\t},\n\n\t/**\n\t * Move given element to the end of it's parent\n\t *\n\t * @param element: the element to be moved\n\t * @returns {*}\n\t */\n\tmoveElementToParentEnd: (element) => {\n\t\tconst parent = element.parent();\n\t\treturn element.detach()\n\t\t\t.appendTo(parent);\n\t},\n\n\t/**\n\t * Toggle dropdown associated with given event target\n\t *\n\t * @param evt: source event\n\t */\n\thideDropdown: (evt) => {\n\t\t$(evt.target).closest('.dropdown-menu').dropdown('hide');\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('helpers');\n\t} else {\n\t\tMyAMS.helpers = helpers;\n\t\tconsole.debug(\"MyAMS: helpers module loaded...\");\n\t}\n}\n"],"file":"mod-helpers-dev.js"}